[0m15:44:21.126783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe8470>]}


============================== 15:44:21.131176 | 9ff418ef-ce0c-4e29-82cd-16803d532228 ==============================
[0m15:44:21.131176 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:44:21.131432 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt ', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'debug': 'False', 'log_format': 'default'}
[0m15:44:21.205576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ff418ef-ce0c-4e29-82cd-16803d532228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a44d0>]}
[0m15:44:21.327864 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:21.328957 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:21.329317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2544748, "process_in_blocks": "0", "process_kernel_time": 0.19618, "process_mem_max_rss": "111722496", "process_out_blocks": "0", "process_user_time": 0.682163}
[0m15:44:21.329578 [debug] [MainThread]: Command `cli deps` succeeded at 15:44:21.329523 after 0.25 seconds
[0m15:44:21.329761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b387f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a44d0>]}
[0m15:44:21.329930 [debug] [MainThread]: Flushing usage events
[0m15:44:22.344904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:30.530834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdeed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76d340>]}


============================== 15:48:30.535932 | a6ac80f5-5db8-417b-a8ce-3bb85a7b624e ==============================
[0m15:48:30.535932 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:48:30.536262 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select models/demo', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False'}
[0m15:48:31.612040 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:48:31.612995 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:48:31.613556 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:48:31.768150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ac80f5-5db8-417b-a8ce-3bb85a7b624e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad89f10>]}
[0m15:48:31.811606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ac80f5-5db8-417b-a8ce-3bb85a7b624e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5dda60>]}
[0m15:48:31.814674 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:48:31.884218 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:48:32.004610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:32.004820 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:48:32.004930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:32.007642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.example
[0m15:48:32.015576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ac80f5-5db8-417b-a8ce-3bb85a7b624e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e3d40>]}
[0m15:48:32.038491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:48:32.045985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:48:32.083351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ac80f5-5db8-417b-a8ce-3bb85a7b624e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4dddc0>]}
[0m15:48:32.083570 [info ] [MainThread]: Found 1 model, 522 macros
[0m15:48:32.083697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ac80f5-5db8-417b-a8ce-3bb85a7b624e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1cddc0>]}
[0m15:48:32.085183 [info ] [MainThread]: 
[0m15:48:32.085329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:32.085431 [info ] [MainThread]: 
[0m15:48:32.085626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:32.085984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_WH'
[0m15:48:32.320718 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_WH"
[0m15:48:32.320997 [debug] [ThreadPool]: On list_AIRBNB_WH: show terse schemas in database AIRBNB_WH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_WH"} */
[0m15:48:32.321171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:33.421292 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c20daa-0001-873b-000c-0f160002d546
[0m15:48:33.422262 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:48:33.423139 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:48:33.423686 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:48:33.425262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:33.425879 [debug] [MainThread]: Connection 'list_AIRBNB_WH' was left open.
[0m15:48:33.426388 [debug] [MainThread]: On list_AIRBNB_WH: Close
[0m15:48:33.525781 [info ] [MainThread]: 
[0m15:48:33.526800 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m15:48:33.527729 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AIRBNB_WH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m15:48:33.528877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0647786, "process_in_blocks": "0", "process_kernel_time": 0.567581, "process_mem_max_rss": "158793728", "process_out_blocks": "0", "process_user_time": 1.350323}
[0m15:48:33.529703 [debug] [MainThread]: Command `dbt run` failed at 15:48:33.529548 after 3.07 seconds
[0m15:48:33.530389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e86ec90>]}
[0m15:48:33.531038 [debug] [MainThread]: Flushing usage events
[0m15:48:34.597576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:22.396593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a84aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fbfb0>]}


============================== 15:58:22.401695 | 16b2b110-66c9-4656-889e-2c39f0ba5e40 ==============================
[0m15:58:22.401695 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:58:22.402025 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/demo', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None'}
[0m15:58:23.531899 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:58:23.532969 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:58:23.533561 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:58:23.679538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b2b110-66c9-4656-889e-2c39f0ba5e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdee600>]}
[0m15:58:23.723562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b2b110-66c9-4656-889e-2c39f0ba5e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ebb60>]}
[0m15:58:23.727068 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:58:23.798883 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:58:23.951384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:23.951623 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:58:23.951734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:23.954523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.example
[0m15:58:23.962802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b2b110-66c9-4656-889e-2c39f0ba5e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cd910>]}
[0m15:58:23.985751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:58:23.990296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:58:24.041011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b2b110-66c9-4656-889e-2c39f0ba5e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d6930>]}
[0m15:58:24.041227 [info ] [MainThread]: Found 1 model, 522 macros
[0m15:58:24.041363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b2b110-66c9-4656-889e-2c39f0ba5e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b64b0>]}
[0m15:58:24.042700 [info ] [MainThread]: 
[0m15:58:24.042844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:24.042946 [info ] [MainThread]: 
[0m15:58:24.043140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:24.043513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_WH'
[0m15:58:24.452499 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_WH"
[0m15:58:24.453069 [debug] [ThreadPool]: On list_AIRBNB_WH: show terse schemas in database AIRBNB_WH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_WH"} */
[0m15:58:24.453393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:25.438366 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c20db4-0001-885a-000c-0f16000304a6
[0m15:58:25.439342 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:58:25.440191 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:58:25.440715 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:58:25.441966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:25.442420 [debug] [MainThread]: Connection 'list_AIRBNB_WH' was left open.
[0m15:58:25.442784 [debug] [MainThread]: On list_AIRBNB_WH: Close
[0m15:58:25.551500 [info ] [MainThread]: 
[0m15:58:25.552630 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m15:58:25.553594 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "AIRBNB_WH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m15:58:25.554745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2278535, "process_in_blocks": "0", "process_kernel_time": 1.022089, "process_mem_max_rss": "157876224", "process_out_blocks": "0", "process_user_time": 1.701718}
[0m15:58:25.555506 [debug] [MainThread]: Command `dbt run` failed at 15:58:25.555360 after 3.23 seconds
[0m15:58:25.556077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6734d0>]}
[0m15:58:25.556608 [debug] [MainThread]: Flushing usage events
[0m15:58:26.528589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:15.596897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf76210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fcf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fd490>]}


============================== 15:59:15.602936 | 144e14fa-30be-4474-8880-3263e536af14 ==============================
[0m15:59:15.602936 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:59:15.603250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/demo', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_colors': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'fail_fast': 'False', 'introspect': 'True'}
[0m15:59:16.661663 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:59:16.662709 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:59:16.663392 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:59:16.813709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfeb440>]}
[0m15:59:16.858220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfac950>]}
[0m15:59:16.861864 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:59:16.934338 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:59:17.064573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:17.064798 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:59:17.064918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:17.067734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.example
[0m15:59:17.075736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42e4b0>]}
[0m15:59:17.098373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:59:17.105385 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:59:17.147644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e3320>]}
[0m15:59:17.147854 [info ] [MainThread]: Found 1 model, 522 macros
[0m15:59:17.147986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4b8d10>]}
[0m15:59:17.149314 [info ] [MainThread]: 
[0m15:59:17.149450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:17.149555 [info ] [MainThread]: 
[0m15:59:17.149750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:17.150111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:59:17.486088 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:59:17.486620 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:59:17.486957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:18.361366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.874 seconds
[0m15:59:18.363220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_dbt_schema)
[0m15:59:18.363663 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "dbt_schema"
"
[0m15:59:18.367595 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_dbt_schema"
[0m15:59:18.367828 [debug] [ThreadPool]: On create_AIRBNB_PRO_dbt_schema: create schema if not exists AIRBNB_PRO.dbt_schema
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_dbt_schema"} */
[0m15:59:18.485237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m15:59:18.487569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_dbt_schema)
[0m15:59:18.500058 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m15:59:18.500446 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m15:59:18.582445 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.082 seconds
[0m15:59:18.585823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63ee70>]}
[0m15:59:18.606482 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.demo
[0m15:59:18.607167 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.demo .................................... [RUN]
[0m15:59:18.607672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now model.dbt_snowflake_aws_project.demo)
[0m15:59:18.607945 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.demo
[0m15:59:18.613160 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.demo"
[0m15:59:18.618999 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.demo
[0m15:59:18.636822 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.demo"
[0m15:59:18.642587 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.demo"
[0m15:59:18.642775 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.demo: create or replace   view AIRBNB_PRO.dbt_schema.demo
  
  
  
  
  as (
    select * from AIRBNB_PRO.BRONZE.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.demo"} */;
[0m15:59:18.807885 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m15:59:18.848897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '144e14fa-30be-4474-8880-3263e536af14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c890f50>]}
[0m15:59:18.849490 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_schema.demo ............................... [[32mSUCCESS 1[0m in 0.22s]
[0m15:59:18.849925 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.demo
[0m15:59:18.850904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:18.851136 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.demo' was left open.
[0m15:59:18.851334 [debug] [MainThread]: On model.dbt_snowflake_aws_project.demo: Close
[0m15:59:18.924532 [info ] [MainThread]: 
[0m15:59:18.925005 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m15:59:18.925597 [debug] [MainThread]: Command end result
[0m15:59:18.943011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:59:18.948694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:59:18.953040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:59:18.953243 [info ] [MainThread]: 
[0m15:59:18.953468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:18.953627 [info ] [MainThread]: 
[0m15:59:18.953793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:18.954130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.423435, "process_in_blocks": "0", "process_kernel_time": 0.839648, "process_mem_max_rss": "159662080", "process_out_blocks": "0", "process_user_time": 1.63665}
[0m15:59:18.954379 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:18.954329 after 3.42 seconds
[0m15:59:18.954574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf76210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6e5a0>]}
[0m15:59:18.954768 [debug] [MainThread]: Flushing usage events
[0m15:59:20.053252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:42.546941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b003710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f7e00>]}


============================== 16:02:42.552267 | 09d9c3f8-9390-49e0-93ee-77b216ed9af0 ==============================
[0m16:02:42.552267 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:02:42.552663 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'empty': 'False', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'introspect': 'True', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select models/demo', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m16:02:43.514241 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:02:43.515079 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:02:43.515493 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:02:43.594598 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:02:43.594894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd5490>]}
[0m16:02:43.662139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e24b0>]}
[0m16:02:43.705139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b2960>]}
[0m16:02:43.707947 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:02:43.778894 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:02:43.902006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:43.902210 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:02:43.902313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:43.912299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b725580>]}
[0m16:02:43.933332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:02:43.942319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:02:43.964487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f4140>]}
[0m16:02:43.964698 [info ] [MainThread]: Found 1 model, 522 macros
[0m16:02:43.964832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d9c3f8-9390-49e0-93ee-77b216ed9af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c6420>]}
[0m16:02:43.965563 [warn ] [MainThread]: The selection criterion 'models/demo' does not match any enabled nodes
[0m16:02:43.966087 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:02:43.966905 [debug] [MainThread]: Command end result
[0m16:02:44.029975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:02:44.033428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:02:44.036540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:02:44.036820 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:02:44.037126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5609903, "process_in_blocks": "0", "process_kernel_time": 0.800841, "process_mem_max_rss": "139788288", "process_out_blocks": "0", "process_user_time": 1.6057}
[0m16:02:44.037372 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:44.037331 after 1.56 seconds
[0m16:02:44.037552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b690320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b542990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b003710>]}
[0m16:02:44.037719 [debug] [MainThread]: Flushing usage events
[0m16:02:45.342680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:00.805893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4687a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a3e00>]}


============================== 16:03:00.811261 | d3297388-62a1-4f21-a27d-65ce7c48974b ==============================
[0m16:03:00.811261 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:03:00.811589 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select models/bronze', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True'}
[0m16:03:01.964738 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:03:01.966060 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:03:01.966715 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:03:02.051337 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:03:02.051693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c13f440>]}
[0m16:03:02.121530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c75a3c0>]}
[0m16:03:02.164618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b67e0>]}
[0m16:03:02.167295 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:03:02.235389 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:03:02.361270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:02.361486 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:03:02.361597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:02.372089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf8bf0>]}
[0m16:03:02.393660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:03:02.400382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:03:02.431542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d361eb0>]}
[0m16:03:02.431751 [info ] [MainThread]: Found 1 model, 522 macros
[0m16:03:02.431883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d34f170>]}
[0m16:03:02.433412 [info ] [MainThread]: 
[0m16:03:02.433554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:02.433656 [info ] [MainThread]: 
[0m16:03:02.433851 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:02.434197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:03:02.688382 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:03:02.688581 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:03:02.688688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:03.765254 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.076 seconds
[0m16:03:03.769721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_dbt_schema_semi_raw)
[0m16:03:03.770743 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "dbt_schema_semi_raw"
"
[0m16:03:03.778866 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_dbt_schema_semi_raw"
[0m16:03:03.779501 [debug] [ThreadPool]: On create_AIRBNB_PRO_dbt_schema_semi_raw: create schema if not exists AIRBNB_PRO.dbt_schema_semi_raw
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_dbt_schema_semi_raw"} */
[0m16:03:03.885395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m16:03:03.889887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_dbt_schema_semi_raw, now list_AIRBNB_PRO_dbt_schema_semi_raw)
[0m16:03:03.906555 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema_semi_raw"
[0m16:03:03.906975 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema_semi_raw: show objects in AIRBNB_PRO.dbt_schema_semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema_semi_raw"} */;
[0m16:03:04.043906 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.136 seconds
[0m16:03:04.047978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d07c3b0>]}
[0m16:03:04.061795 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bronze
[0m16:03:04.062944 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema_semi_raw.bronze ......................... [RUN]
[0m16:03:04.063775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema_semi_raw, now model.dbt_snowflake_aws_project.bronze)
[0m16:03:04.064368 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bronze
[0m16:03:04.072829 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bronze"
[0m16:03:04.076612 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bronze
[0m16:03:04.098570 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bronze"
[0m16:03:04.100946 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bronze"
[0m16:03:04.101167 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bronze: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.bronze
  
  
  
  
  as (
    select * from AIRBNB_PRO.BRONZE.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bronze"} */;
[0m16:03:04.380840 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m16:03:04.414833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3297388-62a1-4f21-a27d-65ce7c48974b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4212b0>]}
[0m16:03:04.415470 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_schema_semi_raw.bronze .................... [[32mSUCCESS 1[0m in 0.35s]
[0m16:03:04.415915 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bronze
[0m16:03:04.416956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:04.417172 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.bronze' was left open.
[0m16:03:04.417364 [debug] [MainThread]: On model.dbt_snowflake_aws_project.bronze: Close
[0m16:03:04.542591 [info ] [MainThread]: 
[0m16:03:04.543669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m16:03:04.544946 [debug] [MainThread]: Command end result
[0m16:03:04.565288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:03:04.571694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:03:04.577143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:03:04.577349 [info ] [MainThread]: 
[0m16:03:04.577589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:04.577757 [info ] [MainThread]: 
[0m16:03:04.577943 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:03:04.578263 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:03:04.578663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.840384, "process_in_blocks": "0", "process_kernel_time": 0.776711, "process_mem_max_rss": "158957568", "process_out_blocks": "0", "process_user_time": 1.850018}
[0m16:03:04.578929 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:04.578878 after 3.84 seconds
[0m16:03:04.579146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e22a1e0>]}
[0m16:03:04.579352 [debug] [MainThread]: Flushing usage events
[0m16:03:05.743483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:15.572471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107069250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d8440>]}


============================== 16:22:15.575922 | eb2d5212-4918-402d-abbc-2d3b83596323 ==============================
[0m16:22:15.575922 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:22:15.576200 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/bronze', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False'}
[0m16:22:15.921152 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:22:15.921457 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:22:15.921639 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:22:15.961867 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:22:15.962142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb2d5212-4918-402d-abbc-2d3b83596323', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a715550>]}
[0m16:22:16.025966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb2d5212-4918-402d-abbc-2d3b83596323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82b050>]}
[0m16:22:16.076610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb2d5212-4918-402d-abbc-2d3b83596323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a802300>]}
[0m16:22:16.078350 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:22:16.150028 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:22:16.257546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:22:16.257990 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/bronze/sources/sources.yml
[0m16:22:16.258141 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/bronze/listings.sql
[0m16:22:16.258265 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/bronze/hosts.sql
[0m16:22:16.375619 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.bookings' (models/bronze/bookings.sql) depends on a source named 'BRONZE.bookings' which was not found
[0m16:22:16.375973 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:22:16.376278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8449528, "process_in_blocks": "0", "process_kernel_time": 0.423728, "process_mem_max_rss": "146374656", "process_out_blocks": "0", "process_user_time": 1.186532}
[0m16:22:16.376478 [debug] [MainThread]: Command `dbt run` failed at 16:22:16.376440 after 0.85 seconds
[0m16:22:16.376650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4a8a0>]}
[0m16:22:16.376797 [debug] [MainThread]: Flushing usage events
[0m16:22:17.329593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:21.439704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7c3e0>]}


============================== 16:23:21.443972 | e4250961-d299-4026-9ab6-6c735fef5e3d ==============================
[0m16:23:21.443972 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:23:21.444308 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select models/bronze', 'fail_fast': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True'}
[0m16:23:22.584291 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:23:22.585523 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:23:22.586207 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:23:22.684161 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:23:22.684491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac68650>]}
[0m16:23:22.753538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a943c20>]}
[0m16:23:22.796258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a943920>]}
[0m16:23:22.798982 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:23:22.871442 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:23:23.012662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:23.012886 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:23:23.013005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:23.026292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2ae70>]}
[0m16:23:23.053508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:23:23.062223 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:23:23.086774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b173650>]}
[0m16:23:23.086985 [info ] [MainThread]: Found 3 models, 3 sources, 522 macros
[0m16:23:23.087123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac6b4d0>]}
[0m16:23:23.088405 [info ] [MainThread]: 
[0m16:23:23.088543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:23.088643 [info ] [MainThread]: 
[0m16:23:23.088832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:23.090532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:23:23.379046 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:23:23.379551 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:23:23.379868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:24.125984 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.746 seconds
[0m16:23:24.131459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema_semi_raw)
[0m16:23:24.147745 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema_semi_raw"
[0m16:23:24.148185 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema_semi_raw: show objects in AIRBNB_PRO.dbt_schema_semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema_semi_raw"} */;
[0m16:23:24.240863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m16:23:24.242507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2f5c0>]}
[0m16:23:24.247303 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:23:24.247682 [info ] [Thread-2 (]: 1 of 3 START sql view model dbt_schema_semi_raw.bookings ....................... [RUN]
[0m16:23:24.247972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:23:24.248186 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:23:24.252887 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:23:24.254005 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:23:24.270605 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:23:24.271885 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:23:24.272057 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:23:24.705246 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m16:23:24.731747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079455e0>]}
[0m16:23:24.732391 [info ] [Thread-2 (]: 1 of 3 OK created sql view model dbt_schema_semi_raw.bookings .................. [[32mSUCCESS 1[0m in 0.48s]
[0m16:23:24.732826 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:23:24.733085 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:23:24.733470 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_schema_semi_raw.hosts .......................... [RUN]
[0m16:23:24.733823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:23:24.734064 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:23:24.736149 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:23:24.737982 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:23:24.739898 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:23:24.741716 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:23:24.741964 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:23:25.010033 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m16:23:25.014649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a7140>]}
[0m16:23:25.015870 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_schema_semi_raw.hosts ..................... [[32mSUCCESS 1[0m in 0.28s]
[0m16:23:25.016880 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:23:25.017457 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:23:25.018127 [info ] [Thread-2 (]: 3 of 3 START sql view model dbt_schema_semi_raw.listings ....................... [RUN]
[0m16:23:25.018774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:23:25.019211 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:23:25.023551 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:23:25.026023 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:23:25.029305 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:23:25.031259 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:23:25.031617 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:23:25.324105 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m16:23:25.329439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4250961-d299-4026-9ab6-6c735fef5e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a69f0>]}
[0m16:23:25.331422 [info ] [Thread-2 (]: 3 of 3 OK created sql view model dbt_schema_semi_raw.listings .................. [[32mSUCCESS 1[0m in 0.31s]
[0m16:23:25.332620 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:23:25.334985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:25.335437 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:23:25.335859 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:23:25.424139 [info ] [MainThread]: 
[0m16:23:25.425445 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m16:23:25.427226 [debug] [MainThread]: Command end result
[0m16:23:25.450520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:23:25.456595 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:23:25.462121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:23:25.462332 [info ] [MainThread]: 
[0m16:23:25.462560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:25.462731 [info ] [MainThread]: 
[0m16:23:25.462921 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:23:25.463252 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:23:25.463663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.094141, "process_in_blocks": "0", "process_kernel_time": 0.848321, "process_mem_max_rss": "160071680", "process_out_blocks": "0", "process_user_time": 1.922165}
[0m16:23:25.463932 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:25.463877 after 4.09 seconds
[0m16:23:25.464158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2b710>]}
[0m16:23:25.464377 [debug] [MainThread]: Flushing usage events
[0m16:23:26.421676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:01.894041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cefe180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d737fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d737dd0>]}


============================== 16:25:01.899325 | 9262d44a-ad9b-47d2-bc23-637ac78a52a0 ==============================
[0m16:25:01.899325 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:25:01.899674 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select models/bronze', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None'}
[0m16:25:02.903152 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:25:02.903814 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:25:02.904177 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:25:02.980591 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:25:02.980892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d767560>]}
[0m16:25:03.049435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d736f00>]}
[0m16:25:03.093847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3494f0>]}
[0m16:25:03.097509 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:25:03.170190 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:25:03.220207 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `materialized` as a top-level property of `models[0]` in file
`models/bronze/properties.yml`. The `materialized` top-level property should be
moved into the `config` of `models[0]`.
[0m16:25:03.220447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e436810>]}
[0m16:25:03.332992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:03.333217 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:25:03.333341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:03.347348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d892420>]}
[0m16:25:03.374912 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:25:03.383082 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:25:03.421031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e322ea0>]}
[0m16:25:03.421255 [info ] [MainThread]: Found 3 models, 3 sources, 522 macros
[0m16:25:03.421395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7660f0>]}
[0m16:25:03.422788 [info ] [MainThread]: 
[0m16:25:03.422931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:03.423032 [info ] [MainThread]: 
[0m16:25:03.423234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:03.425025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:25:03.730256 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:25:03.730482 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:25:03.730606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:04.660676 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.930 seconds
[0m16:25:04.666111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema_semi_raw)
[0m16:25:04.681423 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema_semi_raw"
[0m16:25:04.681878 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema_semi_raw: show objects in AIRBNB_PRO.dbt_schema_semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema_semi_raw"} */;
[0m16:25:04.857803 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.175 seconds
[0m16:25:04.864301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0bd760>]}
[0m16:25:04.876193 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:25:04.877122 [info ] [Thread-2 (]: 1 of 3 START sql view model dbt_schema_semi_raw.bookings ....................... [RUN]
[0m16:25:04.877799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:25:04.878277 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:25:04.886813 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:25:04.890144 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:25:04.911073 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:25:04.913737 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:25:04.913942 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:25:05.062392 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m16:25:05.094602 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd9370>]}
[0m16:25:05.095179 [info ] [Thread-2 (]: 1 of 3 OK created sql view model dbt_schema_semi_raw.bookings .................. [[32mSUCCESS 1[0m in 0.21s]
[0m16:25:05.095617 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:25:05.095919 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:25:05.096327 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_schema_semi_raw.hosts .......................... [RUN]
[0m16:25:05.096701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:25:05.096971 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:25:05.099009 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:25:05.102003 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:25:05.103819 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:25:05.106774 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:25:05.106999 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:25:05.236182 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:25:05.240981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fbef0>]}
[0m16:25:05.242104 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_schema_semi_raw.hosts ..................... [[32mSUCCESS 1[0m in 0.14s]
[0m16:25:05.243013 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:25:05.243494 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:25:05.244098 [info ] [Thread-2 (]: 3 of 3 START sql view model dbt_schema_semi_raw.listings ....................... [RUN]
[0m16:25:05.244684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:25:05.245155 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:25:05.249321 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:25:05.251999 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:25:05.254966 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:25:05.257982 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:25:05.258332 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.dbt_schema_semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:25:05.573036 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m16:25:05.578047 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9262d44a-ad9b-47d2-bc23-637ac78a52a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9e7c20>]}
[0m16:25:05.579354 [info ] [Thread-2 (]: 3 of 3 OK created sql view model dbt_schema_semi_raw.listings .................. [[32mSUCCESS 1[0m in 0.33s]
[0m16:25:05.580387 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:25:05.582581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:05.582999 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:25:05.583369 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:25:05.679359 [info ] [MainThread]: 
[0m16:25:05.680318 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m16:25:05.681682 [debug] [MainThread]: Command end result
[0m16:25:05.706029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:25:05.712743 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:25:05.718125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:25:05.718331 [info ] [MainThread]: 
[0m16:25:05.718551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:05.718721 [info ] [MainThread]: 
[0m16:25:05.718906 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:25:05.719244 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:25:05.719637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.893629, "process_in_blocks": "0", "process_kernel_time": 0.734909, "process_mem_max_rss": "159825920", "process_out_blocks": "0", "process_user_time": 1.679245}
[0m16:25:05.719901 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:05.719849 after 3.89 seconds
[0m16:25:05.720115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cefe180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f80b0>]}
[0m16:25:05.720327 [debug] [MainThread]: Flushing usage events
[0m16:25:06.796886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:23.451835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941d340>]}


============================== 16:25:23.455257 | b6e023f7-52a8-4c09-87db-885987eff7b4 ==============================
[0m16:25:23.455257 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:25:23.455639 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'invocation_command': 'dbt compile', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m16:25:23.685028 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:25:23.685307 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:25:23.685445 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:25:23.716175 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:25:23.716433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa63950>]}
[0m16:25:23.775537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a501370>]}
[0m16:25:23.831543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8deb70>]}
[0m16:25:23.832337 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:25:23.897705 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:25:23.943276 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `materialized` as a top-level property of `models[0]` in file
`models/bronze/properties.yml`. The `materialized` top-level property should be
moved into the `config` of `models[0]`.
[0m16:25:23.943552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b189490>]}
[0m16:25:24.013531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:24.013753 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:25:24.013895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:24.028814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae325a0>]}
[0m16:25:24.059962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:25:24.063411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:25:24.078802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2fcd70>]}
[0m16:25:24.079064 [info ] [MainThread]: Found 3 models, 3 sources, 522 macros
[0m16:25:24.079204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afeb020>]}
[0m16:25:24.080051 [info ] [MainThread]: 
[0m16:25:24.080192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:24.080297 [info ] [MainThread]: 
[0m16:25:24.080495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:24.082372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_dbt_schema_semi_raw'
[0m16:25:24.243922 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema_semi_raw"
[0m16:25:24.244144 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema_semi_raw: show objects in AIRBNB_PRO.dbt_schema_semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema_semi_raw"} */;
[0m16:25:24.244270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:25.006558 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.762 seconds
[0m16:25:25.009594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e023f7-52a8-4c09-87db-885987eff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac02300>]}
[0m16:25:25.013970 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:25:25.014530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:25:25.014895 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:25:25.024358 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:25:25.028013 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:25:25.028930 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:25:25.029507 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:25:25.030181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:25:25.030570 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:25:25.032617 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:25:25.036006 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:25:25.036372 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:25:25.036534 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:25:25.036743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:25:25.036937 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:25:25.039131 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:25:25.041991 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:25:25.042329 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:25:25.042822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:25.042993 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:25:25.043132 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:25:25.122812 [debug] [MainThread]: Command end result
[0m16:25:25.134341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:25:25.137085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:25:25.141843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:25:25.142178 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 1 occurrence
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:25:25.142546 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.7356932, "process_in_blocks": "0", "process_kernel_time": 0.437823, "process_mem_max_rss": "159498240", "process_out_blocks": "0", "process_user_time": 1.289017}
[0m16:25:25.142782 [debug] [MainThread]: Command `dbt compile` succeeded at 16:25:25.142735 after 1.74 seconds
[0m16:25:25.142974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093abef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ab4d0>]}
[0m16:25:25.143149 [debug] [MainThread]: Flushing usage events
[0m16:25:26.463308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:10.412909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b3fb0>]}


============================== 16:29:10.419240 | ab328325-6758-4cd6-aa07-759126433656 ==============================
[0m16:29:10.419240 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:29:10.419577 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt run'}
[0m16:29:11.192131 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:29:11.192805 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:29:11.193164 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:29:11.266319 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:29:11.266661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a236060>]}
[0m16:29:11.336299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947f680>]}
[0m16:29:11.384874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fee5a0>]}
[0m16:29:11.388622 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:29:11.463573 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:29:11.616701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:11.616951 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:29:11.617073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:11.619592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.silver
[0m16:29:11.631433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cb9b0>]}
[0m16:29:11.659512 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:29:11.666487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:29:11.699246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a714a70>]}
[0m16:29:11.699461 [info ] [MainThread]: Found 3 models, 3 sources, 523 macros
[0m16:29:11.699599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3caed0>]}
[0m16:29:11.700423 [info ] [MainThread]: 
[0m16:29:11.700554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:11.700656 [info ] [MainThread]: 
[0m16:29:11.700850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:11.702560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:29:11.909981 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:29:11.910178 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:29:11.910296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:12.556411 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.646 seconds
[0m16:29:12.559817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_semi_raw)
[0m16:29:12.560543 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "semi_raw"
"
[0m16:29:12.566211 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_semi_raw"
[0m16:29:12.566722 [debug] [ThreadPool]: On create_AIRBNB_PRO_semi_raw: create schema if not exists AIRBNB_PRO.semi_raw
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_semi_raw"} */
[0m16:29:12.661855 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:29:12.666646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_semi_raw)
[0m16:29:12.682120 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:29:12.682514 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:29:12.770793 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m16:29:12.775058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2016a0>]}
[0m16:29:12.788300 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:29:12.789336 [info ] [Thread-2 (]: 1 of 3 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:29:12.790089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:29:12.790592 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:29:12.801256 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:29:12.804548 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:29:12.825081 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:29:12.840666 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:29:12.840902 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:29:12.993813 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m16:29:13.012123 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd9340>]}
[0m16:29:13.012563 [info ] [Thread-2 (]: 1 of 3 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.22s]
[0m16:29:13.012903 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:29:13.013126 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:29:13.013462 [info ] [Thread-2 (]: 2 of 3 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:29:13.013790 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:29:13.013998 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:29:13.015808 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:29:13.018434 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:29:13.019991 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:29:13.032492 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:29:13.032802 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:29:13.242525 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m16:29:13.246855 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ebfe0>]}
[0m16:29:13.247867 [info ] [Thread-2 (]: 2 of 3 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.23s]
[0m16:29:13.248675 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:29:13.249218 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:29:13.249849 [info ] [Thread-2 (]: 3 of 3 START sql view model semi_raw.listings .................................. [RUN]
[0m16:29:13.250508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:29:13.250972 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:29:13.255240 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:29:13.259219 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:29:13.262384 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:29:13.277154 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:29:13.277483 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:29:13.439508 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m16:29:13.443870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab328325-6758-4cd6-aa07-759126433656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f1d90>]}
[0m16:29:13.445099 [info ] [Thread-2 (]: 3 of 3 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.19s]
[0m16:29:13.445867 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:29:13.448117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:13.448533 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:29:13.448903 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:29:13.533653 [info ] [MainThread]: 
[0m16:29:13.534541 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m16:29:13.535789 [debug] [MainThread]: Command end result
[0m16:29:13.560579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:29:13.567528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:29:13.573745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:29:13.573969 [info ] [MainThread]: 
[0m16:29:13.574200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:13.574372 [info ] [MainThread]: 
[0m16:29:13.574578 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:29:13.574961 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:29:13.575385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.233459, "process_in_blocks": "0", "process_kernel_time": 0.71202, "process_mem_max_rss": "159137792", "process_out_blocks": "0", "process_user_time": 1.60422}
[0m16:29:13.575665 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:13.575611 after 3.23 seconds
[0m16:29:13.575901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a567320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108778350>]}
[0m16:29:13.576117 [debug] [MainThread]: Flushing usage events
[0m16:29:14.707043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:42.178414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b767da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e94c0>]}


============================== 16:32:42.183588 | 0162d5d7-19fb-4e0f-ad15-e575c52f75b4 ==============================
[0m16:32:42.183588 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:32:42.183842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'write_json': 'True'}
[0m16:32:43.234474 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:32:43.235188 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:32:43.235562 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:32:43.306408 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:32:43.306713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb08f50>]}
[0m16:32:43.379123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca18f20>]}
[0m16:32:43.423158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109596e10>]}
[0m16:32:43.425320 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:32:43.517623 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:32:43.709582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:43.709823 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:32:43.709954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:43.712630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.silver
[0m16:32:43.725275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccaa7e0>]}
[0m16:32:43.754944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:32:43.763650 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:32:43.815913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfe8cb0>]}
[0m16:32:43.816161 [info ] [MainThread]: Found 3 models, 3 sources, 523 macros
[0m16:32:43.816313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb09fd0>]}
[0m16:32:43.817262 [info ] [MainThread]: 
[0m16:32:43.817412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:43.817523 [info ] [MainThread]: 
[0m16:32:43.817736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:43.819688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:32:44.085583 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:32:44.085936 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:32:44.086163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:44.926330 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.840 seconds
[0m16:32:44.930473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_semi_raw)
[0m16:32:44.931302 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "semi_raw"
"
[0m16:32:44.938227 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_semi_raw"
[0m16:32:44.938687 [debug] [ThreadPool]: On create_AIRBNB_PRO_semi_raw: create schema if not exists AIRBNB_PRO.semi_raw
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_semi_raw"} */
[0m16:32:45.023803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m16:32:45.025425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_semi_raw)
[0m16:32:45.034112 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:32:45.034387 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:32:45.108173 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.074 seconds
[0m16:32:45.109670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e58e0>]}
[0m16:32:45.115547 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:32:45.115975 [info ] [Thread-2 (]: 1 of 3 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:32:45.116296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:32:45.116534 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:32:45.123118 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:32:45.129882 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:32:45.145873 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:32:45.148746 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:32:45.148937 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:32:45.241532 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c20dd6-0001-885a-000c-0f160003095a
[0m16:32:45.241985 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
[0m16:32:45.254803 [debug] [Thread-2 (]: Database Error in model bookings (models/bronze/bookings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/bookings.sql
[0m16:32:45.258702 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df40260>]}
[0m16:32:45.259276 [error] [Thread-2 (]: 1 of 3 ERROR creating sql view model semi_raw.bookings ......................... [[31mERROR[0m in 0.14s]
[0m16:32:45.259765 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:32:45.260080 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:32:45.260528 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.bookings' to be skipped because of status 'error'.  Reason: Database Error in model bookings (models/bronze/bookings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/bookings.sql.
[0m16:32:45.260981 [info ] [Thread-2 (]: 2 of 3 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:32:45.262020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:32:45.262336 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:32:45.265025 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:32:45.270656 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:32:45.272836 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:32:45.275492 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:32:45.275711 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:32:45.347396 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c20dd6-0001-87f7-000c-0f160002eb7a
[0m16:32:45.347978 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
[0m16:32:45.352198 [debug] [Thread-2 (]: Database Error in model hosts (models/bronze/hosts.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/hosts.sql
[0m16:32:45.352784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d3c50>]}
[0m16:32:45.353345 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model semi_raw.hosts ............................ [[31mERROR[0m in 0.09s]
[0m16:32:45.353810 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:32:45.354122 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:32:45.354526 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.hosts' to be skipped because of status 'error'.  Reason: Database Error in model hosts (models/bronze/hosts.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/hosts.sql.
[0m16:32:45.354933 [info ] [Thread-2 (]: 3 of 3 START sql view model semi_raw.listings .................................. [RUN]
[0m16:32:45.355410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:32:45.355698 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:32:45.358214 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:32:45.364455 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:32:45.366488 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:32:45.369340 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:32:45.369590 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:32:45.428039 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c20dd6-0001-885a-000c-0f160003095e
[0m16:32:45.428462 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
[0m16:32:45.432134 [debug] [Thread-2 (]: Database Error in model listings (models/bronze/listings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/listings.sql
[0m16:32:45.432575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0162d5d7-19fb-4e0f-ad15-e575c52f75b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f7560>]}
[0m16:32:45.433164 [error] [Thread-2 (]: 3 of 3 ERROR creating sql view model semi_raw.listings ......................... [[31mERROR[0m in 0.08s]
[0m16:32:45.433676 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:32:45.434106 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.listings' to be skipped because of status 'error'.  Reason: Database Error in model listings (models/bronze/listings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/listings.sql.
[0m16:32:45.435104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:45.435403 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:32:45.435649 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:32:45.516832 [info ] [MainThread]: 
[0m16:32:45.517504 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m16:32:45.518472 [debug] [MainThread]: Command end result
[0m16:32:45.540406 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:32:45.547400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:32:45.553061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:32:45.553269 [info ] [MainThread]: 
[0m16:32:45.553499 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:32:45.553678 [info ] [MainThread]: 
[0m16:32:45.553912 [error] [MainThread]: [31mFailure in model bookings (models/bronze/bookings.sql)[0m
[0m16:32:45.554128 [error] [MainThread]:   Database Error in model bookings (models/bronze/bookings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/bookings.sql
[0m16:32:45.554291 [info ] [MainThread]: 
[0m16:32:45.554485 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/bronze/bookings.sql
[0m16:32:45.554645 [info ] [MainThread]: 
[0m16:32:45.554844 [error] [MainThread]: [31mFailure in model hosts (models/bronze/hosts.sql)[0m
[0m16:32:45.555041 [error] [MainThread]:   Database Error in model hosts (models/bronze/hosts.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/hosts.sql
[0m16:32:45.555195 [info ] [MainThread]: 
[0m16:32:45.555378 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/bronze/hosts.sql
[0m16:32:45.555530 [info ] [MainThread]: 
[0m16:32:45.555718 [error] [MainThread]: [31mFailure in model listings (models/bronze/listings.sql)[0m
[0m16:32:45.555913 [error] [MainThread]:   Database Error in model listings (models/bronze/listings.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB_PRO.STAGING' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/bronze/listings.sql
[0m16:32:45.556063 [info ] [MainThread]: 
[0m16:32:45.556229 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/bronze/listings.sql
[0m16:32:45.556365 [info ] [MainThread]: 
[0m16:32:45.556529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m16:32:45.556830 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:32:45.557200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.455637, "process_in_blocks": "0", "process_kernel_time": 0.991657, "process_mem_max_rss": "159514624", "process_out_blocks": "0", "process_user_time": 1.845647}
[0m16:32:45.557449 [debug] [MainThread]: Command `dbt run` failed at 16:32:45.557399 after 3.46 seconds
[0m16:32:45.557664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d003ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdfbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0890d0>]}
[0m16:32:45.557859 [debug] [MainThread]: Flushing usage events
[0m16:32:46.783660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:51.403663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109053b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5490>]}


============================== 16:33:51.409456 | af362c2b-9853-4003-8096-2b680047e5d5 ==============================
[0m16:33:51.409456 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:33:51.409810 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:52.407106 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:33:52.408367 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:33:52.408999 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:33:52.502318 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m16:33:52.502669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc9490>]}
[0m16:33:52.572663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f4d40>]}
[0m16:33:52.615724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c6150>]}
[0m16:33:52.619167 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:33:52.687542 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:33:52.843177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:52.843402 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:33:52.843513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:52.845902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_snowflake_aws_project.silver
[0m16:33:52.857229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a594080>]}
[0m16:33:52.884847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:33:52.894019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:33:52.961152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d48c0>]}
[0m16:33:52.961427 [info ] [MainThread]: Found 3 models, 3 sources, 523 macros
[0m16:33:52.961590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58ec90>]}
[0m16:33:52.962650 [info ] [MainThread]: 
[0m16:33:52.962812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:52.962934 [info ] [MainThread]: 
[0m16:33:52.963174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:52.965301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:33:53.429552 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:33:53.430230 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:33:53.430492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:54.262149 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.832 seconds
[0m16:33:54.264616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m16:33:54.274441 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:33:54.274686 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:33:54.362893 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m16:33:54.365737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c3cb0>]}
[0m16:33:54.373013 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:33:54.373729 [info ] [Thread-2 (]: 1 of 3 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:33:54.374495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:33:54.374880 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:33:54.382720 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:33:54.385636 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:33:54.405553 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:33:54.418734 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:33:54.418967 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:33:54.599571 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m16:33:54.629039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111080fb0>]}
[0m16:33:54.629651 [info ] [Thread-2 (]: 1 of 3 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.25s]
[0m16:33:54.630100 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:33:54.630388 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:33:54.630817 [info ] [Thread-2 (]: 2 of 3 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:33:54.631210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:33:54.631470 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:33:54.633744 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:33:54.637073 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:33:54.639278 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:33:54.651680 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:33:54.651985 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:33:54.826781 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m16:33:54.831149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115a480>]}
[0m16:33:54.832399 [info ] [Thread-2 (]: 2 of 3 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.20s]
[0m16:33:54.833409 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:33:54.834001 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:33:54.834701 [info ] [Thread-2 (]: 3 of 3 START sql view model semi_raw.listings .................................. [RUN]
[0m16:33:54.835374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:33:54.835834 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:33:54.840461 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:33:54.844387 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:33:54.847622 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:33:54.859401 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:33:54.859722 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:33:55.291333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m16:33:55.296079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af362c2b-9853-4003-8096-2b680047e5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111164590>]}
[0m16:33:55.296726 [info ] [Thread-2 (]: 3 of 3 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.46s]
[0m16:33:55.297285 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:33:55.298604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:55.298903 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listings' was left open.
[0m16:33:55.299138 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listings: Close
[0m16:33:55.394405 [info ] [MainThread]: 
[0m16:33:55.395421 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m16:33:55.396862 [debug] [MainThread]: Command end result
[0m16:33:55.421495 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:33:55.428083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:33:55.433540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:33:55.433726 [info ] [MainThread]: 
[0m16:33:55.433927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:55.434078 [info ] [MainThread]: 
[0m16:33:55.434249 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:33:55.434579 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:33:55.434978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.10124, "process_in_blocks": "0", "process_kernel_time": 1.120159, "process_mem_max_rss": "159367168", "process_out_blocks": "0", "process_user_time": 1.934012}
[0m16:33:55.435248 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:55.435193 after 4.10 seconds
[0m16:33:55.435478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4acc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cff80>]}
[0m16:33:55.435696 [debug] [MainThread]: Flushing usage events
[0m16:33:56.621252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:49.091366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab794c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab79430>]}


============================== 15:02:49.096517 | 6f40ada9-e648-457e-9127-1b7c47111b8f ==============================
[0m15:02:49.096517 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:02:49.096847 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'empty': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m15:02:50.320678 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:02:50.321931 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:02:50.322665 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:02:50.411022 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.silver.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m15:02:50.411361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1908f0>]}
[0m15:02:50.487912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fa6c0>]}
[0m15:02:50.531736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c41dc40>]}
[0m15:02:50.537074 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:02:50.609003 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:02:50.830993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:50.831383 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://analyses/ref.sql
[0m15:02:50.912282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c58fb60>]}
[0m15:02:50.945919 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:02:50.956823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:02:51.024175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caeeff0>]}
[0m15:02:51.024426 [info ] [MainThread]: Found 5 models, 3 analyses, 3 sources, 526 macros
[0m15:02:51.024593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd7d70>]}
[0m15:02:51.025618 [info ] [MainThread]: 
[0m15:02:51.025784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:51.025905 [info ] [MainThread]: 
[0m15:02:51.026133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:51.028354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_semi_raw'
[0m15:02:51.317974 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:02:51.318455 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:02:51.318779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:52.404904 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.086 seconds
[0m15:02:52.406593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m15:02:52.409572 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:02:52.409947 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:02:52.575698 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c2131c-0001-88f0-000c-0f1600034056
[0m15:02:52.576549 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:02:52.577309 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:02:52.577789 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:02:52.578963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f40ada9-e648-457e-9127-1b7c47111b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85dd30>]}
[0m15:02:52.590315 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:02:52.591269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.bookings)
[0m15:02:52.591798 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:02:52.601911 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:02:52.610014 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:02:52.610711 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:02:52.611052 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:02:52.611475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:02:52.611862 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:02:52.614451 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:02:52.621705 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:02:52.622300 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:02:52.622623 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:02:52.623023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:02:52.623414 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:02:52.625920 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:02:52.632624 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:02:52.633167 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:02:52.633489 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m15:02:52.633843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now analysis.dbt_snowflake_aws_project.if_else_jinja)
[0m15:02:52.634140 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m15:02:52.637252 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.if_else_jinja"
[0m15:02:52.640396 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m15:02:52.640827 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m15:02:52.641081 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m15:02:52.641352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.if_else_jinja, now analysis.dbt_snowflake_aws_project.incremental_load_m)
[0m15:02:52.641588 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m15:02:52.646303 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.incremental_load_m"
[0m15:02:52.648149 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m15:02:52.648578 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m15:02:52.648833 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.ref
[0m15:02:52.649100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.incremental_load_m, now analysis.dbt_snowflake_aws_project.ref)
[0m15:02:52.649328 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.ref
[0m15:02:52.651190 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.ref"
[0m15:02:52.652744 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.ref
[0m15:02:52.653087 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.ref
[0m15:02:52.653301 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:02:52.653516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.ref, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:02:52.653714 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:02:52.656276 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:02:52.658381 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:02:52.658722 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:02:52.658932 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:02:52.659144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:02:52.659337 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:02:52.661720 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:02:52.662805 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:02:52.663135 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:02:52.663741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:52.663916 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:02:52.664084 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:02:52.743481 [debug] [MainThread]: Command end result
[0m15:02:52.821503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:02:52.826805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:02:52.834640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:02:52.835159 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:02:52.835675 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.8076577, "process_in_blocks": "0", "process_kernel_time": 1.097936, "process_mem_max_rss": "161923072", "process_out_blocks": "0", "process_user_time": 1.922313}
[0m15:02:52.836005 [debug] [MainThread]: Command `dbt compile` succeeded at 15:02:52.835941 after 3.81 seconds
[0m15:02:52.836274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6aae10>]}
[0m15:02:52.836513 [debug] [MainThread]: Flushing usage events
[0m15:02:54.096683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:27.999625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d80b0>]}


============================== 15:03:28.004539 | fb1d6f7d-9c83-4823-abc1-e983b9234744 ==============================
[0m15:03:28.004539 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:03:28.004897 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m15:03:29.051441 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:03:29.052960 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:03:29.053641 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:03:29.151517 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.silver.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m15:03:29.151867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1b5b50>]}
[0m15:03:29.224929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e181250>]}
[0m15:03:29.269715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de49a00>]}
[0m15:03:29.272749 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:03:29.344000 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:03:29.503521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:29.503754 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:03:29.503870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:29.520772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e52be60>]}
[0m15:03:29.552014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:03:29.559198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:03:29.589457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e95e0>]}
[0m15:03:29.589676 [info ] [MainThread]: Found 5 models, 3 analyses, 3 sources, 526 macros
[0m15:03:29.589813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6aaae0>]}
[0m15:03:29.590653 [info ] [MainThread]: 
[0m15:03:29.590789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:29.590894 [info ] [MainThread]: 
[0m15:03:29.591087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:29.592857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:03:29.841023 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:03:29.841294 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:03:29.841450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:30.603530 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.762 seconds
[0m15:03:30.611058 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:03:30.611618 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:03:30.756019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.144 seconds
[0m15:03:30.759149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_silver)
[0m15:03:30.760055 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "silver"
"
[0m15:03:30.767099 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_silver"
[0m15:03:30.767451 [debug] [ThreadPool]: On create_AIRBNB_PRO_silver: create schema if not exists AIRBNB_PRO.silver
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_silver"} */
[0m15:03:30.890578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m15:03:30.892645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_silver, now list_AIRBNB_PRO_silver)
[0m15:03:30.902267 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:03:30.902544 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:03:31.001327 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.098 seconds
[0m15:03:31.004441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m15:03:31.008047 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:03:31.008451 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:03:31.141596 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.133 seconds
[0m15:03:31.146945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9aa450>]}
[0m15:03:31.156546 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:03:31.157210 [info ] [Thread-2 (]: 1 of 5 START sql view model semi_raw.bookings .................................. [RUN]
[0m15:03:31.157716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m15:03:31.158062 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:03:31.166084 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:03:31.168796 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:03:31.188753 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m15:03:31.192443 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m15:03:31.192656 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m15:03:31.394090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m15:03:31.424121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae11160>]}
[0m15:03:31.424739 [info ] [Thread-2 (]: 1 of 5 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.26s]
[0m15:03:31.425178 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:03:31.425469 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:03:31.425857 [info ] [Thread-2 (]: 2 of 5 START sql view model semi_raw.hosts ..................................... [RUN]
[0m15:03:31.426227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:03:31.426464 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:03:31.428464 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:03:31.431752 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:03:31.433651 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m15:03:31.438335 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m15:03:31.438619 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m15:03:31.657083 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m15:03:31.661514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f737620>]}
[0m15:03:31.662615 [info ] [Thread-2 (]: 2 of 5 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.24s]
[0m15:03:31.663398 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:03:31.663906 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:03:31.664630 [info ] [Thread-2 (]: 3 of 5 START sql view model semi_raw.listings .................................. [RUN]
[0m15:03:31.665218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:03:31.665598 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:03:31.670614 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:03:31.674082 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:03:31.676146 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m15:03:31.678746 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m15:03:31.679010 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m15:03:31.883452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m15:03:31.887990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e6f60>]}
[0m15:03:31.888999 [info ] [Thread-2 (]: 3 of 5 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.22s]
[0m15:03:31.889762 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:03:31.890265 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:03:31.890938 [info ] [Thread-2 (]: 4 of 5 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m15:03:31.891470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:03:31.891837 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:03:31.897091 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:03:31.901308 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:03:31.939821 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:03:31.943098 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:03:31.943287 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace transient table AIRBNB_PRO.silver.silver_bookings
    
    
    
    as (

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_booking_amount
from
    AIRBNB_PRO.semi_raw.bookings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:03:32.210345 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2131d-0001-8904-000c-0f1600035026
[0m15:03:32.211467 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'TOTAL_BOOKING_AMOUNT'
[0m15:03:32.220527 [debug] [Thread-2 (]: Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'TOTAL_BOOKING_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m15:03:32.221472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6f2420>]}
[0m15:03:32.222511 [error] [Thread-2 (]: 4 of 5 ERROR creating sql incremental model silver.silver_bookings ............. [[31mERROR[0m in 0.33s]
[0m15:03:32.223215 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:03:32.223698 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:03:32.224215 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_bookings' to be skipped because of status 'error'.  Reason: Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'TOTAL_BOOKING_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql.
[0m15:03:32.224939 [info ] [Thread-2 (]: 5 of 5 START sql incremental model silver.silver_listings ...................... [RUN]
[0m15:03:32.226366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:03:32.226760 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:03:32.231510 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:03:32.235143 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:03:32.237860 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:03:32.240195 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:03:32.240476 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace transient table AIRBNB_PRO.silver.silver_listings
    
    
    
    as (

select 
    listing_id,
    listing_name,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:03:32.343091 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2131d-0001-88f0-000c-0f1600034062
[0m15:03:32.344222 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'LISTING_NAME'
[0m15:03:32.349612 [debug] [Thread-2 (]: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:03:32.350364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1d6f7d-9c83-4823-abc1-e983b9234744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f742330>]}
[0m15:03:32.351318 [error] [Thread-2 (]: 5 of 5 ERROR creating sql incremental model silver.silver_listings ............. [[31mERROR[0m in 0.12s]
[0m15:03:32.352016 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:03:32.352589 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_listings' to be skipped because of status 'error'.  Reason: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql.
[0m15:03:32.354244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:32.354588 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:03:32.354918 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:03:32.440566 [info ] [MainThread]: 
[0m15:03:32.441584 [info ] [MainThread]: Finished running 2 incremental models, 3 view models in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m15:03:32.443169 [debug] [MainThread]: Command end result
[0m15:03:32.515402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:03:32.522197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:03:32.530034 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:03:32.530238 [info ] [MainThread]: 
[0m15:03:32.530450 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:03:32.530614 [info ] [MainThread]: 
[0m15:03:32.530833 [error] [MainThread]: [31mFailure in model silver_bookings (models/silver/silver_bookings.sql)[0m
[0m15:03:32.531028 [error] [MainThread]:   Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'TOTAL_BOOKING_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m15:03:32.531177 [info ] [MainThread]: 
[0m15:03:32.531346 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m15:03:32.531488 [info ] [MainThread]: 
[0m15:03:32.531665 [error] [MainThread]: [31mFailure in model silver_listings (models/silver/silver_listings.sql)[0m
[0m15:03:32.531841 [error] [MainThread]:   Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:03:32.531978 [info ] [MainThread]: 
[0m15:03:32.532144 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:03:32.532281 [info ] [MainThread]: 
[0m15:03:32.532449 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m15:03:32.532756 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:03:32.533127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6044245, "process_in_blocks": "0", "process_kernel_time": 1.0223, "process_mem_max_rss": "161005568", "process_out_blocks": "0", "process_user_time": 2.152142}
[0m15:03:32.533371 [debug] [MainThread]: Command `dbt run` failed at 15:03:32.533327 after 4.60 seconds
[0m15:03:32.533574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115012c90>]}
[0m15:03:32.533760 [debug] [MainThread]: Flushing usage events
[0m15:03:34.034720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:17.614984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b594dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6bfe0>]}


============================== 15:13:17.620324 | 1cf449be-83de-4443-bbb9-ab7cee4a589c ==============================
[0m15:13:17.620324 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:13:17.620675 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/silver_bookings', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False'}
[0m15:13:18.703985 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:13:18.704602 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:13:18.704872 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:13:18.773884 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.bronze.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m15:13:18.774217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e632060>]}
[0m15:13:18.852043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd0c650>]}
[0m15:13:18.898106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98c5f0>]}
[0m15:13:18.901556 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:13:18.984816 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:13:19.027360 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:19.027625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee14b60>]}
[0m15:13:19.066686 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `materialized` as a top-level property of `models[0]` in file
`models/bronze/properties.yml`. The `materialized` top-level property should be
moved into the `config` of `models[0]`.
[0m15:13:19.066922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd8e90>]}
[0m15:13:19.199736 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m15:13:19.200014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cf449be-83de-4443-bbb9-ab7cee4a589c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdbb30>]}
[0m15:13:19.592338 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'BRONZE' in the 'models' section of file 'models/bronze/properties.yml'
[0m15:13:19.627506 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.silver_bookings' (models/silver/silver_bookings.sql) depends on a node named 'bronze.bookings' which was not found
[0m15:13:19.627912 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
- PropertyMovedToConfigDeprecation: 1 occurrence
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:13:19.628220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.079802, "process_in_blocks": "0", "process_kernel_time": 0.817082, "process_mem_max_rss": "148242432", "process_out_blocks": "0", "process_user_time": 1.901896}
[0m15:13:19.628404 [debug] [MainThread]: Command `dbt run` failed at 15:13:19.628370 after 2.08 seconds
[0m15:13:19.628551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d82f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daf02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12ab10>]}
[0m15:13:19.628680 [debug] [MainThread]: Flushing usage events
[0m15:13:20.711861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:31.574784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d360500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccad3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccad490>]}


============================== 15:13:31.579243 | 3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d ==============================
[0m15:13:31.579243 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:13:31.579556 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select models/silver/silver_bookings', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs'}
[0m15:13:32.725693 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:13:32.727310 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:13:32.728199 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:13:32.821991 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.silver.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m15:13:32.822344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6cd220>]}
[0m15:13:32.894259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b289fd0>]}
[0m15:13:32.938048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de21340>]}
[0m15:13:32.940777 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:13:33.008534 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:13:33.045460 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:33.045699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eadc7a0>]}
[0m15:13:33.076211 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `materialized` as a top-level property of `models[0]` in file
`models/bronze/properties.yml`. The `materialized` top-level property should be
moved into the `config` of `models[0]`.
[0m15:13:33.076467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e0e90>]}
[0m15:13:33.180340 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m15:13:33.180616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ec4be3b-b1fb-43c5-8575-0fd9e0a21e3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e0e90>]}
[0m15:13:33.568069 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'BRONZE' in the 'models' section of file 'models/bronze/properties.yml'
[0m15:13:33.603444 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.silver_bookings' (models/silver/silver_bookings.sql) depends on a node named 'bronze.bookings' which was not found
[0m15:13:33.603848 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
- PropertyMovedToConfigDeprecation: 1 occurrence
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:13:33.604141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0913951, "process_in_blocks": "0", "process_kernel_time": 0.860325, "process_mem_max_rss": "147914752", "process_out_blocks": "0", "process_user_time": 2.01758}
[0m15:13:33.604316 [debug] [MainThread]: Command `dbt run` failed at 15:13:33.604282 after 2.09 seconds
[0m15:13:33.604461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9bbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed39910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80cd70>]}
[0m15:13:33.604583 [debug] [MainThread]: Flushing usage events
[0m15:13:34.657639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:42.165167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108545400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108545370>]}


============================== 15:13:42.170079 | c61427ea-dec8-4d20-9696-2653fed4124c ==============================
[0m15:13:42.170079 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:13:42.170451 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m15:13:43.335822 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:13:43.337089 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:13:43.337768 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:13:43.428500 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at
`dbt_snowflake_aws_project.silver.schema` in file `/Users/aadil.mansoori/Desktop
/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml`.
Hierarchical config values without a '+' prefix are deprecated in
dbt_project.yml.
[0m15:13:43.428857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e19fd0>]}
[0m15:13:43.498694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbbc20>]}
[0m15:13:43.542623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d56930>]}
[0m15:13:43.545517 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:13:43.613998 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:13:43.651436 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:43.651678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e6900>]}
[0m15:13:43.675279 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `materialized` as a top-level property of `models[0]` in file
`models/bronze/properties.yml`. The `materialized` top-level property should be
moved into the `config` of `models[0]`.
[0m15:13:43.675539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859cad0>]}
[0m15:13:43.779408 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m15:13:43.779669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c61427ea-dec8-4d20-9696-2653fed4124c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859cad0>]}
[0m15:13:44.161901 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'BRONZE' in the 'models' section of file 'models/bronze/properties.yml'
[0m15:13:44.195511 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.silver_bookings' (models/silver/silver_bookings.sql) depends on a node named 'bronze.bookings' which was not found
[0m15:13:44.195900 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 2 occurrences
- PropertyMovedToConfigDeprecation: 1 occurrence
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:13:44.196189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1008735, "process_in_blocks": "0", "process_kernel_time": 0.800635, "process_mem_max_rss": "147980288", "process_out_blocks": "0", "process_user_time": 2.021294}
[0m15:13:44.196359 [debug] [MainThread]: Command `dbt run` failed at 15:13:44.196323 after 2.10 seconds
[0m15:13:44.196520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a280440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01e870>]}
[0m15:13:44.196641 [debug] [MainThread]: Flushing usage events
[0m15:13:45.213864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:44.462917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e117fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e117fe0>]}


============================== 15:19:44.468394 | 9166114a-e32d-4692-8bf5-a8f7a0a8eba4 ==============================
[0m15:19:44.468394 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:19:44.468766 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'empty': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None'}
[0m15:19:45.624558 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:19:45.625102 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:19:45.625363 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:19:45.739004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec05c0>]}
[0m15:19:45.782882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d630e90>]}
[0m15:19:45.786392 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:19:45.863857 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:19:45.902282 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:19:45.902538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ac5f0>]}
[0m15:19:46.120924 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m15:19:46.121389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d3b30>]}
[0m15:19:46.615110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5e7380>]}
[0m15:19:46.646088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:19:46.656442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:19:46.704798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6169c0>]}
[0m15:19:46.705041 [info ] [MainThread]: Found 5 models, 3 analyses, 3 sources, 526 macros
[0m15:19:46.705197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5ddb80>]}
[0m15:19:46.706067 [info ] [MainThread]: 
[0m15:19:46.706216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:46.706327 [info ] [MainThread]: 
[0m15:19:46.706519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:46.708374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:19:46.980543 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:19:46.980975 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:19:46.981251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:48.278570 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.297 seconds
[0m15:19:48.288528 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:19:48.289105 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:19:48.376972 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.087 seconds
[0m15:19:48.382380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m15:19:48.398900 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:19:48.399274 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:19:48.581691 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.182 seconds
[0m15:19:48.585036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m15:19:48.588865 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:19:48.589214 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:19:48.710630 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.121 seconds
[0m15:19:48.716118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5df1d0>]}
[0m15:19:48.729174 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:19:48.730036 [info ] [Thread-2 (]: 1 of 5 START sql view model semi_raw.bookings .................................. [RUN]
[0m15:19:48.730727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m15:19:48.731197 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:19:48.740219 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:19:48.748896 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:19:48.767520 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m15:19:48.778621 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m15:19:48.778856 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m15:19:49.195464 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m15:19:49.227686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc3d490>]}
[0m15:19:49.228325 [info ] [Thread-2 (]: 1 of 5 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.49s]
[0m15:19:49.228772 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:19:49.229069 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:19:49.229489 [info ] [Thread-2 (]: 2 of 5 START sql view model semi_raw.hosts ..................................... [RUN]
[0m15:19:49.229926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:19:49.230206 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:19:49.232434 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:19:49.239862 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:19:49.242420 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m15:19:49.253009 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m15:19:49.253263 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m15:19:49.491346 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m15:19:49.495735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110000920>]}
[0m15:19:49.496931 [info ] [Thread-2 (]: 2 of 5 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.27s]
[0m15:19:49.497867 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:19:49.498405 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:19:49.499056 [info ] [Thread-2 (]: 3 of 5 START sql view model semi_raw.listings .................................. [RUN]
[0m15:19:49.499707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:19:49.500156 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:19:49.507355 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:19:49.515736 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:19:49.518269 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m15:19:49.530951 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m15:19:49.531268 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m15:19:49.865368 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m15:19:49.869648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110575730>]}
[0m15:19:49.870899 [info ] [Thread-2 (]: 3 of 5 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.37s]
[0m15:19:49.871960 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:19:49.872637 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:19:49.873596 [info ] [Thread-2 (]: 4 of 5 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m15:19:49.874240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:19:49.874682 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:19:49.880539 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:19:49.896834 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:19:49.933340 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:19:49.936488 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:19:49.936666 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace transient table AIRBNB_PRO.silver.silver_bookings
    
    
    
    as (

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:19:51.316098 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.379 seconds
[0m15:19:51.328440 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m15:19:51.333760 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:19:51.334026 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:19:51.448344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m15:19:51.451265 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fd340>]}
[0m15:19:51.452180 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 1[0m in 1.58s]
[0m15:19:51.453029 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:19:51.453591 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:19:51.454323 [info ] [Thread-2 (]: 5 of 5 START sql incremental model silver.silver_listings ...................... [RUN]
[0m15:19:51.455010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:19:51.455538 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:19:51.459521 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:19:51.470470 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:19:51.472135 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:19:51.474238 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:19:51.474403 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace transient table AIRBNB_PRO.silver.silver_listings
    
    
    
    as (

select 
    listing_id,
    listing_name,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:19:51.626652 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2132d-0001-88b7-000c-0f1600037026
[0m15:19:51.627440 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'LISTING_NAME'
[0m15:19:51.633752 [debug] [Thread-2 (]: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:19:51.634393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9166114a-e32d-4692-8bf5-a8f7a0a8eba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105eee10>]}
[0m15:19:51.635188 [error] [Thread-2 (]: 5 of 5 ERROR creating sql incremental model silver.silver_listings ............. [[31mERROR[0m in 0.18s]
[0m15:19:51.635827 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:19:51.636378 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_listings' to be skipped because of status 'error'.  Reason: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql.
[0m15:19:51.638343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:51.638658 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:19:51.638931 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:19:51.751177 [info ] [MainThread]: 
[0m15:19:51.752176 [info ] [MainThread]: Finished running 2 incremental models, 3 view models in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m15:19:51.754275 [debug] [MainThread]: Command end result
[0m15:19:51.782033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:19:51.787631 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:19:51.793573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:19:51.793785 [info ] [MainThread]: 
[0m15:19:51.794002 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:19:51.794182 [info ] [MainThread]: 
[0m15:19:51.794404 [error] [MainThread]: [31mFailure in model silver_listings (models/silver/silver_listings.sql)[0m
[0m15:19:51.794622 [error] [MainThread]:   Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'LISTING_NAME'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:19:51.794783 [info ] [MainThread]: 
[0m15:19:51.794978 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:19:51.795140 [info ] [MainThread]: 
[0m15:19:51.795315 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:19:51.795639 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:19:51.796035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.401697, "process_in_blocks": "0", "process_kernel_time": 1.118536, "process_mem_max_rss": "167510016", "process_out_blocks": "0", "process_user_time": 2.517439}
[0m15:19:51.796294 [debug] [MainThread]: Command `dbt run` failed at 15:19:51.796244 after 7.40 seconds
[0m15:19:51.796521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b4560>]}
[0m15:19:51.796746 [debug] [MainThread]: Flushing usage events
[0m15:19:53.326385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:09.279472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfcbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfcbc20>]}


============================== 15:22:09.284422 | fe6b1577-8b3a-481f-9efa-43b763d64f44 ==============================
[0m15:22:09.284422 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:22:09.284754 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'target_path': 'None', 'quiet': 'False'}
[0m15:22:09.354790 [info ] [MainThread]: dbt version: 1.11.2
[0m15:22:09.355128 [info ] [MainThread]: python version: 3.12.11
[0m15:22:09.355304 [info ] [MainThread]: python path: /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/.venv/bin/python3
[0m15:22:09.355455 [info ] [MainThread]: os info: macOS-26.2-arm64-arm-64bit
[0m15:22:10.505227 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:22:10.505561 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:22:10.505735 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:22:10.543184 [info ] [MainThread]: Using profiles dir at /Users/aadil.mansoori/.dbt
[0m15:22:10.543396 [info ] [MainThread]: Using profiles.yml file at /Users/aadil.mansoori/.dbt/profiles.yml
[0m15:22:10.543528 [info ] [MainThread]: Using dbt_project.yml file at /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml
[0m15:22:10.544998 [info ] [MainThread]: adapter type: snowflake
[0m15:22:10.545144 [info ] [MainThread]: adapter version: 1.11.1
[0m15:22:10.583356 [info ] [MainThread]: Configuration:
[0m15:22:10.583584 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:22:10.583709 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:22:10.583809 [info ] [MainThread]: Required dependencies:
[0m15:22:10.584327 [debug] [MainThread]: Executing "git --help"
[0m15:22:10.612727 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:22:10.613188 [debug] [MainThread]: STDERR: "b''"
[0m15:22:10.613332 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:22:10.613469 [info ] [MainThread]: Connection:
[0m15:22:10.613608 [info ] [MainThread]:   account: BMDPGER-RV28327
[0m15:22:10.613707 [info ] [MainThread]:   user: AADIL111
[0m15:22:10.613802 [info ] [MainThread]:   database: AIRBNB_PRO
[0m15:22:10.613900 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:22:10.613999 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m15:22:10.614095 [info ] [MainThread]:   schema: dbt_schema
[0m15:22:10.614183 [info ] [MainThread]:   authenticator: None
[0m15:22:10.614273 [info ] [MainThread]:   oauth_client_id: None
[0m15:22:10.614356 [info ] [MainThread]:   query_tag: None
[0m15:22:10.614446 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:22:10.614543 [info ] [MainThread]:   host: None
[0m15:22:10.614632 [info ] [MainThread]:   port: None
[0m15:22:10.614720 [info ] [MainThread]:   proxy_host: None
[0m15:22:10.614812 [info ] [MainThread]:   proxy_port: None
[0m15:22:10.614897 [info ] [MainThread]:   protocol: None
[0m15:22:10.614985 [info ] [MainThread]:   connect_retries: 1
[0m15:22:10.615069 [info ] [MainThread]:   connect_timeout: None
[0m15:22:10.615170 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:22:10.615261 [info ] [MainThread]:   retry_all: False
[0m15:22:10.615349 [info ] [MainThread]:   insecure_mode: False
[0m15:22:10.615436 [info ] [MainThread]:   reuse_connections: True
[0m15:22:10.615524 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m15:22:10.615615 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m15:22:10.615907 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:22:10.683505 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:22:10.962743 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:22:10.962975 [debug] [MainThread]: On debug: select 1 as id
[0m15:22:10.963104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:11.812483 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.849 seconds
[0m15:22:11.814840 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:22:11.815488 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:22:11.816400 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6051278, "process_in_blocks": "0", "process_kernel_time": 1.007627, "process_mem_max_rss": "153370624", "process_out_blocks": "0", "process_user_time": 1.594281}
[0m15:22:11.816911 [debug] [MainThread]: Command `dbt debug` succeeded at 15:22:11.816799 after 2.61 seconds
[0m15:22:11.817275 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:22:11.817565 [debug] [MainThread]: On debug: Close
[0m15:22:11.998909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec8c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec8ffe0>]}
[0m15:22:12.000030 [debug] [MainThread]: Flushing usage events
[0m15:22:13.076527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:16.007276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deebaa0>]}


============================== 15:23:16.013483 | 914f3ab0-7724-4447-ae12-14bb89e8fbca ==============================
[0m15:23:16.013483 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:23:16.013844 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m15:23:16.046890 [info ] [MainThread]: dbt version: 1.11.2
[0m15:23:16.047152 [info ] [MainThread]: python version: 3.12.11
[0m15:23:16.047302 [info ] [MainThread]: python path: /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/.venv/bin/python3
[0m15:23:16.047431 [info ] [MainThread]: os info: macOS-26.2-arm64-arm-64bit
[0m15:23:17.069433 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:23:17.070117 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:23:17.070414 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:23:17.140237 [info ] [MainThread]: Using profiles dir at /Users/aadil.mansoori/.dbt
[0m15:23:17.140529 [info ] [MainThread]: Using profiles.yml file at /Users/aadil.mansoori/.dbt/profiles.yml
[0m15:23:17.140704 [info ] [MainThread]: Using dbt_project.yml file at /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/dbt_project.yml
[0m15:23:17.143171 [info ] [MainThread]: adapter type: snowflake
[0m15:23:17.143329 [info ] [MainThread]: adapter version: 1.11.1
[0m15:23:17.188947 [info ] [MainThread]: Configuration:
[0m15:23:17.189190 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:23:17.189315 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:23:17.189418 [info ] [MainThread]: Required dependencies:
[0m15:23:17.189910 [debug] [MainThread]: Executing "git --help"
[0m15:23:17.225214 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:23:17.225685 [debug] [MainThread]: STDERR: "b''"
[0m15:23:17.225821 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:23:17.225951 [info ] [MainThread]: Connection:
[0m15:23:17.226088 [info ] [MainThread]:   account: BMDPGER-RV28327
[0m15:23:17.226188 [info ] [MainThread]:   user: AADIL111
[0m15:23:17.226284 [info ] [MainThread]:   database: AIRBNB_PRO
[0m15:23:17.226380 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:23:17.226469 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m15:23:17.226562 [info ] [MainThread]:   schema: dbt_schema
[0m15:23:17.226648 [info ] [MainThread]:   authenticator: None
[0m15:23:17.226736 [info ] [MainThread]:   oauth_client_id: None
[0m15:23:17.226825 [info ] [MainThread]:   query_tag: None
[0m15:23:17.226912 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:23:17.227000 [info ] [MainThread]:   host: None
[0m15:23:17.227090 [info ] [MainThread]:   port: None
[0m15:23:17.227175 [info ] [MainThread]:   proxy_host: None
[0m15:23:17.227263 [info ] [MainThread]:   proxy_port: None
[0m15:23:17.227348 [info ] [MainThread]:   protocol: None
[0m15:23:17.227433 [info ] [MainThread]:   connect_retries: 1
[0m15:23:17.227517 [info ] [MainThread]:   connect_timeout: None
[0m15:23:17.227601 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:23:17.227687 [info ] [MainThread]:   retry_all: False
[0m15:23:17.227772 [info ] [MainThread]:   insecure_mode: False
[0m15:23:17.227856 [info ] [MainThread]:   reuse_connections: True
[0m15:23:17.227941 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m15:23:17.228028 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m15:23:17.228302 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:23:17.294086 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:23:17.594835 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:23:17.595076 [debug] [MainThread]: On debug: select 1 as id
[0m15:23:17.595198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:18.354137 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.759 seconds
[0m15:23:18.356427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:23:18.357242 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:23:18.358442 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.4239037, "process_in_blocks": "0", "process_kernel_time": 0.693506, "process_mem_max_rss": "153501696", "process_out_blocks": "0", "process_user_time": 1.529996}
[0m15:23:18.359299 [debug] [MainThread]: Command `dbt debug` succeeded at 15:23:18.359134 after 2.42 seconds
[0m15:23:18.359882 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:23:18.360367 [debug] [MainThread]: On debug: Close
[0m15:23:18.442440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb13f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71c950>]}
[0m15:23:18.443411 [debug] [MainThread]: Flushing usage events
[0m15:23:19.524363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:50.385064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893d4f0>]}


============================== 15:24:50.390440 | 2435048a-019e-4705-85b4-8a0a07effac5 ==============================
[0m15:24:50.390440 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:24:50.390795 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'empty': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False'}
[0m15:24:51.545988 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:24:51.547054 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:24:51.547472 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:24:51.700306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a48fc50>]}
[0m15:24:51.744331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32dc10>]}
[0m15:24:51.747065 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:24:51.819222 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:24:52.036074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:52.036473 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/silver/silver_listings.sql
[0m15:24:52.140596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93c9b0>]}
[0m15:24:52.242406 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:24:52.250788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:24:52.320120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa50b90>]}
[0m15:24:52.320460 [info ] [MainThread]: Found 5 models, 3 analyses, 3 sources, 526 macros
[0m15:24:52.320687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d08c0>]}
[0m15:24:52.322075 [info ] [MainThread]: 
[0m15:24:52.322298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:52.322464 [info ] [MainThread]: 
[0m15:24:52.322784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:52.325851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:24:52.847009 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:24:52.847642 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:24:52.847979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:53.710760 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.863 seconds
[0m15:24:53.715888 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:24:53.716248 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:24:53.785049 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.068 seconds
[0m15:24:53.788951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m15:24:53.802408 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:24:53.802810 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:24:53.883330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m15:24:53.887803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m15:24:53.893029 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:24:53.893564 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:24:53.976395 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.082 seconds
[0m15:24:53.981447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eef00>]}
[0m15:24:53.999677 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:24:54.000839 [info ] [Thread-2 (]: 1 of 5 START sql view model semi_raw.bookings .................................. [RUN]
[0m15:24:54.001685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m15:24:54.002157 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:24:54.011492 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:24:54.015019 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:24:54.035290 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m15:24:54.037322 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m15:24:54.037548 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m15:24:54.205533 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m15:24:54.238977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f556d0>]}
[0m15:24:54.239640 [info ] [Thread-2 (]: 1 of 5 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.23s]
[0m15:24:54.240113 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:24:54.240408 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:24:54.240858 [info ] [Thread-2 (]: 2 of 5 START sql view model semi_raw.hosts ..................................... [RUN]
[0m15:24:54.241328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:24:54.241614 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:24:54.243903 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:24:54.246796 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:24:54.248938 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m15:24:54.252057 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m15:24:54.252288 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m15:24:54.432031 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m15:24:54.436648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb1dfd0>]}
[0m15:24:54.437634 [info ] [Thread-2 (]: 2 of 5 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.20s]
[0m15:24:54.438408 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:24:54.438892 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:24:54.439449 [info ] [Thread-2 (]: 3 of 5 START sql view model semi_raw.listings .................................. [RUN]
[0m15:24:54.440040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:24:54.440427 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:24:54.445942 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:24:54.449433 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:24:54.451617 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m15:24:54.453461 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m15:24:54.453799 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m15:24:54.671395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m15:24:54.675339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac9640>]}
[0m15:24:54.676397 [info ] [Thread-2 (]: 3 of 5 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.24s]
[0m15:24:54.677184 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:24:54.677682 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:24:54.678254 [info ] [Thread-2 (]: 4 of 5 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m15:24:54.678932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:24:54.679406 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:24:54.685046 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:54.689507 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:24:54.717781 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:54.718050 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:24:54.916768 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m15:24:54.925503 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:54.925872 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:24:55.007159 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.081 seconds
[0m15:24:55.015222 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.015880 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:24:55.098222 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.082 seconds
[0m15:24:55.110560 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.111058 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:24:55.189921 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.078 seconds
[0m15:24:55.226660 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.230758 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.231015 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:24:55.311775 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m15:24:55.312523 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.312974 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:24:55.971055 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.658 seconds
[0m15:24:55.971626 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:55.971954 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:24:56.173544 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m15:24:56.184568 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m15:24:56.190879 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:24:56.191292 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:24:56.306684 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m15:24:56.308774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb67c50>]}
[0m15:24:56.309468 [info ] [Thread-2 (]: 4 of 5 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.63s]
[0m15:24:56.310140 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:24:56.310664 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:24:56.311190 [info ] [Thread-2 (]: 5 of 5 START sql incremental model silver.silver_listings ...................... [RUN]
[0m15:24:56.311692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:24:56.312066 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:24:56.315950 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:24:56.317285 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:24:56.329877 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:24:56.330863 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:24:56.331060 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace transient table AIRBNB_PRO.silver.silver_listings
    
    
    
    as (

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:24:57.030781 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m15:24:57.034514 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m15:24:57.035450 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:24:57.035873 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:24:57.099401 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m15:24:57.101812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2435048a-019e-4705-85b4-8a0a07effac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b7200>]}
[0m15:24:57.102553 [info ] [Thread-2 (]: 5 of 5 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 1[0m in 0.79s]
[0m15:24:57.103219 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:24:57.104593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:57.104964 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:24:57.105314 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:24:57.211971 [info ] [MainThread]: 
[0m15:24:57.212504 [info ] [MainThread]: Finished running 2 incremental models, 3 view models in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m15:24:57.213746 [debug] [MainThread]: Command end result
[0m15:24:57.234829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:24:57.237546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:24:57.241041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:24:57.241202 [info ] [MainThread]: 
[0m15:24:57.241362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:57.241480 [info ] [MainThread]: 
[0m15:24:57.241608 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:24:57.241884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9258456, "process_in_blocks": "0", "process_kernel_time": 1.147029, "process_mem_max_rss": "166363136", "process_out_blocks": "0", "process_user_time": 2.146058}
[0m15:24:57.242069 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:57.242033 after 6.93 seconds
[0m15:24:57.242224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a901490>]}
[0m15:24:57.242368 [debug] [MainThread]: Flushing usage events
[0m15:24:58.200946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:39.389631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d30eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de280e0>]}


============================== 15:52:39.395545 | 0e2ebe14-1e67-4a33-9f70-07889cca9a08 ==============================
[0m15:52:39.395545 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:52:39.395886 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select model/silver_hosts', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m15:52:40.612905 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:52:40.614078 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:52:40.614759 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:52:40.773125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e2ebe14-1e67-4a33-9f70-07889cca9a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6fe450>]}
[0m15:52:40.818512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e2ebe14-1e67-4a33-9f70-07889cca9a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a47a0>]}
[0m15:52:40.821853 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:52:40.893415 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:52:41.077604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:52:41.077911 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/silver/silver_hosts.sql
[0m15:52:41.148778 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.silver_hosts' (models/silver/silver_hosts.sql) depends on a node named 'bronze_hosts' which was not found
[0m15:52:41.149160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.829526, "process_in_blocks": "0", "process_kernel_time": 0.904883, "process_mem_max_rss": "143376384", "process_out_blocks": "0", "process_user_time": 1.599499}
[0m15:52:41.149374 [debug] [MainThread]: Command `dbt run` failed at 15:52:41.149340 after 1.83 seconds
[0m15:52:41.149529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de283b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efde150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98a5a0>]}
[0m15:52:41.149663 [debug] [MainThread]: Flushing usage events
[0m15:52:42.368262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:00.941541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963fe00>]}


============================== 15:53:00.944722 | 82ff7120-14d1-4c3a-93fa-3577b7c82844 ==============================
[0m15:53:00.944722 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:53:00.944981 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select model/silver_hosts', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True'}
[0m15:53:01.331624 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:53:01.332079 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:53:01.332338 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:53:01.456539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82ff7120-14d1-4c3a-93fa-3577b7c82844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c4b00>]}
[0m15:53:01.508130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82ff7120-14d1-4c3a-93fa-3577b7c82844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108883260>]}
[0m15:53:01.510266 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:53:01.578377 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:53:01.745535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:53:01.745847 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/silver/silver_hosts.sql
[0m15:53:01.841286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ff7120-14d1-4c3a-93fa-3577b7c82844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa00b00>]}
[0m15:53:01.934791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:53:01.942636 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:53:01.997699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ff7120-14d1-4c3a-93fa-3577b7c82844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60ac00>]}
[0m15:53:01.998007 [info ] [MainThread]: Found 6 models, 3 analyses, 3 sources, 526 macros
[0m15:53:01.998210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ff7120-14d1-4c3a-93fa-3577b7c82844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a69e4b0>]}
[0m15:53:01.999222 [warn ] [MainThread]: The selection criterion 'model/silver_hosts' does not match any enabled nodes
[0m15:53:01.999984 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:53:02.000297 [debug] [MainThread]: Command end result
[0m15:53:02.013860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:53:02.018212 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:53:02.026194 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:53:02.026581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1257678, "process_in_blocks": "0", "process_kernel_time": 0.240678, "process_mem_max_rss": "146407424", "process_out_blocks": "0", "process_user_time": 1.031882}
[0m15:53:02.026892 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:02.026842 after 1.13 seconds
[0m15:53:02.027105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10046f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109369220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963ff50>]}
[0m15:53:02.027286 [debug] [MainThread]: Flushing usage events
[0m15:53:03.063449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:16.575657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b190da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b254410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2545c0>]}


============================== 15:53:16.580675 | 7f2a64ef-761c-4acc-b439-45d1e5dbd596 ==============================
[0m15:53:16.580675 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:53:16.581043 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select model/silver', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m15:53:17.744545 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:53:17.745820 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:53:17.746452 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:53:17.905872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f2a64ef-761c-4acc-b439-45d1e5dbd596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fe000>]}
[0m15:53:17.949933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f2a64ef-761c-4acc-b439-45d1e5dbd596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15b3b0>]}
[0m15:53:17.952088 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:53:18.023072 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:53:18.181094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:18.181311 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:53:18.181440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:18.197942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f2a64ef-761c-4acc-b439-45d1e5dbd596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25bf80>]}
[0m15:53:18.288911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:53:18.294474 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:53:18.334678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f2a64ef-761c-4acc-b439-45d1e5dbd596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fcc50>]}
[0m15:53:18.334979 [info ] [MainThread]: Found 6 models, 3 analyses, 3 sources, 526 macros
[0m15:53:18.335176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2a64ef-761c-4acc-b439-45d1e5dbd596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac1b7d0>]}
[0m15:53:18.336187 [warn ] [MainThread]: The selection criterion 'model/silver' does not match any enabled nodes
[0m15:53:18.336879 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:53:18.337929 [debug] [MainThread]: Command end result
[0m15:53:18.351201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:53:18.356294 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:53:18.359636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:53:18.359960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8525686, "process_in_blocks": "0", "process_kernel_time": 0.703142, "process_mem_max_rss": "141377536", "process_out_blocks": "0", "process_user_time": 1.546855}
[0m15:53:18.360220 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:18.360174 after 1.85 seconds
[0m15:53:18.360401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10211b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020ff5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2aff80>]}
[0m15:53:18.360567 [debug] [MainThread]: Flushing usage events
[0m15:53:19.557421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:04.186510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4048c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d405400>]}


============================== 15:54:04.191347 | fbd23f1c-2530-46e8-b890-4c3ae7b56d17 ==============================
[0m15:54:04.191347 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:54:04.191698 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:54:04.749239 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:54:04.749723 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:54:04.749929 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:54:04.874745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc7080>]}
[0m15:54:04.940737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec16ff0>]}
[0m15:54:04.943391 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:54:05.017402 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:54:05.208182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:05.208417 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:54:05.208543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:05.226771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e91da30>]}
[0m15:54:05.322164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:54:05.328516 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:54:05.387249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f331100>]}
[0m15:54:05.387617 [info ] [MainThread]: Found 6 models, 3 analyses, 3 sources, 526 macros
[0m15:54:05.387818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4e090>]}
[0m15:54:05.389061 [info ] [MainThread]: 
[0m15:54:05.389264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:05.389406 [info ] [MainThread]: 
[0m15:54:05.389691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:05.392223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:54:05.647611 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:54:05.647799 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:54:05.647906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:06.737800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.090 seconds
[0m15:54:06.741588 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:54:06.741999 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:54:07.033319 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.291 seconds
[0m15:54:07.034962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m15:54:07.041366 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:54:07.041595 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:54:07.351419 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.309 seconds
[0m15:54:07.355469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m15:54:07.360937 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:54:07.361873 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:54:07.464685 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.102 seconds
[0m15:54:07.469428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3a060>]}
[0m15:54:07.482105 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:54:07.483238 [info ] [Thread-2 (]: 1 of 6 START sql view model semi_raw.bookings .................................. [RUN]
[0m15:54:07.484073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m15:54:07.484538 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:54:07.493371 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:54:07.503025 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:54:07.522556 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m15:54:07.541188 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m15:54:07.541432 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m15:54:07.784107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m15:54:07.807564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a9010>]}
[0m15:54:07.808056 [info ] [Thread-2 (]: 1 of 6 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.32s]
[0m15:54:07.808442 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:54:07.808693 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:54:07.809087 [info ] [Thread-2 (]: 2 of 6 START sql view model semi_raw.hosts ..................................... [RUN]
[0m15:54:07.809474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:54:07.809701 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:54:07.811582 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:54:07.816017 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:54:07.817559 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m15:54:07.825511 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m15:54:07.825730 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m15:54:08.076470 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m15:54:08.078761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104005c0>]}
[0m15:54:08.079423 [info ] [Thread-2 (]: 2 of 6 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.27s]
[0m15:54:08.079976 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:54:08.080353 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:54:08.080882 [info ] [Thread-2 (]: 3 of 6 START sql view model semi_raw.listings .................................. [RUN]
[0m15:54:08.081476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:54:08.081926 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:54:08.084540 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:54:08.091818 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:54:08.094527 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m15:54:08.104237 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m15:54:08.104527 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m15:54:08.408074 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m15:54:08.412110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11043b530>]}
[0m15:54:08.412981 [info ] [Thread-2 (]: 3 of 6 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.33s]
[0m15:54:08.413713 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:54:08.414198 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:54:08.414946 [info ] [Thread-2 (]: 4 of 6 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m15:54:08.415528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:54:08.416283 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:54:08.421430 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:08.437894 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:54:08.467102 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:08.467396 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:54:08.861671 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m15:54:08.872637 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:08.873170 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:54:09.225643 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.352 seconds
[0m15:54:09.235784 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:09.236539 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:54:09.325372 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.088 seconds
[0m15:54:09.341209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:09.341756 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:54:09.531555 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.189 seconds
[0m15:54:09.566205 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:09.572493 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:09.572748 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:54:10.353824 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m15:54:10.354506 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:10.354975 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:54:12.089360 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.734 seconds
[0m15:54:12.089755 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:12.090115 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:54:12.705680 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m15:54:12.716937 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m15:54:12.724481 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:54:12.724897 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:54:13.141678 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m15:54:13.143701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11047a540>]}
[0m15:54:13.144315 [info ] [Thread-2 (]: 4 of 6 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 4.73s]
[0m15:54:13.144807 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:54:13.145137 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m15:54:13.145636 [info ] [Thread-2 (]: 5 of 6 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m15:54:13.146208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m15:54:13.146512 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m15:54:13.149321 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:54:13.151829 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m15:54:13.165031 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:54:13.170518 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:54:13.170776 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace transient table AIRBNB_PRO.silver.silver_hosts
    
    
    
    as (

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m15:54:14.151437 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m15:54:14.154675 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m15:54:14.155464 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:54:14.155767 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:54:14.229028 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m15:54:14.232189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110464c50>]}
[0m15:54:14.233048 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 1[0m in 1.09s]
[0m15:54:14.233642 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m15:54:14.234022 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:54:14.234601 [info ] [Thread-2 (]: 6 of 6 START sql incremental model silver.silver_listings ...................... [RUN]
[0m15:54:14.235183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:54:14.235572 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:54:14.239750 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:14.252666 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:54:14.256448 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:14.256685 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:54:14.958904 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m15:54:14.966064 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:14.966839 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:54:15.113608 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.146 seconds
[0m15:54:15.120278 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:15.120753 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:54:15.314628 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.193 seconds
[0m15:54:15.322874 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:15.323534 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:54:15.435755 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m15:54:15.443340 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:15.463255 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:15.464228 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:54:15.567753 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m15:54:15.568861 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:54:15.569622 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:54:15.820191 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21350-0001-88f0-000c-0f1600034196
[0m15:54:15.821028 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 13
invalid identifier 'DBT_INTERNAL_SOURCE.BOOKING_ID'
[0m15:54:15.829284 [debug] [Thread-2 (]: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.BOOKING_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:54:15.830199 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd23f1c-2530-46e8-b890-4c3ae7b56d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110505130>]}
[0m15:54:15.831135 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model silver.silver_listings ............. [[31mERROR[0m in 1.59s]
[0m15:54:15.831834 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:54:15.832523 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_listings' to be skipped because of status 'error'.  Reason: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.BOOKING_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql.
[0m15:54:15.834627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:15.834946 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:54:15.835230 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:54:16.672299 [info ] [MainThread]: 
[0m15:54:16.672962 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m15:54:16.674288 [debug] [MainThread]: Command end result
[0m15:54:16.701839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:54:16.707602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:54:16.717645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:54:16.717882 [info ] [MainThread]: 
[0m15:54:16.718111 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:16.718293 [info ] [MainThread]: 
[0m15:54:16.718529 [error] [MainThread]: [31mFailure in model silver_listings (models/silver/silver_listings.sql)[0m
[0m15:54:16.718749 [error] [MainThread]:   Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.BOOKING_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:54:16.718916 [info ] [MainThread]: 
[0m15:54:16.719103 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m15:54:16.719269 [info ] [MainThread]: 
[0m15:54:16.719459 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:54:16.719875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.580993, "process_in_blocks": "0", "process_kernel_time": 0.670681, "process_mem_max_rss": "164003840", "process_out_blocks": "0", "process_user_time": 1.827103}
[0m15:54:16.720173 [debug] [MainThread]: Command `dbt run` failed at 15:54:16.720120 after 12.58 seconds
[0m15:54:16.720408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db12a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e113bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e113fb0>]}
[0m15:54:16.720615 [debug] [MainThread]: Flushing usage events
[0m15:54:18.132320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:30.866577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109982e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70fe00>]}


============================== 15:57:30.872358 | 3082ee5f-aad3-433b-a899-eef13a61e9e0 ==============================
[0m15:57:30.872358 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:57:30.872763 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False'}
[0m15:57:31.710888 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:57:31.711580 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:57:31.711726 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:57:31.838390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c45c980>]}
[0m15:57:31.895942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1bf080>]}
[0m15:57:31.898714 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m15:57:31.977708 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:57:32.185688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:32.186045 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/silver/silver_listings.sql
[0m15:57:32.295988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c98b4a0>]}
[0m15:57:32.397307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:57:32.405475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:57:32.463773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6db350>]}
[0m15:57:32.464162 [info ] [MainThread]: Found 6 models, 3 analyses, 3 sources, 526 macros
[0m15:57:32.464361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caedc40>]}
[0m15:57:32.465794 [info ] [MainThread]: 
[0m15:57:32.466077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:32.466278 [info ] [MainThread]: 
[0m15:57:32.466652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:32.469380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m15:57:32.746383 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:57:32.746715 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:57:32.746915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:33.594415 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.847 seconds
[0m15:57:33.602112 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m15:57:33.602922 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m15:57:33.819241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.216 seconds
[0m15:57:33.824114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m15:57:33.837044 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m15:57:33.837443 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m15:57:33.951590 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.114 seconds
[0m15:57:33.953494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m15:57:33.956170 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m15:57:33.956516 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m15:57:34.032351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.075 seconds
[0m15:57:34.035339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caed580>]}
[0m15:57:34.042094 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m15:57:34.042820 [info ] [Thread-2 (]: 1 of 6 START sql view model semi_raw.bookings .................................. [RUN]
[0m15:57:34.043437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.bookings)
[0m15:57:34.043824 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m15:57:34.051898 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m15:57:34.053673 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m15:57:34.074332 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m15:57:34.076816 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m15:57:34.077022 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m15:57:34.991935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m15:57:35.025030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd92b0>]}
[0m15:57:35.025847 [info ] [Thread-2 (]: 1 of 6 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.98s]
[0m15:57:35.026432 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m15:57:35.026764 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m15:57:35.027253 [info ] [Thread-2 (]: 2 of 6 START sql view model semi_raw.hosts ..................................... [RUN]
[0m15:57:35.027797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m15:57:35.028116 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m15:57:35.030430 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m15:57:35.033180 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m15:57:35.035167 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m15:57:35.037951 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m15:57:35.038208 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m15:57:35.279885 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m15:57:35.282883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac9730>]}
[0m15:57:35.283667 [info ] [Thread-2 (]: 2 of 6 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.26s]
[0m15:57:35.284271 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m15:57:35.284680 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m15:57:35.285385 [info ] [Thread-2 (]: 3 of 6 START sql view model semi_raw.listings .................................. [RUN]
[0m15:57:35.285985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m15:57:35.286322 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m15:57:35.289615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m15:57:35.292171 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m15:57:35.298231 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m15:57:35.301325 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m15:57:35.301839 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m15:57:35.453828 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m15:57:35.457748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae0080>]}
[0m15:57:35.458588 [info ] [Thread-2 (]: 3 of 6 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.17s]
[0m15:57:35.459260 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m15:57:35.459842 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:57:35.460416 [info ] [Thread-2 (]: 4 of 6 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m15:57:35.461109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.silver_bookings)
[0m15:57:35.461462 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m15:57:35.468613 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:35.471961 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m15:57:35.502693 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:35.503000 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:57:35.765413 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m15:57:35.775583 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:35.776387 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:57:35.852100 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.075 seconds
[0m15:57:35.857289 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:35.857845 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:57:35.929568 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m15:57:35.941220 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:35.942039 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:57:36.027930 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.085 seconds
[0m15:57:36.059757 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:36.062287 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:36.062522 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:57:36.139222 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m15:57:36.139945 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:36.140540 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m15:57:36.790738 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.649 seconds
[0m15:57:36.791796 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:36.792481 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:57:36.976673 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m15:57:36.993620 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m15:57:37.000172 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m15:57:37.000538 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m15:57:37.106715 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m15:57:37.111594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac3350>]}
[0m15:57:37.112730 [info ] [Thread-2 (]: 4 of 6 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.65s]
[0m15:57:37.113563 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m15:57:37.114089 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m15:57:37.114700 [info ] [Thread-2 (]: 5 of 6 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m15:57:37.115351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m15:57:37.115798 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m15:57:37.120241 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.124503 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m15:57:37.128723 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.129184 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m15:57:37.406235 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m15:57:37.412129 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.412715 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:57:37.484649 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m15:57:37.492211 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.492826 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:57:37.574523 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.081 seconds
[0m15:57:37.582133 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.582726 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:57:37.662524 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m15:57:37.668806 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.674731 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.675577 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m15:57:37.757004 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m15:57:37.758481 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:37.759472 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m15:57:38.321693 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.561 seconds
[0m15:57:38.322757 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:38.323467 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:57:38.513393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m15:57:38.516394 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m15:57:38.517080 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m15:57:38.517379 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m15:57:38.635524 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m15:57:38.639666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db46930>]}
[0m15:57:38.640841 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.52s]
[0m15:57:38.641737 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m15:57:38.642302 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m15:57:38.642960 [info ] [Thread-2 (]: 6 of 6 START sql incremental model silver.silver_listings ...................... [RUN]
[0m15:57:38.643738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m15:57:38.644144 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m15:57:38.648744 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:38.652513 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m15:57:38.656486 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:38.656920 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:57:38.942946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m15:57:38.950182 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:38.950880 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:57:39.032768 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.081 seconds
[0m15:57:39.039762 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:39.040425 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:57:39.118584 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m15:57:39.126646 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:39.127334 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:57:39.195464 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.067 seconds
[0m15:57:39.200543 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:39.203903 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:39.204228 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:57:39.294707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m15:57:39.295899 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:39.296852 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m15:57:40.189922 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.892 seconds
[0m15:57:40.191212 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:40.191904 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:57:40.390679 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m15:57:40.396472 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m15:57:40.397466 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m15:57:40.397849 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m15:57:40.581754 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m15:57:40.586189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3082ee5f-aad3-433b-a899-eef13a61e9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c5a00>]}
[0m15:57:40.587486 [info ] [Thread-2 (]: 6 of 6 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.94s]
[0m15:57:40.588513 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m15:57:40.590949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:40.591426 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m15:57:40.591831 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m15:57:40.688984 [info ] [MainThread]: 
[0m15:57:40.689806 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m15:57:40.691617 [debug] [MainThread]: Command end result
[0m15:57:40.716781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m15:57:40.723709 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m15:57:40.729710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m15:57:40.729932 [info ] [MainThread]: 
[0m15:57:40.730170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:40.730343 [info ] [MainThread]: 
[0m15:57:40.730546 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m15:57:40.730946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.937002, "process_in_blocks": "0", "process_kernel_time": 0.671894, "process_mem_max_rss": "164347904", "process_out_blocks": "0", "process_user_time": 2.098007}
[0m15:57:40.731229 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:40.731173 after 9.94 seconds
[0m15:57:40.731456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70fe00>]}
[0m15:57:40.731678 [debug] [MainThread]: Flushing usage events
[0m15:57:42.114568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:44.302440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d25c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d25f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e028290>]}


============================== 16:27:44.305364 | 93562585-757b-4c26-9ed4-24ff6d7c2e98 ==============================
[0m16:27:44.305364 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:27:44.305646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt ', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'target_path': 'None', 'introspect': 'True', 'debug': 'False'}
[0m16:27:44.372773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93562585-757b-4c26-9ed4-24ff6d7c2e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3416a0>]}
[0m16:27:44.412056 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:27:44.413565 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:27:44.413881 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15309979, "process_in_blocks": "0", "process_kernel_time": 0.246099, "process_mem_max_rss": "111755264", "process_out_blocks": "0", "process_user_time": 0.742109}
[0m16:27:44.414099 [debug] [MainThread]: Command `cli deps` succeeded at 16:27:44.414048 after 0.15 seconds
[0m16:27:44.414239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e19dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e028320>]}
[0m16:27:44.414375 [debug] [MainThread]: Flushing usage events
[0m16:27:45.425685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:15.522034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b00e0>]}


============================== 16:36:15.532326 | 2f3c52dc-e457-463d-ab9f-307f7b2db56c ==============================
[0m16:36:15.532326 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:36:15.532793 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'empty': 'False', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'printer_width': '80', 'introspect': 'True', 'debug': 'False'}
[0m16:36:17.477562 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:36:17.477847 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:36:17.477987 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:36:17.658109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d671340>]}
[0m16:36:17.705153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df5a690>]}
[0m16:36:17.709834 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:36:17.821948 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:36:18.724458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:18.725387 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:36:18.725915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:18.761267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb1220>]}
[0m16:36:18.865724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:36:18.875445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:36:18.974515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e163740>]}
[0m16:36:18.974835 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:36:18.974985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2794c0>]}
[0m16:36:18.975944 [info ] [MainThread]: 
[0m16:36:18.976084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:18.976185 [info ] [MainThread]: 
[0m16:36:18.976413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:18.978302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:36:22.212703 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:36:22.213599 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:36:22.214093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:23.775264 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.561 seconds
[0m16:36:23.777801 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:36:23.778075 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:36:23.918247 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.140 seconds
[0m16:36:23.920844 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:36:23.921094 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:36:24.011100 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.090 seconds
[0m16:36:24.012044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_dbt_schema)
[0m16:36:24.012292 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "dbt_schema"
"
[0m16:36:24.014639 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_dbt_schema"
[0m16:36:24.014798 [debug] [ThreadPool]: On create_AIRBNB_PRO_dbt_schema: create schema if not exists AIRBNB_PRO.dbt_schema
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_dbt_schema"} */
[0m16:36:24.134387 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:36:24.135784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_dbt_schema)
[0m16:36:24.143406 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:36:24.143676 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:36:24.276143 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.132 seconds
[0m16:36:24.278415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:36:24.281515 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:36:24.281908 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:36:24.440145 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.158 seconds
[0m16:36:24.441262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:36:24.442668 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:36:24.442824 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:36:24.664928 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.222 seconds
[0m16:36:24.666356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e162f00>]}
[0m16:36:24.680559 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:36:24.680964 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:36:24.681210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:36:24.681376 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:36:24.685349 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:36:24.690331 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:36:24.704609 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:36:24.715963 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:36:24.716328 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:36:25.179162 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m16:36:25.215902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aacd0a0>]}
[0m16:36:25.216654 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.53s]
[0m16:36:25.217125 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:36:25.217435 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:36:25.217917 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:36:25.218463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:36:25.218824 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:36:25.222340 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:36:25.228414 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:36:25.230247 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:36:25.243139 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:36:25.243418 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:36:25.641268 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m16:36:25.645282 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3ff0b0>]}
[0m16:36:25.646263 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.43s]
[0m16:36:25.647006 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:36:25.647540 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:36:25.648169 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:36:25.648839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:36:25.649260 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:36:25.653081 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:36:25.662211 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:36:25.664668 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:36:25.674980 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:36:25.675248 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:36:26.203410 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m16:36:26.208064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f225220>]}
[0m16:36:26.209135 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.56s]
[0m16:36:26.209956 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:36:26.210469 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:36:26.211085 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:36:26.211776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:36:26.212134 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:36:26.219476 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:36:26.224886 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:36:26.227472 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:36:26.231546 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:36:26.231918 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
    
      AIRBNB.SILVER.SILVER_BOOKINGS AS SILVER_bookings
    
        
    
        LEFT JOIN AIRBNB.SILVER.SILVER_LISTINGS AS SILVER_listings
        ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB.SILVER.SILVER_HOSTS AS SILVER_hosts
        ON SILVER_listings.host_id = SILVER_hosts.host_id
        
        
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:36:26.387389 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2137a-0001-88f0-000c-0f16000341de
[0m16:36:26.388777 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBNB.SILVER' does not exist or not authorized.
[0m16:36:26.403490 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:36:26.404182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4bb740>]}
[0m16:36:26.404867 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.19s]
[0m16:36:26.405472 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:36:26.405862 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:36:26.406366 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:36:26.406886 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:36:26.408248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:36:26.408672 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:36:26.413275 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:26.422954 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:36:26.448383 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:26.448636 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:36:26.881594 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m16:36:26.893110 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:26.893580 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:36:27.033637 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.139 seconds
[0m16:36:27.040947 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:27.041589 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:36:27.138416 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.096 seconds
[0m16:36:27.152795 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:27.153243 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:36:27.247099 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.093 seconds
[0m16:36:27.284284 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:27.292352 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:27.292604 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:36:27.388432 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:36:27.389251 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:27.389756 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:36:28.864380 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.474 seconds
[0m16:36:28.864942 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:28.865191 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:36:29.151396 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m16:36:29.164062 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:36:29.170330 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:36:29.170574 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:36:29.321608 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m16:36:29.324601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c6600>]}
[0m16:36:29.325466 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 2.92s]
[0m16:36:29.326024 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:36:29.326420 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:36:29.326917 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:36:29.327354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:36:29.327716 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:36:29.330459 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:29.341978 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:36:29.345060 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:29.345443 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:36:29.687739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m16:36:29.696467 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:29.697083 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:36:29.827499 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.130 seconds
[0m16:36:29.834689 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:29.835433 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:36:29.929169 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.093 seconds
[0m16:36:29.934983 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:29.935586 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:36:30.037161 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.101 seconds
[0m16:36:30.044276 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:30.054875 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:30.055550 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:36:30.146680 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m16:36:30.147918 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:30.148707 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:36:30.912186 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.763 seconds
[0m16:36:30.913227 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:30.913899 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:36:31.131049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m16:36:31.134864 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:36:31.135784 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:36:31.136161 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:36:31.320975 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m16:36:31.325960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5cdf10>]}
[0m16:36:31.327375 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 2.00s]
[0m16:36:31.328408 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:36:31.329230 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:36:31.329923 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:36:31.330579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:36:31.331038 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:36:31.337212 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.349826 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:36:31.352581 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.352896 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:36:31.628749 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m16:36:31.631431 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.631724 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:36:31.726854 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.095 seconds
[0m16:36:31.729435 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.729665 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:36:31.825566 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m16:36:31.829503 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.829884 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:36:31.905189 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.075 seconds
[0m16:36:31.909260 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.923324 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:31.923700 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:36:32.035041 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:36:32.036233 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:32.037082 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:36:32.754271 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.716 seconds
[0m16:36:32.754593 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:32.754763 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:36:32.966075 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m16:36:32.967748 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:36:32.968157 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:36:32.968318 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:36:33.072616 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m16:36:33.074288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3c52dc-e457-463d-ab9f-307f7b2db56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40a270>]}
[0m16:36:33.074784 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.74s]
[0m16:36:33.075195 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:36:33.076171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:33.076394 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:36:33.076594 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:36:33.190412 [info ] [MainThread]: 
[0m16:36:33.191678 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 14.21 seconds (14.21s).
[0m16:36:33.194212 [debug] [MainThread]: Command end result
[0m16:36:33.220416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:36:33.225429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:36:33.231202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:36:33.231424 [info ] [MainThread]: 
[0m16:36:33.231651 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:36:33.231829 [info ] [MainThread]: 
[0m16:36:33.232054 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:36:33.232261 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:36:33.232427 [info ] [MainThread]: 
[0m16:36:33.232615 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:36:33.232774 [info ] [MainThread]: 
[0m16:36:33.232956 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:36:33.233351 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.848186, "process_in_blocks": "0", "process_kernel_time": 1.632146, "process_mem_max_rss": "161677312", "process_out_blocks": "0", "process_user_time": 2.90597}
[0m16:36:33.233639 [debug] [MainThread]: Command `dbt run` failed at 16:36:33.233588 after 17.85 seconds
[0m16:36:33.233871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5ddbe0>]}
[0m16:36:33.234086 [debug] [MainThread]: Flushing usage events
[0m16:36:34.733303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:09.121971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5014f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c501460>]}


============================== 16:38:09.128624 | 58502aed-350d-4707-b170-f7e72c95a1f4 ==============================
[0m16:38:09.128624 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:38:09.129018 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'debug': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:38:09.866576 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:38:09.867301 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:38:09.867463 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:38:10.006933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deec1a0>]}
[0m16:38:10.060314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddd5160>]}
[0m16:38:10.063098 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:38:10.138690 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:38:10.339992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:10.340267 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:38:10.340408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:10.359401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d210080>]}
[0m16:38:10.393162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:38:10.400978 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:38:10.455375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2575f0>]}
[0m16:38:10.455620 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:38:10.455773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2122d0>]}
[0m16:38:10.456740 [info ] [MainThread]: 
[0m16:38:10.456894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:10.457004 [info ] [MainThread]: 
[0m16:38:10.457221 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:10.459307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:38:10.727190 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:38:10.727618 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:38:10.727888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:11.781056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.053 seconds
[0m16:38:11.788497 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:38:11.789115 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:38:11.868145 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.079 seconds
[0m16:38:11.879634 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:38:11.880458 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:38:11.966396 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.085 seconds
[0m16:38:11.972003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:38:11.989627 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:38:11.989970 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:38:12.074705 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.084 seconds
[0m16:38:12.077342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:38:12.080859 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:38:12.081334 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:38:12.177939 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.096 seconds
[0m16:38:12.181116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m16:38:12.185470 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:38:12.186010 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:38:12.288603 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.102 seconds
[0m16:38:12.293045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0faf90>]}
[0m16:38:12.302890 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:38:12.303753 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:38:12.304430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.bookings)
[0m16:38:12.304895 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:38:12.314037 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:38:12.316814 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:38:12.338384 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:38:12.340867 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:38:12.341108 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:38:12.515015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m16:38:12.547878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a4c20>]}
[0m16:38:12.548511 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.24s]
[0m16:38:12.548963 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:38:12.549260 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:38:12.549708 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:38:12.550193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:38:12.550478 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:38:12.552621 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:38:12.555626 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:38:12.558987 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:38:12.562078 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:38:12.562404 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:38:13.211866 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m16:38:13.217403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f485f70>]}
[0m16:38:13.218979 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.67s]
[0m16:38:13.220010 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:38:13.220849 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:38:13.221912 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:38:13.222921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:38:13.223358 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:38:13.227239 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:38:13.230945 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:38:13.233895 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:38:13.237152 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:38:13.237516 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:38:13.433172 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m16:38:13.437391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e435fd0>]}
[0m16:38:13.438630 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m16:38:13.439692 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:38:13.440340 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:38:13.441157 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:38:13.441945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:38:13.442402 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:38:13.450578 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:38:13.454553 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:38:13.457211 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:38:13.461491 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:38:13.461890 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
    
      AIRBNB.SILVER.SILVER_BOOKINGS AS SILVER_bookings
    
        
    
        LEFT JOIN AIRBNB.SILVER.SILVER_LISTINGS AS SILVER_listings
        ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB.SILVER.SILVER_HOSTS AS SILVER_hosts
        ON SILVER_listings.host_id = SILVER_hosts.host_id
        
        
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:38:13.584273 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2137c-0001-88f0-000c-0f1600034232
[0m16:38:13.585230 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBNB.SILVER' does not exist or not authorized.
[0m16:38:13.594450 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:38:13.595389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1e5a90>]}
[0m16:38:13.596415 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.15s]
[0m16:38:13.597206 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:38:13.597601 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:38:13.598104 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:38:13.598637 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:38:13.599921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:38:13.600337 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:38:13.604932 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:13.607268 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:38:13.634592 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:13.634861 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:38:13.875849 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m16:38:13.890673 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:13.891163 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:38:13.982810 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.091 seconds
[0m16:38:13.993810 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:13.994535 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:38:14.073350 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.078 seconds
[0m16:38:14.088097 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:14.088522 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:38:14.172143 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.083 seconds
[0m16:38:14.207751 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:14.210113 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:14.210341 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:38:14.315688 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m16:38:14.316526 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:14.317093 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:38:15.466784 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.149 seconds
[0m16:38:15.467979 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:15.468628 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:38:15.701337 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m16:38:15.713945 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:38:15.719703 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:38:15.719992 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:38:15.903508 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:38:15.907307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46cec0>]}
[0m16:38:15.908257 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 2.31s]
[0m16:38:15.908999 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:38:15.909611 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:38:15.910349 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:38:15.910825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:38:15.911193 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:38:15.914552 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:15.918167 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:38:15.921435 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:15.921802 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:38:16.312110 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m16:38:16.318193 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.318858 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:38:16.404896 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.085 seconds
[0m16:38:16.410796 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.411293 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:38:16.488937 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m16:38:16.499295 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.499866 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:38:16.571438 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m16:38:16.575563 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.579328 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.579717 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:38:16.677522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:38:16.677887 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:16.678173 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:38:17.308288 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.630 seconds
[0m16:38:17.309513 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:17.310178 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:38:17.541709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m16:38:17.548657 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:38:17.549929 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:38:17.550418 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:38:17.691934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:38:17.695312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f598b60>]}
[0m16:38:17.696318 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.78s]
[0m16:38:17.697099 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:38:17.697613 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:38:17.698192 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:38:17.698776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:38:17.699184 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:38:17.704867 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:17.709222 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:38:17.712807 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:17.713171 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:38:18.127515 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m16:38:18.133370 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.133963 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:38:18.216481 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m16:38:18.221344 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.221786 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:38:18.290599 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.068 seconds
[0m16:38:18.298557 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.299216 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:38:18.373912 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.074 seconds
[0m16:38:18.380712 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.385967 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.386367 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:38:18.479357 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m16:38:18.480549 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:18.481491 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:38:19.049369 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.567 seconds
[0m16:38:19.050719 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:19.051517 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:38:19.235903 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:38:19.242315 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:38:19.243639 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:38:19.244105 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:38:19.350504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m16:38:19.353851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58502aed-350d-4707-b170-f7e72c95a1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f537e00>]}
[0m16:38:19.354782 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.65s]
[0m16:38:19.355829 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:38:19.357796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:19.358266 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:38:19.358588 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:38:19.466689 [info ] [MainThread]: 
[0m16:38:19.467640 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m16:38:19.469485 [debug] [MainThread]: Command end result
[0m16:38:19.491672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:38:19.497108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:38:19.502516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:38:19.502715 [info ] [MainThread]: 
[0m16:38:19.502913 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:19.503073 [info ] [MainThread]: 
[0m16:38:19.503280 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:38:19.503470 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBNB.SILVER' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:38:19.503619 [info ] [MainThread]: 
[0m16:38:19.503783 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:38:19.503930 [info ] [MainThread]: 
[0m16:38:19.504103 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:38:19.504462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.4572935, "process_in_blocks": "0", "process_kernel_time": 0.695781, "process_mem_max_rss": "161792000", "process_out_blocks": "0", "process_user_time": 2.073554}
[0m16:38:19.504715 [debug] [MainThread]: Command `dbt run` failed at 16:38:19.504668 after 10.46 seconds
[0m16:38:19.504925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d213e90>]}
[0m16:38:19.505118 [debug] [MainThread]: Flushing usage events
[0m16:38:21.097652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:02.060661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d476570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c940560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9413a0>]}


============================== 16:39:02.064902 | 282d623d-44ed-4063-bc17-481d7e6fb18c ==============================
[0m16:39:02.064902 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:39:02.065176 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'no_print': 'None', 'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m16:39:02.903630 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:39:02.904713 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:39:02.905150 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:39:03.051516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e474980>]}
[0m16:39:03.097618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd8df70>]}
[0m16:39:03.099600 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:39:03.168966 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:39:03.321682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:03.321915 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:39:03.322029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:03.338624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e385d30>]}
[0m16:39:03.371851 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:39:03.376106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:39:03.402128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e697dd0>]}
[0m16:39:03.402370 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:39:03.402510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7594c0>]}
[0m16:39:03.403413 [info ] [MainThread]: 
[0m16:39:03.403555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:03.403655 [info ] [MainThread]: 
[0m16:39:03.403853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:39:03.405643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:39:03.648639 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:39:03.648934 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:39:03.649114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:06.053360 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.404 seconds
[0m16:39:06.056403 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:39:06.056681 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:39:06.563457 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.506 seconds
[0m16:39:06.573894 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:39:06.574573 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:39:07.020302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.445 seconds
[0m16:39:07.022417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:39:07.030372 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:39:07.030632 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:39:07.179095 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.148 seconds
[0m16:39:07.182771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_dbt_schema)
[0m16:39:07.188458 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:39:07.188933 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:39:07.484583 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.295 seconds
[0m16:39:07.486559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:39:07.490182 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:39:07.490534 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:39:07.896292 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.405 seconds
[0m16:39:07.901279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5f0f80>]}
[0m16:39:07.912162 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:39:07.913057 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:39:07.913732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:39:07.914209 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:39:07.923696 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:39:07.931721 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:39:07.953185 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:39:07.964392 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:39:07.964642 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:39:08.510117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m16:39:08.541532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e4c20>]}
[0m16:39:08.542162 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.62s]
[0m16:39:08.542611 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:39:08.542908 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:39:08.543387 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:39:08.543897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:39:08.544268 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:39:08.546604 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:39:08.552576 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:39:08.556078 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:39:08.570225 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:39:08.570490 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:39:08.817080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m16:39:08.821517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151aa360>]}
[0m16:39:08.822185 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.28s]
[0m16:39:08.822677 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:39:08.823019 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:39:08.823490 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:39:08.824003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:39:08.824425 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:39:08.827329 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:39:08.835079 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:39:08.837276 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:39:08.848806 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:39:08.849068 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:39:10.251601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m16:39:10.255435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151a83e0>]}
[0m16:39:10.256278 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 1.43s]
[0m16:39:10.256949 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:39:10.257703 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:39:10.258258 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:39:10.258892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:39:10.259247 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:39:10.265231 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:39:10.278276 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:39:10.280424 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:39:10.288945 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:39:10.289297 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.host_id = SILVER_hosts.host_id
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:39:10.676778 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2137d-0001-88f0-000c-0f1600034276
[0m16:39:10.677907 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:39:10.687359 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:39:10.688332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e494d40>]}
[0m16:39:10.689355 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.43s]
[0m16:39:10.690132 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:39:10.690690 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:39:10.691341 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:39:10.691883 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:39:10.693725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:39:10.694109 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:39:10.699832 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:10.713518 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:39:10.741624 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:10.741872 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:39:11.786601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m16:39:11.799685 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:11.800162 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:39:12.014417 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.214 seconds
[0m16:39:12.022915 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:12.023407 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:39:12.141077 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.117 seconds
[0m16:39:12.147126 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:12.147383 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:39:12.810320 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.662 seconds
[0m16:39:12.842558 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:12.850460 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:12.850688 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:39:13.056598 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m16:39:13.058067 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:13.058658 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:39:14.038001 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.979 seconds
[0m16:39:14.039209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:14.039950 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:39:14.654666 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m16:39:14.668246 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:39:14.676274 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:39:14.676838 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:39:14.868966 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m16:39:14.873423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e88ed20>]}
[0m16:39:14.874691 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 4.18s]
[0m16:39:14.875685 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:39:14.876243 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:39:14.876935 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:39:14.877623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:39:14.878053 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:39:14.882971 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:14.897479 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:39:14.901213 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:14.901567 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:39:15.473115 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m16:39:15.479977 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:15.480772 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:39:15.661522 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.180 seconds
[0m16:39:15.667492 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:15.668032 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:39:15.781599 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.113 seconds
[0m16:39:15.792021 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:15.792622 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:39:15.859972 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.067 seconds
[0m16:39:15.864282 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:15.872995 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:15.873571 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:39:15.999474 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m16:39:16.000191 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:16.000671 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:39:17.066978 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 1.066 seconds
[0m16:39:17.068109 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:17.068884 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:39:17.277965 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m16:39:17.281040 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:39:17.281749 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:39:17.282009 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:39:17.387624 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m16:39:17.390935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152d9d60>]}
[0m16:39:17.391720 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 2.51s]
[0m16:39:17.392317 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:39:17.392668 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:39:17.393158 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:39:17.393644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:39:17.393970 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:39:17.398027 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:17.414955 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:39:17.417757 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:17.418020 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:39:17.794165 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m16:39:17.799163 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:17.799857 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:39:17.906022 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m16:39:17.913872 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:17.914490 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:39:18.001959 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m16:39:18.009700 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.010409 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:39:18.080089 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.069 seconds
[0m16:39:18.089183 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.097869 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.098285 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:39:18.222289 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m16:39:18.223511 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.224283 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:39:18.747329 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.522 seconds
[0m16:39:18.748710 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.749351 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:39:18.971634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m16:39:18.978547 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:39:18.980257 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:39:18.980831 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:39:19.161046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m16:39:19.162947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282d623d-44ed-4063-bc17-481d7e6fb18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151a44d0>]}
[0m16:39:19.163496 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.77s]
[0m16:39:19.163961 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:39:19.165095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:19.165398 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:39:19.165617 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:39:19.298127 [info ] [MainThread]: 
[0m16:39:19.298883 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 15.89 seconds (15.89s).
[0m16:39:19.300720 [debug] [MainThread]: Command end result
[0m16:39:19.323815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:39:19.329785 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:39:19.335570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:39:19.335772 [info ] [MainThread]: 
[0m16:39:19.335973 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:19.336135 [info ] [MainThread]: 
[0m16:39:19.336342 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:39:19.336529 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:39:19.336680 [info ] [MainThread]: 
[0m16:39:19.336848 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:39:19.336989 [info ] [MainThread]: 
[0m16:39:19.337166 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:39:19.337566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.33089, "process_in_blocks": "0", "process_kernel_time": 0.853978, "process_mem_max_rss": "160972800", "process_out_blocks": "0", "process_user_time": 2.182896}
[0m16:39:19.337852 [debug] [MainThread]: Command `dbt run` failed at 16:39:19.337798 after 17.33 seconds
[0m16:39:19.338075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d476570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152ef620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6577a0>]}
[0m16:39:19.338278 [debug] [MainThread]: Flushing usage events
[0m16:39:20.898034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:09.215162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfafe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a81d0>]}


============================== 16:42:09.220305 | 215d5e39-4a72-40db-b2c3-965253e9c221 ==============================
[0m16:42:09.220305 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:42:09.220639 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True'}
[0m16:42:09.984673 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:42:09.985117 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:42:09.985389 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:42:10.116073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac820f0>]}
[0m16:42:10.159884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1237a0>]}
[0m16:42:10.163330 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:42:10.237539 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:42:10.386702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:10.386925 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:42:10.387035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:10.403291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1ac0b0>]}
[0m16:42:10.434648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:42:10.441126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:42:10.471419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e3950>]}
[0m16:42:10.471625 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:42:10.471765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e327a70>]}
[0m16:42:10.472634 [info ] [MainThread]: 
[0m16:42:10.472775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:10.472879 [info ] [MainThread]: 
[0m16:42:10.473075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:10.474899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:42:10.723394 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:42:10.723718 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:42:10.723920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:11.598600 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.874 seconds
[0m16:42:11.605733 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:42:11.606291 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:42:11.683218 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.076 seconds
[0m16:42:11.689081 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:42:11.689555 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:42:11.772056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.082 seconds
[0m16:42:11.773555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m16:42:11.780205 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:42:11.780401 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:42:11.861189 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.081 seconds
[0m16:42:11.862918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_dbt_schema)
[0m16:42:11.865414 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:42:11.865691 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:42:11.926305 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.060 seconds
[0m16:42:11.928796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:42:11.932231 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:42:11.932630 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:42:12.019054 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.086 seconds
[0m16:42:12.024339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5150a0>]}
[0m16:42:12.033628 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:42:12.034114 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:42:12.034505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.bookings)
[0m16:42:12.034802 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:42:12.041481 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:42:12.044072 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:42:12.062241 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:42:12.065126 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:42:12.065335 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:42:12.260970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m16:42:12.290293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f10d0>]}
[0m16:42:12.290900 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.25s]
[0m16:42:12.291341 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:42:12.291598 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:42:12.291991 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:42:12.292377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:42:12.292600 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:42:12.294560 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:42:12.297136 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:42:12.300115 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:42:12.302537 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:42:12.302773 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:42:12.441366 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m16:42:12.445629 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e8a70>]}
[0m16:42:12.446687 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.15s]
[0m16:42:12.447516 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:42:12.448048 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:42:12.448694 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:42:12.449455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:42:12.449888 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:42:12.453992 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:42:12.458182 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:42:12.460862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:42:12.463540 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:42:12.463887 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:42:12.633155 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m16:42:12.637545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3f87d0>]}
[0m16:42:12.638740 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.19s]
[0m16:42:12.639685 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:42:12.640230 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:42:12.640865 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:42:12.641592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:42:12.642105 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:42:12.650181 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:42:12.654464 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:42:12.657036 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:42:12.661079 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:42:12.661493 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.host_id = SILVER_hosts.host_id
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:42:12.759816 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21380-0001-88f0-000c-0f16000343aa
[0m16:42:12.760814 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:42:12.770511 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:42:12.771661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f29c0>]}
[0m16:42:12.772791 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.13s]
[0m16:42:12.773559 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:42:12.774111 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:42:12.774682 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:42:12.775345 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:42:12.777107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:42:12.777559 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:42:12.783922 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:12.787516 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:42:12.816322 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:12.816607 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:42:13.035102 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m16:42:13.044827 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.045230 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:42:13.133258 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.087 seconds
[0m16:42:13.140913 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.141342 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:42:13.198324 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.056 seconds
[0m16:42:13.208875 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.209239 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:42:13.273183 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.063 seconds
[0m16:42:13.306265 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.309431 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.309652 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:42:13.387193 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m16:42:13.387943 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.388386 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:42:13.894768 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.506 seconds
[0m16:42:13.895950 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:13.896561 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:42:14.104749 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m16:42:14.116352 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:42:14.122287 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:42:14.122584 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:42:14.217025 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m16:42:14.220473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b33e0>]}
[0m16:42:14.221064 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.44s]
[0m16:42:14.221533 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:42:14.221865 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:42:14.222318 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:42:14.222709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:42:14.222979 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:42:14.225336 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.229097 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:42:14.232118 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.232462 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:42:14.430734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m16:42:14.437575 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.438453 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:42:14.506686 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.068 seconds
[0m16:42:14.512607 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.513200 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:42:14.584667 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m16:42:14.593794 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.594309 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:42:14.654416 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m16:42:14.660528 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.665545 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.666048 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:42:14.738269 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m16:42:14.739599 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:14.740266 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:42:15.471718 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.731 seconds
[0m16:42:15.472886 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:15.473473 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:42:15.670056 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m16:42:15.676490 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:42:15.677878 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:42:15.678360 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:42:15.768304 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m16:42:15.770737 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f61a0f0>]}
[0m16:42:15.771334 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.55s]
[0m16:42:15.771811 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:42:15.772131 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:42:15.772615 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:42:15.773104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:42:15.773445 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:42:15.777254 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:15.780516 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:42:15.783083 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:15.783343 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    host_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:42:16.003934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m16:42:16.009721 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.010171 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:42:16.077985 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.067 seconds
[0m16:42:16.086346 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.086990 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:42:16.157597 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.070 seconds
[0m16:42:16.163646 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.164045 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:42:16.234749 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.070 seconds
[0m16:42:16.242943 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.248754 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.249294 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:42:16.320509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m16:42:16.321721 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.322399 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:42:16.855489 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.532 seconds
[0m16:42:16.855956 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:16.856205 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:42:17.007501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m16:42:17.014181 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:42:17.015843 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:42:17.016445 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:42:17.120447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m16:42:17.124238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215d5e39-4a72-40db-b2c3-965253e9c221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4ea420>]}
[0m16:42:17.125110 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.35s]
[0m16:42:17.125774 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:42:17.127689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:17.128260 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:42:17.128574 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:42:17.213760 [info ] [MainThread]: 
[0m16:42:17.214631 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m16:42:17.216405 [debug] [MainThread]: Command end result
[0m16:42:17.238738 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:42:17.245995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:42:17.251552 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:42:17.251778 [info ] [MainThread]: 
[0m16:42:17.252005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:42:17.252182 [info ] [MainThread]: 
[0m16:42:17.252415 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:42:17.252632 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:42:17.252800 [info ] [MainThread]: 
[0m16:42:17.252994 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:42:17.253157 [info ] [MainThread]: 
[0m16:42:17.253341 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:42:17.253726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.107068, "process_in_blocks": "0", "process_kernel_time": 0.717841, "process_mem_max_rss": "161284096", "process_out_blocks": "0", "process_user_time": 1.986463}
[0m16:42:17.253990 [debug] [MainThread]: Command `dbt run` failed at 16:42:17.253944 after 8.11 seconds
[0m16:42:17.254232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfafe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3242f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce36b0>]}
[0m16:42:17.254435 [debug] [MainThread]: Flushing usage events
[0m16:42:18.460762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:48.705760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff41a0>]}


============================== 16:43:48.710688 | 315c0614-fbd4-44cb-9fe3-cd0a8d59c614 ==============================
[0m16:43:48.710688 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:43:48.711031 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'invocation_command': 'dbt build', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:43:49.811382 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:43:49.812488 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:43:49.813037 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:43:49.955587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb4d10>]}
[0m16:43:50.000238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea72f60>]}
[0m16:43:50.002980 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:43:50.074725 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:43:50.224053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:50.224274 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:43:50.224389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:50.240749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc4cb0>]}
[0m16:43:50.272706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:43:50.278505 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:43:50.441818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1da7b0>]}
[0m16:43:50.442084 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:43:50.443096 [info ] [MainThread]: 
[0m16:43:50.443239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:50.443343 [info ] [MainThread]: 
[0m16:43:50.443549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:50.445417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:43:50.715891 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:43:50.716091 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:43:50.716202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:51.536941 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.820 seconds
[0m16:43:51.545780 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:43:51.546565 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:43:51.625680 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.079 seconds
[0m16:43:51.629347 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:43:51.629738 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:43:51.692963 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.063 seconds
[0m16:43:51.694768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:43:51.702343 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:43:51.702559 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:43:51.776781 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.074 seconds
[0m16:43:51.778721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:43:51.781347 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:43:51.781613 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:43:51.864309 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.082 seconds
[0m16:43:51.868216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_dbt_schema)
[0m16:43:51.872926 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:43:51.873402 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:43:51.951995 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.078 seconds
[0m16:43:51.954830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec9fda0>]}
[0m16:43:51.966894 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:43:51.967931 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:43:51.968598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now model.dbt_snowflake_aws_project.bookings)
[0m16:43:51.968992 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:43:51.976673 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:43:51.983709 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:43:52.002282 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:43:52.015531 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:43:52.015763 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:43:52.151778 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:43:52.183402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2350d0>]}
[0m16:43:52.184017 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m16:43:52.184467 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:43:52.184756 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:43:52.185176 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:43:52.185605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:43:52.185878 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:43:52.187880 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:43:52.195160 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:43:52.196991 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:43:52.207010 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:43:52.207241 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:43:52.347395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:43:52.351782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106144a0>]}
[0m16:43:52.352980 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.17s]
[0m16:43:52.353982 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:43:52.354670 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:43:52.355487 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:43:52.356377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:43:52.356859 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:43:52.361576 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:43:52.370051 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:43:52.372864 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:43:52.388277 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:43:52.388587 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:43:52.581735 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m16:43:52.586036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106118b0>]}
[0m16:43:52.586722 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.23s]
[0m16:43:52.587279 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:43:52.587655 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:43:52.588165 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:43:52.588738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:43:52.589159 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:43:52.595066 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:43:52.609009 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:43:52.611048 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:43:52.622561 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:43:52.622914 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.host_id = SILVER_hosts.host_id
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:43:52.712107 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21381-0001-88f0-000c-0f16000344f6
[0m16:43:52.712930 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:43:52.719456 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:43:52.720163 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063ca40>]}
[0m16:43:52.720917 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.13s]
[0m16:43:52.721480 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:43:52.721873 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:43:52.722320 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:43:52.723113 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:43:52.724082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:43:52.724466 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:43:52.729055 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:52.741122 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:43:52.769469 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:52.769732 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:43:52.944875 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m16:43:52.959106 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:52.959587 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:43:53.025402 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m16:43:53.033175 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:53.033889 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:43:53.099259 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m16:43:53.106828 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:53.107100 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:43:53.164392 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.057 seconds
[0m16:43:53.184113 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:53.192245 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:53.192440 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:43:53.264950 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:43:53.265288 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:53.265600 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:43:54.105544 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.839 seconds
[0m16:43:54.106925 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:54.107589 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:43:54.296065 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m16:43:54.306300 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:43:54.311677 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:43:54.311954 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:43:54.419729 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m16:43:54.423679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110605d90>]}
[0m16:43:54.424642 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.70s]
[0m16:43:54.425382 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:43:54.425876 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:43:54.426466 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:43:54.427059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:43:54.427474 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:43:54.432950 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.449688 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:43:54.453012 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.453390 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:43:54.625151 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m16:43:54.630943 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.631536 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:43:54.709057 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m16:43:54.715374 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.715873 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:43:54.776041 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m16:43:54.781436 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.781981 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:43:54.840146 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.058 seconds
[0m16:43:54.847044 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.858854 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.859405 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:43:54.935210 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:43:54.936870 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:54.938059 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:43:55.436516 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.497 seconds
[0m16:43:55.438382 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:55.438988 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:43:55.584943 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m16:43:55.591101 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:43:55.592410 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:43:55.592864 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:43:55.686601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m16:43:55.690830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110188a10>]}
[0m16:43:55.692010 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.26s]
[0m16:43:55.692927 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:43:55.693463 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:43:55.694117 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:43:55.694778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:43:55.695228 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:43:55.701283 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:55.716017 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:43:55.719316 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:55.719618 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    host_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:43:55.902840 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m16:43:55.908728 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:55.909175 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:43:55.980139 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.070 seconds
[0m16:43:55.987947 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:55.988531 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:43:56.052985 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.064 seconds
[0m16:43:56.061267 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:56.061903 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:43:56.124182 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.061 seconds
[0m16:43:56.131293 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:56.143520 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:56.144000 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:43:56.220886 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m16:43:56.222208 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:56.222700 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:43:56.951645 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.728 seconds
[0m16:43:56.952801 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:56.953309 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:43:57.138243 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m16:43:57.144266 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:43:57.145473 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:43:57.145891 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:43:57.234090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m16:43:57.237803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315c0614-fbd4-44cb-9fe3-cd0a8d59c614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f1820>]}
[0m16:43:57.238702 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.54s]
[0m16:43:57.239365 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:43:57.241511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:57.242097 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:43:57.242432 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:43:57.350711 [info ] [MainThread]: 
[0m16:43:57.351489 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m16:43:57.353338 [debug] [MainThread]: Command end result
[0m16:43:57.377544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:43:57.385021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:43:57.390536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:43:57.390755 [info ] [MainThread]: 
[0m16:43:57.390984 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:43:57.391161 [info ] [MainThread]: 
[0m16:43:57.391384 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:43:57.391590 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:43:57.391750 [info ] [MainThread]: 
[0m16:43:57.391941 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:43:57.392095 [info ] [MainThread]: 
[0m16:43:57.392281 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:43:57.392678 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.757036, "process_in_blocks": "0", "process_kernel_time": 0.928923, "process_mem_max_rss": "197066752", "process_out_blocks": "0", "process_user_time": 2.327089}
[0m16:43:57.392922 [debug] [MainThread]: Command `dbt build` failed at 16:43:57.392877 after 8.76 seconds
[0m16:43:57.393126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df60560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11062ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110629f70>]}
[0m16:43:57.393316 [debug] [MainThread]: Flushing usage events
[0m16:43:58.919088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:36.431507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c54c0>]}


============================== 16:45:36.437512 | 1f68ae1a-540b-44dd-b30d-aa179bcb84c7 ==============================
[0m16:45:36.437512 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:45:36.437871 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt run --select model/gold', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None'}
[0m16:45:37.547687 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:45:37.548772 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:45:37.549188 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:45:37.700043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f68ae1a-540b-44dd-b30d-aa179bcb84c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a199220>]}
[0m16:45:37.743037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f68ae1a-540b-44dd-b30d-aa179bcb84c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096180b0>]}
[0m16:45:37.746340 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:45:37.818711 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:45:37.970258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:37.970480 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:45:37.970599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:37.987161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f68ae1a-540b-44dd-b30d-aa179bcb84c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41cfb0>]}
[0m16:45:38.018360 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:45:38.023378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:45:38.053227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f68ae1a-540b-44dd-b30d-aa179bcb84c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a1a00>]}
[0m16:45:38.053451 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:45:38.053597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f68ae1a-540b-44dd-b30d-aa179bcb84c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935cd70>]}
[0m16:45:38.054377 [warn ] [MainThread]: The selection criterion 'model/gold' does not match any enabled nodes
[0m16:45:38.054908 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:45:38.055664 [debug] [MainThread]: Command end result
[0m16:45:38.121231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:45:38.126555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:45:38.130120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:45:38.130418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.77273, "process_in_blocks": "0", "process_kernel_time": 0.856651, "process_mem_max_rss": "140460032", "process_out_blocks": "0", "process_user_time": 1.574029}
[0m16:45:38.130671 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:38.130629 after 1.77 seconds
[0m16:45:38.130858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109232960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dbf20>]}
[0m16:45:38.131024 [debug] [MainThread]: Flushing usage events
[0m16:45:39.370166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:49.734744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab8170>]}


============================== 16:45:49.739431 | 85864532-ac7e-4197-9e4a-7b9e9054cc6e ==============================
[0m16:45:49.739431 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:45:49.739785 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select models/gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'debug': 'False'}
[0m16:45:50.552351 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:45:50.553495 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:45:50.554009 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:45:50.703617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64b440>]}
[0m16:45:50.746537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38e240>]}
[0m16:45:50.749198 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:45:50.822167 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:45:50.972675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:50.972896 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:45:50.973017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:50.989515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84c680>]}
[0m16:45:51.020582 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:45:51.026091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:45:51.057538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaaf890>]}
[0m16:45:51.057762 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:45:51.057906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac8f470>]}
[0m16:45:51.059165 [info ] [MainThread]: 
[0m16:45:51.059304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:51.059405 [info ] [MainThread]: 
[0m16:45:51.059603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:51.059964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:45:51.395694 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:45:51.396081 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:45:51.396353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:52.161435 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.765 seconds
[0m16:45:52.171430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:45:52.184029 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:45:52.184363 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:45:52.261424 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.077 seconds
[0m16:45:52.263047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_dbt_schema)
[0m16:45:52.265269 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:45:52.265490 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:45:52.344323 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.079 seconds
[0m16:45:52.345804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:45:52.347810 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:45:52.348088 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:45:52.432415 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.084 seconds
[0m16:45:52.435755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8cd10>]}
[0m16:45:52.445151 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:45:52.445785 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:45:52.446239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m16:45:52.446587 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:45:52.457071 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:45:52.459944 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:45:52.477603 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:45:52.480915 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:45:52.481168 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:45:52.557915 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21383-0001-88f0-000c-0f1600034526
[0m16:45:52.558316 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:45:52.563405 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:45:52.566687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85864532-ac7e-4197-9e4a-7b9e9054cc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a313f80>]}
[0m16:45:52.567192 [error] [Thread-2 (]: 1 of 1 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.12s]
[0m16:45:52.567593 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:45:52.567997 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:45:52.569417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:52.569709 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:45:52.569935 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:45:52.944299 [info ] [MainThread]: 
[0m16:45:52.945355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m16:45:52.946636 [debug] [MainThread]: Command end result
[0m16:45:52.974669 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:45:52.982279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:45:52.987802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:45:52.988010 [info ] [MainThread]: 
[0m16:45:52.988252 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:52.988437 [info ] [MainThread]: 
[0m16:45:52.988667 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:45:52.988884 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:45:52.989046 [info ] [MainThread]: 
[0m16:45:52.989232 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:45:52.989384 [info ] [MainThread]: 
[0m16:45:52.989573 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:45:52.989971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3211741, "process_in_blocks": "0", "process_kernel_time": 0.773229, "process_mem_max_rss": "159432704", "process_out_blocks": "0", "process_user_time": 1.81902}
[0m16:45:52.990257 [debug] [MainThread]: Command `dbt run` failed at 16:45:52.990202 after 3.32 seconds
[0m16:45:52.990501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0b0e0>]}
[0m16:45:52.990723 [debug] [MainThread]: Flushing usage events
[0m16:45:54.118547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:23.255468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8bcb0>]}


============================== 16:46:23.260603 | e5c286be-c058-443b-b26e-338b9df864f6 ==============================
[0m16:46:23.260603 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:46:23.260945 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'empty': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m16:46:23.336236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5c286be-c058-443b-b26e-338b9df864f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca53d0>]}
[0m16:46:23.431614 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24593234, "process_in_blocks": "0", "process_kernel_time": 0.593816, "process_mem_max_rss": "111460352", "process_out_blocks": "0", "process_user_time": 1.171148}
[0m16:46:23.431859 [debug] [MainThread]: Command `dbt clean` succeeded at 16:46:23.431817 after 0.25 seconds
[0m16:46:23.432029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca53d0>]}
[0m16:46:23.432183 [debug] [MainThread]: Flushing usage events
[0m16:46:24.531650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:44.163802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106965250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d43e0>]}


============================== 16:46:44.168600 | ec37c306-61c5-443c-b305-f90171a9dae0 ==============================
[0m16:46:44.168600 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:46:44.168954 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'log_format': 'default', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:46:45.095662 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:46:45.096350 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:46:45.096714 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:46:45.248029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcdc10>]}
[0m16:46:45.292173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f55b50>]}
[0m16:46:45.295813 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:46:45.368931 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:46:45.370719 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:46:45.370896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b4710>]}
[0m16:46:45.518006 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m16:46:45.518283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e80b0>]}
[0m16:46:45.997497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5bc0e0>]}
[0m16:46:46.058024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:46:46.063174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:46:46.112811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6cbcb0>]}
[0m16:46:46.113056 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:46:46.113200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a741250>]}
[0m16:46:46.114116 [info ] [MainThread]: 
[0m16:46:46.114269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:46.114376 [info ] [MainThread]: 
[0m16:46:46.114566 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:46:46.116453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:46:46.504115 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:46:46.504791 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:46:46.505122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:47.247342 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.742 seconds
[0m16:46:47.254330 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:46:47.254873 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:46:47.323784 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.069 seconds
[0m16:46:47.326580 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:46:47.326884 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:46:47.447223 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m16:46:47.449655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:46:47.460064 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:46:47.460341 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:46:47.543259 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.083 seconds
[0m16:46:47.546028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:46:47.549687 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:46:47.550079 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:46:47.655760 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.105 seconds
[0m16:46:47.659021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_dbt_schema)
[0m16:46:47.663445 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:46:47.663865 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:46:47.732775 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.068 seconds
[0m16:46:47.735747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b643350>]}
[0m16:46:47.744634 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:46:47.745289 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:46:47.745796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now model.dbt_snowflake_aws_project.bookings)
[0m16:46:47.746154 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:46:47.754855 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:46:47.761520 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:46:47.779663 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:46:47.785452 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:46:47.785656 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:46:47.943053 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m16:46:47.974525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9d460>]}
[0m16:46:47.975186 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.22s]
[0m16:46:47.975627 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:46:47.975920 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:46:47.976368 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:46:47.976837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:46:47.977153 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:46:47.979362 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:46:47.981719 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:46:47.983599 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:46:47.985642 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:46:47.985880 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:46:48.137128 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m16:46:48.139175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b510ec0>]}
[0m16:46:48.139761 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.16s]
[0m16:46:48.140257 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:46:48.140581 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:46:48.141086 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:46:48.141653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:46:48.142053 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:46:48.144707 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:46:48.146769 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:46:48.148892 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:46:48.150486 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:46:48.150715 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:46:48.300341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m16:46:48.304847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6719a0>]}
[0m16:46:48.306068 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.16s]
[0m16:46:48.307031 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:46:48.307665 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:46:48.308426 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:46:48.309175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:46:48.309651 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:46:48.317832 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:46:48.322363 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:46:48.326853 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:46:48.330732 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:46:48.331095 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:46:48.424310 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21384-0001-8904-000c-0f1600035496
[0m16:46:48.424631 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:46:48.429246 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:46:48.429590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a08c0>]}
[0m16:46:48.430004 [error] [Thread-2 (]: 4 of 7 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.12s]
[0m16:46:48.430361 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:46:48.430612 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:46:48.430927 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:46:48.431261 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:46:48.432008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:46:48.432206 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:46:48.434354 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.436542 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:46:48.460066 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.460339 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:46:48.635406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m16:46:48.649238 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.649755 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:46:48.723752 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.073 seconds
[0m16:46:48.728988 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.729390 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:46:48.788590 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.059 seconds
[0m16:46:48.800453 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.800827 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:46:48.861340 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.060 seconds
[0m16:46:48.888006 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.891336 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.891549 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:46:48.968731 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m16:46:48.969171 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:48.969547 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:46:49.620304 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.650 seconds
[0m16:46:49.621626 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:49.622160 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:46:49.799322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m16:46:49.804076 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:46:49.808307 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:46:49.808502 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:46:49.914063 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m16:46:49.916886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b747b30>]}
[0m16:46:49.917644 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.48s]
[0m16:46:49.918368 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:46:49.918869 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:46:49.919471 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:46:49.920031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:46:49.920417 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:46:49.923511 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:49.925134 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:46:49.928281 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:49.928595 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:46:50.119889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m16:46:50.126589 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.127347 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:46:50.216403 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.088 seconds
[0m16:46:50.223242 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.223792 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:46:50.295192 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m16:46:50.302491 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.303062 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:46:50.362546 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m16:46:50.369400 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.373399 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.373856 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:46:50.446773 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:46:50.447671 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:50.448198 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:46:51.054062 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.605 seconds
[0m16:46:51.055161 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:51.055710 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:46:51.247220 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m16:46:51.254123 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:46:51.255656 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:46:51.256202 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:46:51.358792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m16:46:51.361521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70b5f0>]}
[0m16:46:51.362295 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.44s]
[0m16:46:51.363180 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:46:51.363746 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:46:51.364352 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:46:51.364882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:46:51.365240 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:46:51.368831 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.371473 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:46:51.374609 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.374926 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    host_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:46:51.556174 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m16:46:51.564517 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.565199 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:46:51.642401 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m16:46:51.648385 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.648784 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:46:51.716678 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.067 seconds
[0m16:46:51.723761 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.724288 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:46:51.782228 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.057 seconds
[0m16:46:51.788907 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.792548 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.792898 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:46:51.872214 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:46:51.873921 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:51.874560 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:46:52.421430 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.546 seconds
[0m16:46:52.422696 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:52.423374 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:46:52.582263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m16:46:52.589113 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:46:52.590477 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:46:52.590935 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:46:52.702991 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:46:52.706815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec37c306-61c5-443c-b305-f90171a9dae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7939e0>]}
[0m16:46:52.707557 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.34s]
[0m16:46:52.708101 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:46:52.709421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:52.709720 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:46:52.709991 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:46:52.793138 [info ] [MainThread]: 
[0m16:46:52.793630 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m16:46:52.795038 [debug] [MainThread]: Command end result
[0m16:46:52.818691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:46:52.825770 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:46:52.831080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:46:52.831282 [info ] [MainThread]: 
[0m16:46:52.831472 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:52.831630 [info ] [MainThread]: 
[0m16:46:52.831828 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:46:52.832016 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:46:52.832158 [info ] [MainThread]: 
[0m16:46:52.832326 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:46:52.832465 [info ] [MainThread]: 
[0m16:46:52.832621 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m16:46:52.832914 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:46:52.833278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.738351, "process_in_blocks": "0", "process_kernel_time": 0.877841, "process_mem_max_rss": "167591936", "process_out_blocks": "0", "process_user_time": 2.511537}
[0m16:46:52.833513 [debug] [MainThread]: Command `dbt run` failed at 16:46:52.833466 after 8.74 seconds
[0m16:46:52.833719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109333fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a16ef00>]}
[0m16:46:52.833909 [debug] [MainThread]: Flushing usage events
[0m16:46:54.225804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:09.006939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b61e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21fad0>]}


============================== 16:48:09.009777 | 2219817c-28e4-4bfd-a20e-a87d05d64da0 ==============================
[0m16:48:09.009777 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:09.010058 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m16:48:09.076984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2219817c-28e4-4bfd-a20e-a87d05d64da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b92060>]}
[0m16:48:09.106699 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13956529, "process_in_blocks": "0", "process_kernel_time": 0.151474, "process_mem_max_rss": "111411200", "process_out_blocks": "0", "process_user_time": 0.644903}
[0m16:48:09.106937 [debug] [MainThread]: Command `dbt clean` succeeded at 16:48:09.106895 after 0.14 seconds
[0m16:48:09.107107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21fe30>]}
[0m16:48:09.107251 [debug] [MainThread]: Flushing usage events
[0m16:48:10.237331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:10.413649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c43f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d84a0>]}


============================== 16:48:10.417496 | d774785e-1425-4f94-8990-5e47adc435da ==============================
[0m16:48:10.417496 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:10.417779 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:48:10.482152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd774785e-1425-4f94-8990-5e47adc435da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e525d0>]}
[0m16:48:10.529469 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:48:10.530118 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:48:10.530384 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1755992, "process_in_blocks": "0", "process_kernel_time": 0.182797, "process_mem_max_rss": "111656960", "process_out_blocks": "0", "process_user_time": 0.679987}
[0m16:48:10.530593 [debug] [MainThread]: Command `cli deps` succeeded at 16:48:10.530550 after 0.18 seconds
[0m16:48:10.530741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3710>]}
[0m16:48:10.530879 [debug] [MainThread]: Flushing usage events
[0m16:48:11.469054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:25.364056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61bfe0>]}


============================== 16:48:25.368825 | d248cd81-3a74-4fae-8928-72b9fa430629 ==============================
[0m16:48:25.368825 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:25.369168 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select models/obt', 'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False'}
[0m16:48:26.480314 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:48:26.482175 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:48:26.483328 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:48:26.636640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd248cd81-3a74-4fae-8928-72b9fa430629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be23ef0>]}
[0m16:48:26.679366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd248cd81-3a74-4fae-8928-72b9fa430629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1dd0d0>]}
[0m16:48:26.682026 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:48:26.757918 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:48:26.929774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:26.930010 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:48:26.930137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:26.948003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd248cd81-3a74-4fae-8928-72b9fa430629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32b3e0>]}
[0m16:48:26.981133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:48:26.984340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:48:27.014867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd248cd81-3a74-4fae-8928-72b9fa430629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8324b0>]}
[0m16:48:27.015082 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:48:27.015221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd248cd81-3a74-4fae-8928-72b9fa430629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c71dbb0>]}
[0m16:48:27.015993 [warn ] [MainThread]: The selection criterion 'models/obt' does not match any enabled nodes
[0m16:48:27.016492 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:48:27.017262 [debug] [MainThread]: Command end result
[0m16:48:27.056033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:48:27.060891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:48:27.063471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:48:27.063739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7650236, "process_in_blocks": "0", "process_kernel_time": 0.758076, "process_mem_max_rss": "140558336", "process_out_blocks": "0", "process_user_time": 1.621092}
[0m16:48:27.063964 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:27.063926 after 1.77 seconds
[0m16:48:27.064126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be52de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e0c50>]}
[0m16:48:27.064274 [debug] [MainThread]: Flushing usage events
[0m16:48:28.229691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:39.990245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b74c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40fef0>]}


============================== 16:48:39.995057 | c666089e-a1ea-4b95-ab62-9bf58a8488ee ==============================
[0m16:48:39.995057 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:39.995366 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select models/gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m16:48:41.115599 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:48:41.117005 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:48:41.117653 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:48:41.277363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd363c0>]}
[0m16:48:41.320608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd12540>]}
[0m16:48:41.322803 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:48:41.392116 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:48:41.543316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:41.543544 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:48:41.543665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:41.560277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c24fda0>]}
[0m16:48:41.592183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:48:41.594502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:48:41.618806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6213a0>]}
[0m16:48:41.619026 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:48:41.619170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6117c0>]}
[0m16:48:41.620429 [info ] [MainThread]: 
[0m16:48:41.620572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:41.620673 [info ] [MainThread]: 
[0m16:48:41.620866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:41.621221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:48:41.841999 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:48:41.842274 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:48:41.842440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:42.563470 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.721 seconds
[0m16:48:42.572036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:48:42.582346 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:48:42.582617 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:48:42.677443 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.094 seconds
[0m16:48:42.681129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:48:42.685781 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:48:42.686281 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:48:42.770834 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.084 seconds
[0m16:48:42.775111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m16:48:42.781417 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:48:42.782048 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:48:42.864036 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.082 seconds
[0m16:48:42.865633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0ebcb0>]}
[0m16:48:42.870223 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:48:42.870561 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:48:42.870835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.obt)
[0m16:48:42.871031 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:48:42.876761 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:48:42.879390 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:48:42.893902 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:48:42.898787 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:48:42.898998 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:48:42.998664 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21386-0001-8904-000c-0f16000354b6
[0m16:48:42.999022 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:48:43.003903 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:48:43.007390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c666089e-a1ea-4b95-ab62-9bf58a8488ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63f9b0>]}
[0m16:48:43.007921 [error] [Thread-2 (]: 1 of 1 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.13s]
[0m16:48:43.008348 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:48:43.008751 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:48:43.010165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:43.010464 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:48:43.010692 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:48:43.089920 [info ] [MainThread]: 
[0m16:48:43.090370 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m16:48:43.091021 [debug] [MainThread]: Command end result
[0m16:48:43.111147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:48:43.121085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:48:43.126661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:48:43.126879 [info ] [MainThread]: 
[0m16:48:43.127128 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:48:43.127309 [info ] [MainThread]: 
[0m16:48:43.127543 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:48:43.127757 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:48:43.127916 [info ] [MainThread]: 
[0m16:48:43.128106 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:48:43.128263 [info ] [MainThread]: 
[0m16:48:43.128443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:48:43.128796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1969457, "process_in_blocks": "0", "process_kernel_time": 0.740348, "process_mem_max_rss": "159694848", "process_out_blocks": "0", "process_user_time": 1.719358}
[0m16:48:43.129057 [debug] [MainThread]: Command `dbt run` failed at 16:48:43.129011 after 3.20 seconds
[0m16:48:43.129273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b74c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0ebcb0>]}
[0m16:48:43.129479 [debug] [MainThread]: Flushing usage events
[0m16:48:44.308345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:22.276786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b863fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b863f80>]}


============================== 16:49:22.282319 | ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d ==============================
[0m16:49:22.282319 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:49:22.282645 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select models/gold', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False'}
[0m16:49:23.325905 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:49:23.326354 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:49:23.326650 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:49:23.456272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7fc230>]}
[0m16:49:23.499104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf9b980>]}
[0m16:49:23.502393 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:49:23.579048 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:49:23.738623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:23.738848 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:49:23.738965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:23.755672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8901a0>]}
[0m16:49:23.788289 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:49:23.790656 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:49:23.827606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca75700>]}
[0m16:49:23.827825 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:49:23.827969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b861f10>]}
[0m16:49:23.829625 [info ] [MainThread]: 
[0m16:49:23.829766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:23.829866 [info ] [MainThread]: 
[0m16:49:23.830063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:23.830421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:49:24.075465 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:49:24.075668 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:49:24.075779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:24.843529 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.767 seconds
[0m16:49:24.853556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:49:24.866129 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:49:24.866505 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:49:24.953588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m16:49:24.955541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_dbt_schema)
[0m16:49:24.958169 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:49:24.958475 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:49:25.030213 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m16:49:25.031512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:49:25.033133 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:49:25.033353 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:49:25.117878 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.084 seconds
[0m16:49:25.120991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c968530>]}
[0m16:49:25.129254 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:49:25.129963 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:49:25.130435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m16:49:25.130753 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:49:25.139421 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:49:25.141836 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:49:25.158944 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:49:25.161933 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:49:25.162152 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
-- then we will use the from statement
FROM
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:49:25.236084 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21387-0001-8904-000c-0f16000354be
[0m16:49:25.236447 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 0 unexpected 'FROM'.
syntax error line 26 at position 2 unexpected ')'.
[0m16:49:25.241050 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'FROM'.
  syntax error line 26 at position 2 unexpected ')'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:49:25.244343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce4a9663-41ce-4fcd-a24f-66e5bcd43d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c96aa20>]}
[0m16:49:25.244784 [error] [Thread-2 (]: 1 of 1 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.11s]
[0m16:49:25.245136 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:49:25.245473 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'FROM'.
  syntax error line 26 at position 2 unexpected ')'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:49:25.246574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:25.246752 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:49:25.246918 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:49:25.323735 [info ] [MainThread]: 
[0m16:49:25.324172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m16:49:25.324847 [debug] [MainThread]: Command end result
[0m16:49:25.346632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:49:25.357030 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:49:25.362333 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:49:25.362539 [info ] [MainThread]: 
[0m16:49:25.362772 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:25.362961 [info ] [MainThread]: 
[0m16:49:25.363195 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:49:25.363403 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 0 unexpected 'FROM'.
  syntax error line 26 at position 2 unexpected ')'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:49:25.363566 [info ] [MainThread]: 
[0m16:49:25.363750 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:49:25.363900 [info ] [MainThread]: 
[0m16:49:25.364083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:25.364462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1565614, "process_in_blocks": "0", "process_kernel_time": 0.96264, "process_mem_max_rss": "159137792", "process_out_blocks": "0", "process_user_time": 1.789876}
[0m16:49:25.364738 [debug] [MainThread]: Command `dbt run` failed at 16:49:25.364686 after 3.16 seconds
[0m16:49:25.364965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca66ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b863b00>]}
[0m16:49:25.365178 [debug] [MainThread]: Flushing usage events
[0m16:49:26.496707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:20.853729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086747a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094440b0>]}


============================== 16:50:20.859344 | b0cbda2c-7576-45f6-aa08-e68a45e1f5ae ==============================
[0m16:50:20.859344 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:50:20.859712 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select models/gold', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'write_json': 'True', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:50:22.011166 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:50:22.011492 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:50:22.011669 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:50:22.108355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a253a70>]}
[0m16:50:22.152275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109454260>]}
[0m16:50:22.155746 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:50:22.230564 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:50:22.390669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:22.390896 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:50:22.391014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:22.407916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34a960>]}
[0m16:50:22.439626 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:50:22.442152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:50:22.473160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4cdaf0>]}
[0m16:50:22.473373 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:50:22.473513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e31c40>]}
[0m16:50:22.474776 [info ] [MainThread]: 
[0m16:50:22.474911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:22.475010 [info ] [MainThread]: 
[0m16:50:22.475205 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:22.475565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:50:22.720729 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:50:22.720929 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:50:22.721056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:23.538701 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.817 seconds
[0m16:50:23.545868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:50:23.556442 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:50:23.556749 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:50:23.844426 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.287 seconds
[0m16:50:23.847780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:50:23.851299 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:50:23.851690 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:50:23.947909 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.096 seconds
[0m16:50:23.951158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:50:23.954869 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:50:23.955219 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:50:24.051537 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.096 seconds
[0m16:50:24.056789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a80d10>]}
[0m16:50:24.067813 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:50:24.068601 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:50:24.069169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m16:50:24.069549 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:50:24.079707 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:50:24.091094 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:50:24.109094 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:50:24.125773 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:50:24.126053 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:50:24.217299 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21388-0001-8904-000c-0f16000354ca
[0m16:50:24.217964 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:50:24.224311 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:50:24.228805 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0cbda2c-7576-45f6-aa08-e68a45e1f5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4fb9b0>]}
[0m16:50:24.229478 [error] [Thread-2 (]: 1 of 1 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.16s]
[0m16:50:24.230037 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:50:24.230537 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:50:24.232251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:24.232591 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:50:24.232865 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:50:24.320635 [info ] [MainThread]: 
[0m16:50:24.321602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m16:50:24.322570 [debug] [MainThread]: Command end result
[0m16:50:24.345732 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:50:24.356491 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:50:24.361923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:50:24.362140 [info ] [MainThread]: 
[0m16:50:24.362376 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:24.362559 [info ] [MainThread]: 
[0m16:50:24.362788 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:50:24.363003 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:50:24.363160 [info ] [MainThread]: 
[0m16:50:24.363346 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:50:24.363500 [info ] [MainThread]: 
[0m16:50:24.363681 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:50:24.364070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5807648, "process_in_blocks": "0", "process_kernel_time": 0.757442, "process_mem_max_rss": "159481856", "process_out_blocks": "0", "process_user_time": 1.597242}
[0m16:50:24.364345 [debug] [MainThread]: Command `dbt run` failed at 16:50:24.364292 after 3.58 seconds
[0m16:50:24.364577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dc0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086747a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094440b0>]}
[0m16:50:24.364789 [debug] [MainThread]: Flushing usage events
[0m16:50:25.479071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:23.509341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca36a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d40e0>]}


============================== 16:51:23.514061 | 9a08ffe5-d0b1-44a0-ad45-8566f8695b82 ==============================
[0m16:51:23.514061 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:51:23.514433 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select models/gold', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m16:51:24.500124 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:51:24.501247 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:51:24.501893 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:51:24.658454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e548230>]}
[0m16:51:24.701575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e62a0>]}
[0m16:51:24.705039 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:51:24.779360 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:51:24.964713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:51:24.964926 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:51:24.965027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:51:24.980925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7761e0>]}
[0m16:51:25.013195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:51:25.016683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:51:25.059245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf48f0>]}
[0m16:51:25.059471 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:51:25.059614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5cd2e0>]}
[0m16:51:25.061037 [info ] [MainThread]: 
[0m16:51:25.061176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:25.061277 [info ] [MainThread]: 
[0m16:51:25.061473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:25.061846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:51:25.324199 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:51:25.324509 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:51:25.324704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:26.273260 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.948 seconds
[0m16:51:26.277583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:51:26.284963 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:51:26.285168 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:51:26.358247 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.073 seconds
[0m16:51:26.359715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:51:26.361767 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:51:26.362050 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:51:26.503898 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.142 seconds
[0m16:51:26.506266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:51:26.509555 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:51:26.509931 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:51:26.589007 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m16:51:26.594048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d6270>]}
[0m16:51:26.606563 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:51:26.607468 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:51:26.608178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m16:51:26.608655 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:51:26.620465 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:51:26.623461 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:51:26.642385 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:51:26.645806 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:51:26.646086 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAG, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:51:26.740690 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21389-0001-8904-000c-0f16000354d2
[0m16:51:26.741314 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'SILVER_LISTINGS.HOST_ID'
[0m16:51:26.748214 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:51:26.752243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a08ffe5-d0b1-44a0-ad45-8566f8695b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb9df0>]}
[0m16:51:26.752853 [error] [Thread-2 (]: 1 of 1 ERROR creating sql view model dbt_schema.obt ............................ [[31mERROR[0m in 0.14s]
[0m16:51:26.753344 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:51:26.753747 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m16:51:26.755248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:26.755515 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:51:26.755752 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:51:26.833498 [info ] [MainThread]: 
[0m16:51:26.833997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m16:51:26.834704 [debug] [MainThread]: Command end result
[0m16:51:26.855977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:51:26.863906 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:51:26.868613 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:51:26.868802 [info ] [MainThread]: 
[0m16:51:26.869012 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:51:26.869175 [info ] [MainThread]: 
[0m16:51:26.869379 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m16:51:26.869561 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'SILVER_LISTINGS.HOST_ID'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:51:26.869706 [info ] [MainThread]: 
[0m16:51:26.869870 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m16:51:26.870005 [info ] [MainThread]: 
[0m16:51:26.870165 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:51:26.870512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4295256, "process_in_blocks": "0", "process_kernel_time": 0.927844, "process_mem_max_rss": "159596544", "process_out_blocks": "0", "process_user_time": 1.844767}
[0m16:51:26.870758 [debug] [MainThread]: Command `dbt run` failed at 16:51:26.870711 after 3.43 seconds
[0m16:51:26.870976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14d910>]}
[0m16:51:26.871170 [debug] [MainThread]: Flushing usage events
[0m16:51:27.945421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:59.039079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac81520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac81430>]}


============================== 16:51:59.043972 | 9ab64c5a-493f-4385-a3ab-a6ce68a6efa2 ==============================
[0m16:51:59.043972 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:51:59.044332 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/gold', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'empty': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m16:51:59.775744 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:51:59.776133 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:51:59.776340 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:51:59.892736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c272b40>]}
[0m16:51:59.941245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ef380>]}
[0m16:51:59.945010 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:52:00.019290 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:52:00.180903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:00.181133 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:52:00.181250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:00.198325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9661e0>]}
[0m16:52:00.229831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:52:00.232024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:52:00.255803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d5100>]}
[0m16:52:00.256038 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:52:00.256178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b965fd0>]}
[0m16:52:00.257529 [info ] [MainThread]: 
[0m16:52:00.257667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:00.257769 [info ] [MainThread]: 
[0m16:52:00.257971 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:00.258317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:52:00.496327 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:52:00.496527 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:52:00.496640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:01.317578 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.821 seconds
[0m16:52:01.327579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m16:52:01.340228 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:52:01.342319 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:52:01.532994 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.190 seconds
[0m16:52:01.537174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_dbt_schema)
[0m16:52:01.541726 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:52:01.542132 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:52:01.606206 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.064 seconds
[0m16:52:01.608049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:52:01.610365 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:52:01.610698 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:52:01.711613 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.101 seconds
[0m16:52:01.713886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b933620>]}
[0m16:52:01.721896 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:52:01.722394 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:52:01.722791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.obt)
[0m16:52:01.723086 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:52:01.731129 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:52:01.747423 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:52:01.763926 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:52:01.780308 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:52:01.780567 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:52:02.045231 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m16:52:02.075656 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab64c5a-493f-4385-a3ab-a6ce68a6efa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109239550>]}
[0m16:52:02.076251 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_schema.obt ................................ [[32mSUCCESS 1[0m in 0.35s]
[0m16:52:02.076696 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:52:02.077676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:02.077941 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:52:02.078146 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:52:02.160014 [info ] [MainThread]: 
[0m16:52:02.160513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m16:52:02.161213 [debug] [MainThread]: Command end result
[0m16:52:02.182322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:52:02.187869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:52:02.192079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:52:02.192258 [info ] [MainThread]: 
[0m16:52:02.192472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:02.192619 [info ] [MainThread]: 
[0m16:52:02.192798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:52:02.193147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2235231, "process_in_blocks": "0", "process_kernel_time": 0.589882, "process_mem_max_rss": "158859264", "process_out_blocks": "0", "process_user_time": 1.655319}
[0m16:52:02.193407 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:02.193359 after 3.22 seconds
[0m16:52:02.193612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103167170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca61550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abed2b0>]}
[0m16:52:02.193810 [debug] [MainThread]: Flushing usage events
[0m16:52:03.376359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:06.353604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c89ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63c0e0>]}


============================== 16:53:06.358107 | 357e4213-3ca8-44c2-b52f-a2580eb7875c ==============================
[0m16:53:06.358107 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:53:06.358418 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/silver', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m16:53:07.385137 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:53:07.386339 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:53:07.386848 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:53:07.542646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10decf560>]}
[0m16:53:07.585657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c954740>]}
[0m16:53:07.589028 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:53:07.664434 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:53:07.819747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:07.819973 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:53:07.820096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:07.836703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f95e0>]}
[0m16:53:07.868656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:53:07.871024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:53:07.908247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4f16a0>]}
[0m16:53:07.908492 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:53:07.908639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6de4b0>]}
[0m16:53:07.910011 [info ] [MainThread]: 
[0m16:53:07.910152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:07.910254 [info ] [MainThread]: 
[0m16:53:07.910448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:07.912201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:53:08.209270 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:53:08.209713 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:53:08.209978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:09.214897 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.005 seconds
[0m16:53:09.217860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m16:53:09.228787 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:53:09.229099 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:53:09.425070 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.196 seconds
[0m16:53:09.431597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m16:53:09.434981 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:53:09.435375 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:53:09.593207 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.157 seconds
[0m16:53:09.596321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_dbt_schema)
[0m16:53:09.599718 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:53:09.600169 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:53:09.781922 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.181 seconds
[0m16:53:09.785805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5abe00>]}
[0m16:53:09.795024 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:53:09.795993 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:53:09.797341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:53:09.797827 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:53:09.807970 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:09.811461 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:53:09.846710 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:09.846988 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:53:10.038984 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m16:53:10.052548 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.053381 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:53:10.148152 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.094 seconds
[0m16:53:10.154406 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.154904 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:53:10.243298 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.088 seconds
[0m16:53:10.258142 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.258613 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:53:10.362315 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.103 seconds
[0m16:53:10.393340 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.396665 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.396884 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:53:10.484868 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m16:53:10.485724 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:10.486250 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:53:11.268843 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.782 seconds
[0m16:53:11.270002 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:11.270573 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:53:11.491501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m16:53:11.496313 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:53:11.499756 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:53:11.499950 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:53:11.602991 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m16:53:11.626099 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c89d190>]}
[0m16:53:11.626650 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.83s]
[0m16:53:11.627082 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:53:11.627359 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:53:11.627758 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:53:11.628082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:53:11.628324 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:53:11.630418 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:11.632203 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:53:11.634601 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:11.634858 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:53:11.881986 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m16:53:11.888299 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:11.889065 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:53:11.966021 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m16:53:11.972432 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:11.972959 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:53:12.040084 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.066 seconds
[0m16:53:12.046837 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:12.047264 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:53:12.185457 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.138 seconds
[0m16:53:12.192810 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:12.196894 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:12.197478 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:53:12.285164 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m16:53:12.286526 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:12.287222 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:53:13.318074 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 1.030 seconds
[0m16:53:13.319587 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:13.320579 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:53:13.528690 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m16:53:13.536244 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:53:13.537293 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:53:13.537675 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:53:13.746394 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m16:53:13.751084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150fbdd0>]}
[0m16:53:13.752369 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 2.12s]
[0m16:53:13.753362 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:53:13.754028 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:53:13.754732 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:53:13.755428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:53:13.755921 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:53:13.762030 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:13.764977 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:53:13.769182 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:13.769645 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

select 
    listing_id,
    host_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:53:13.978391 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m16:53:13.982665 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:13.983190 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:53:14.064955 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m16:53:14.071145 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.071610 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:53:14.136330 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.064 seconds
[0m16:53:14.143944 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.144531 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:53:14.209898 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.065 seconds
[0m16:53:14.213382 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.215446 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.215707 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:53:14.283840 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m16:53:14.284188 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.284442 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:53:14.844286 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.559 seconds
[0m16:53:14.845556 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:14.846207 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:53:15.038487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m16:53:15.044594 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:53:15.045880 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:53:15.046336 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:53:15.159346 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m16:53:15.162782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357e4213-3ca8-44c2-b52f-a2580eb7875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae55430>]}
[0m16:53:15.163744 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.41s]
[0m16:53:15.164532 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:53:15.166590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:15.167021 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:53:15.167366 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:53:15.927109 [info ] [MainThread]: 
[0m16:53:15.928169 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m16:53:15.929889 [debug] [MainThread]: Command end result
[0m16:53:15.960272 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:53:15.972426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:53:15.979024 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:53:15.979300 [info ] [MainThread]: 
[0m16:53:15.979590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:15.979797 [info ] [MainThread]: 
[0m16:53:15.980039 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:53:15.980538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.693824, "process_in_blocks": "0", "process_kernel_time": 1.020213, "process_mem_max_rss": "160481280", "process_out_blocks": "0", "process_user_time": 2.136651}
[0m16:53:15.980908 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:15.980839 after 9.69 seconds
[0m16:53:15.981203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f0680>]}
[0m16:53:15.981463 [debug] [MainThread]: Flushing usage events
[0m16:53:17.206163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:03.475700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa085f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa09430>]}


============================== 16:54:03.480588 | ccc94f96-b8af-49ad-90ad-b52e392987a5 ==============================
[0m16:54:03.480588 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:54:03.480929 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'cache_selected_only': 'False', 'empty': 'False', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select models/silver', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager'}
[0m16:54:04.557836 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:54:04.558999 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:54:04.559650 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:54:04.722285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082180>]}
[0m16:54:04.765691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0fe510>]}
[0m16:54:04.769096 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:54:04.842597 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:54:05.054591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:05.054837 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:54:05.054961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:05.072552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c547a40>]}
[0m16:54:05.105899 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:54:05.111847 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:54:05.175687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c587bf0>]}
[0m16:54:05.175954 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:54:05.176118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4970b0>]}
[0m16:54:05.177908 [info ] [MainThread]: 
[0m16:54:05.178068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:05.178189 [info ] [MainThread]: 
[0m16:54:05.178412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:05.180460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:54:05.584277 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:54:05.584842 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:54:05.585132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:06.382046 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.797 seconds
[0m16:54:06.384201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:54:06.392263 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:54:06.392499 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:54:06.469330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.077 seconds
[0m16:54:06.472021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:54:06.474119 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:54:06.474358 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:54:06.553439 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m16:54:06.556156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m16:54:06.559573 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:54:06.560045 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:54:06.639504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.079 seconds
[0m16:54:06.643160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c587530>]}
[0m16:54:06.651719 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:54:06.652257 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:54:06.652970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:54:06.653304 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:54:06.660907 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:06.663138 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:54:06.693503 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:06.693744 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:54:06.869197 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m16:54:06.880468 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:06.880900 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:54:06.953134 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.072 seconds
[0m16:54:06.957951 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:06.958413 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:54:07.026546 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.068 seconds
[0m16:54:07.042976 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:07.043474 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:54:07.099612 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.055 seconds
[0m16:54:07.132544 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:07.135920 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:07.136145 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:54:07.209983 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m16:54:07.210719 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:07.211101 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:54:07.791973 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.580 seconds
[0m16:54:07.793254 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:07.793895 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:54:08.027011 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m16:54:08.040162 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:54:08.046491 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:54:08.046808 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:54:08.160800 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m16:54:08.183985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ec5f0>]}
[0m16:54:08.184560 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.53s]
[0m16:54:08.184976 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:54:08.185231 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:54:08.185583 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:54:08.185880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:54:08.186105 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:54:08.188260 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.191154 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:54:08.193649 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.193967 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:54:08.377109 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m16:54:08.382771 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.383299 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:54:08.452373 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.068 seconds
[0m16:54:08.459919 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.460540 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:54:08.527065 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.066 seconds
[0m16:54:08.533803 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.534375 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:54:08.609130 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m16:54:08.616059 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.621672 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.622188 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:54:08.694516 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:54:08.695867 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:08.696912 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:54:09.226276 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.528 seconds
[0m16:54:09.227635 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:09.228291 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:54:09.443864 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m16:54:09.452279 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:54:09.453115 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:54:09.453467 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:54:09.559823 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m16:54:09.564181 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313d400>]}
[0m16:54:09.565203 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.38s]
[0m16:54:09.565961 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:54:09.566452 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:54:09.567043 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:54:09.567660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:54:09.568088 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:54:09.573796 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:54:09.578051 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:54:09.593467 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:54:09.596553 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:54:09.596884 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace transient table AIRBNB_PRO.silver.silver_listings
    
    
    
    as (

select 
    listing_id,
    host_id,
    property_type,
    room_type,
    city,
    country,
    accommodates,
    bedrooms,
    bathrooms,
    price_per_night,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    created_at
from
    AIRBNB_PRO.semi_raw.listings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:54:10.145258 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m16:54:10.147281 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:54:10.147773 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:54:10.147983 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:54:10.208911 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.061 seconds
[0m16:54:10.210910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc94f96-b8af-49ad-90ad-b52e392987a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11313ae40>]}
[0m16:54:10.211541 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 1[0m in 0.64s]
[0m16:54:10.212000 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:54:10.213013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:10.213278 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:54:10.213510 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:54:10.301116 [info ] [MainThread]: 
[0m16:54:10.301897 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m16:54:10.303079 [debug] [MainThread]: Command end result
[0m16:54:10.326820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:54:10.337555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:54:10.343093 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:54:10.343334 [info ] [MainThread]: 
[0m16:54:10.343576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:10.343760 [info ] [MainThread]: 
[0m16:54:10.343960 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:54:10.344355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9389877, "process_in_blocks": "0", "process_kernel_time": 1.121296, "process_mem_max_rss": "160694272", "process_out_blocks": "0", "process_user_time": 2.150303}
[0m16:54:10.344633 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:10.344579 after 6.94 seconds
[0m16:54:10.344858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b568dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109165760>]}
[0m16:54:10.345078 [debug] [MainThread]: Flushing usage events
[0m16:54:11.579700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:55.430310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b055520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b055490>]}


============================== 16:54:55.435155 | 9d01528d-3785-4588-8985-a5f04f959820 ==============================
[0m16:54:55.435155 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:54:55.435510 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select models/silver', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m16:54:56.538722 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:54:56.540017 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:54:56.540572 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:54:56.691124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d01528d-3785-4588-8985-a5f04f959820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962e300>]}
[0m16:54:56.735373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d01528d-3785-4588-8985-a5f04f959820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c56da30>]}
[0m16:54:56.738154 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:54:56.807781 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:54:56.968287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:56.968621 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://models/silver/silver_listings.sql
[0m16:54:57.040659 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_snowflake_aws_project.silver_listings' (models/silver/silver_listings.sql) depends on a node named 'bronze_listings' which was not found
[0m16:54:57.041041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6787463, "process_in_blocks": "0", "process_kernel_time": 0.709092, "process_mem_max_rss": "144146432", "process_out_blocks": "0", "process_user_time": 1.559296}
[0m16:54:57.041257 [debug] [MainThread]: Command `dbt run` failed at 16:54:57.041222 after 1.68 seconds
[0m16:54:57.041410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd67e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf57ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf57e90>]}
[0m16:54:57.041543 [debug] [MainThread]: Flushing usage events
[0m16:54:58.274699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:51.827998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b03fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109472270>]}


============================== 16:55:51.832975 | 2a46feb4-8fbd-4a5e-8701-3832ed6cd53c ==============================
[0m16:55:51.832975 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:55:51.833333 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/silver', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:55:52.944905 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:55:52.946247 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:55:52.947019 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:55:53.106023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740e180>]}
[0m16:55:53.150630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e1f10>]}
[0m16:55:53.153214 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:55:53.226121 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:55:53.408632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:53.408880 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:55:53.409011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:53.427386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad4290>]}
[0m16:55:53.460154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:55:53.463417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:55:53.496048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992a960>]}
[0m16:55:53.496270 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:55:53.496412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2fc80>]}
[0m16:55:53.498077 [info ] [MainThread]: 
[0m16:55:53.498216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:53.498321 [info ] [MainThread]: 
[0m16:55:53.498517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:53.500257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:55:53.756158 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:55:53.756399 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:55:53.756635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:54.582594 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.826 seconds
[0m16:55:54.588509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:55:54.604686 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:55:54.605148 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:55:54.701229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m16:55:54.703731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:55:54.705622 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:55:54.705870 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:55:54.795570 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.089 seconds
[0m16:55:54.798456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:55:54.802152 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:55:54.802586 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:55:54.901642 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.099 seconds
[0m16:55:54.904266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e3e30>]}
[0m16:55:54.912814 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:55:54.913245 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:55:54.913828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:55:54.914099 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:55:54.921200 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:54.931444 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:55:54.962483 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:54.962763 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:55:55.210037 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m16:55:55.220184 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.220628 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:55:55.284487 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.063 seconds
[0m16:55:55.290824 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.291410 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:55:55.353908 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.062 seconds
[0m16:55:55.372231 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.372684 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:55:55.453882 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.081 seconds
[0m16:55:55.490514 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.498659 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.498899 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:55:55.584548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m16:55:55.585391 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:55.585848 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:55:56.645353 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.059 seconds
[0m16:55:56.646831 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:56.647352 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:55:56.816114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m16:55:56.828595 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:55:56.834916 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:55:56.835299 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:55:56.938250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m16:55:56.968221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d89220>]}
[0m16:55:56.968795 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 2.05s]
[0m16:55:56.969239 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:55:56.969534 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:55:56.969958 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:55:56.970335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:55:56.970598 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:55:56.973102 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:56.986426 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:55:56.988841 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:56.989066 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:55:57.169565 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m16:55:57.175088 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.175643 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:55:57.246305 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.070 seconds
[0m16:55:57.252955 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.253473 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:55:57.319738 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.066 seconds
[0m16:55:57.325996 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.326565 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:55:57.386261 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m16:55:57.392473 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.404567 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.405050 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:55:57.469554 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.064 seconds
[0m16:55:57.470963 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.471653 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:55:57.976121 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.504 seconds
[0m16:55:57.977435 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:57.978060 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:55:58.140946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m16:55:58.149096 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:55:58.150369 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:55:58.150829 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:55:58.251869 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m16:55:58.256058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdebbc0>]}
[0m16:55:58.256916 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.29s]
[0m16:55:58.257753 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:55:58.258204 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:55:58.258774 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:55:58.259225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:55:58.259562 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:55:58.263972 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.279272 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:55:58.282100 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.282379 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN CAST(PRICE_PER_NIGHT AS INT) < 100 THEN 'low'
        WHEN CAST(PRICE_PER_NIGHT AS INT) < 200 THEN 'medium'
        ELSE 'high'
    END
 AS PRICE_PER_NIGHT_TAG,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:55:58.446524 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m16:55:58.452822 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.453477 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:55:58.527260 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.073 seconds
[0m16:55:58.535126 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.535779 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:55:58.613644 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m16:55:58.620324 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.620856 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:55:58.691449 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.070 seconds
[0m16:55:58.699919 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.722120 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.722916 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:55:58.798451 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:55:58.799695 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:55:58.800220 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:55:58.927860 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2138d-0001-88b7-000c-0f16000375c6
[0m16:55:58.928641 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 143
invalid identifier 'PRICE_PER_NIGHT_TAGGED'
[0m16:55:58.936002 [debug] [Thread-2 (]: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 143
  invalid identifier 'PRICE_PER_NIGHT_TAGGED'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m16:55:58.936767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46feb4-8fbd-4a5e-8701-3832ed6cd53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5c440>]}
[0m16:55:58.937688 [error] [Thread-2 (]: 3 of 3 ERROR creating sql incremental model silver.silver_listings ............. [[31mERROR[0m in 0.68s]
[0m16:55:58.938360 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:55:58.938956 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_listings' to be skipped because of status 'error'.  Reason: Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 143
  invalid identifier 'PRICE_PER_NIGHT_TAGGED'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql.
[0m16:55:58.941155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:58.941541 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:55:58.941829 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:55:59.026399 [info ] [MainThread]: 
[0m16:55:59.027191 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m16:55:59.028433 [debug] [MainThread]: Command end result
[0m16:55:59.052217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:55:59.062887 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:55:59.068488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:55:59.068708 [info ] [MainThread]: 
[0m16:55:59.068938 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:55:59.069117 [info ] [MainThread]: 
[0m16:55:59.069356 [error] [MainThread]: [31mFailure in model silver_listings (models/silver/silver_listings.sql)[0m
[0m16:55:59.069566 [error] [MainThread]:   Database Error in model silver_listings (models/silver/silver_listings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 143
  invalid identifier 'PRICE_PER_NIGHT_TAGGED'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m16:55:59.069734 [info ] [MainThread]: 
[0m16:55:59.069918 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_listings.sql
[0m16:55:59.070077 [info ] [MainThread]: 
[0m16:55:59.070245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m16:55:59.070590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3105354, "process_in_blocks": "0", "process_kernel_time": 0.796168, "process_mem_max_rss": "161316864", "process_out_blocks": "0", "process_user_time": 2.136051}
[0m16:55:59.070836 [debug] [MainThread]: Command `dbt run` failed at 16:55:59.070788 after 7.31 seconds
[0m16:55:59.071043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109472270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740d400>]}
[0m16:55:59.071232 [debug] [MainThread]: Flushing usage events
[0m16:56:00.330001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:58.220153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ba120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc83fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc24320>]}


============================== 16:58:58.225190 | 29183cfc-a61d-470c-b247-cf54eaa6f022 ==============================
[0m16:58:58.225190 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:58:58.225577 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'cache_selected_only': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select models/silver', 'log_cache_events': 'False'}
[0m16:58:59.251167 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:58:59.251574 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:58:59.251798 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:58:59.358489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc548f0>]}
[0m16:58:59.402781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3fd220>]}
[0m16:58:59.405484 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:58:59.476748 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:58:59.640231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:59.640462 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:58:59.640589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:59.657891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc54ef0>]}
[0m16:58:59.689664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:58:59.692362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:58:59.722963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee8e930>]}
[0m16:58:59.723176 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:58:59.723319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99a690>]}
[0m16:58:59.724862 [info ] [MainThread]: 
[0m16:58:59.724996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:59.725100 [info ] [MainThread]: 
[0m16:58:59.725291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:59.727011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:58:59.974414 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:58:59.974687 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:58:59.974885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:00.757575 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.782 seconds
[0m16:59:00.762985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:59:00.777654 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:59:00.778077 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:59:00.964670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m16:59:00.967556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:59:00.969436 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:59:00.969685 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:59:01.057182 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m16:59:01.059926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m16:59:01.062876 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:59:01.063171 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:59:01.272699 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.209 seconds
[0m16:59:01.277562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac6300>]}
[0m16:59:01.288385 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:01.289491 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:59:01.290821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:59:01.291364 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:01.301917 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.304444 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:01.338698 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.338964 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:01.681738 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m16:59:01.696337 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.696827 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:01.770661 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.073 seconds
[0m16:59:01.777383 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.777972 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:01.876498 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.098 seconds
[0m16:59:01.889884 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.890315 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:01.957520 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m16:59:01.991710 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.995143 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:01.995396 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:02.195184 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m16:59:02.196458 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:02.197241 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:02.895751 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.697 seconds
[0m16:59:02.897431 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:02.897905 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:03.087251 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m16:59:03.101027 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:59:03.107696 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:03.108045 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:03.245359 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m16:59:03.274809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf0d190>]}
[0m16:59:03.275468 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.98s]
[0m16:59:03.275986 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:03.276329 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:03.276799 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:59:03.277199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:59:03.277496 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:03.279925 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.283015 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:03.285859 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.286137 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:03.482649 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m16:59:03.488775 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.489502 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:03.593279 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.103 seconds
[0m16:59:03.599376 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.599877 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:03.659529 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m16:59:03.667065 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.667757 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:03.732666 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m16:59:03.739561 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.744821 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.745323 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:03.817416 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m16:59:03.818843 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:03.819938 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:04.448495 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.628 seconds
[0m16:59:04.449487 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:04.450117 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:04.664300 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m16:59:04.672542 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:59:04.673667 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:04.674053 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:04.815181 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:59:04.819362 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11583d7c0>]}
[0m16:59:04.820330 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.54s]
[0m16:59:04.821054 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:04.821535 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:04.822296 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:59:04.822974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:59:04.823371 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:04.827767 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:04.831663 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:04.834801 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:04.835311 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:05.011535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m16:59:05.017925 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.018513 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:05.112737 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.094 seconds
[0m16:59:05.119887 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.120456 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:05.236411 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.115 seconds
[0m16:59:05.244135 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.244778 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:05.312991 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.068 seconds
[0m16:59:05.321014 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.326781 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.327358 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:05.425338 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m16:59:05.426753 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.427843 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:05.984807 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.556 seconds
[0m16:59:05.986274 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:05.986809 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:06.173263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m16:59:06.177226 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:59:06.178306 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:06.178917 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:06.290430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:59:06.294860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29183cfc-a61d-470c-b247-cf54eaa6f022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115829ac0>]}
[0m16:59:06.295927 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.47s]
[0m16:59:06.296753 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:06.299176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:06.299621 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:59:06.300017 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:59:06.389515 [info ] [MainThread]: 
[0m16:59:06.390278 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m16:59:06.391462 [debug] [MainThread]: Command end result
[0m16:59:06.414750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:59:06.425013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:59:06.430379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:59:06.430603 [info ] [MainThread]: 
[0m16:59:06.430842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:06.431027 [info ] [MainThread]: 
[0m16:59:06.431220 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:59:06.431620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.284336, "process_in_blocks": "0", "process_kernel_time": 0.909576, "process_mem_max_rss": "160874496", "process_out_blocks": "0", "process_user_time": 2.221228}
[0m16:59:06.431908 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:06.431852 after 8.28 seconds
[0m16:59:06.432137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ba120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad60c0>]}
[0m16:59:06.432361 [debug] [MainThread]: Flushing usage events
[0m16:59:07.540226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:16.963590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b77fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b77fe0>]}


============================== 16:59:16.969093 | 0345f1d1-bad9-43be-9096-406c3f946800 ==============================
[0m16:59:16.969093 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:59:16.969452 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/gold'}
[0m16:59:18.130797 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:59:18.132131 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:59:18.132761 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:59:18.289591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ada30>]}
[0m16:59:18.332681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ee240>]}
[0m16:59:18.335205 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:59:18.405917 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:59:18.571084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:18.571317 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:59:18.571444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:18.588467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2ffb0>]}
[0m16:59:18.620177 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:59:18.622728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:59:18.653262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae054f0>]}
[0m16:59:18.653520 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:59:18.653667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa11fa0>]}
[0m16:59:18.655410 [info ] [MainThread]: 
[0m16:59:18.655614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:18.655788 [info ] [MainThread]: 
[0m16:59:18.656053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:18.656516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:59:18.900604 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:59:18.900825 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:59:18.900960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:19.584749 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.684 seconds
[0m16:59:19.595563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m16:59:19.609871 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:59:19.610342 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:59:19.703263 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.092 seconds
[0m16:59:19.707707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_dbt_schema)
[0m16:59:19.712818 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:59:19.713332 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:59:19.784602 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.071 seconds
[0m16:59:19.788244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m16:59:19.791757 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:59:19.792211 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:59:19.873516 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.081 seconds
[0m16:59:19.875663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae04980>]}
[0m16:59:19.879644 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:59:19.880011 [info ] [Thread-2 (]: 1 of 1 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:59:19.880305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m16:59:19.880526 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:59:19.887517 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:59:19.888935 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:59:19.906271 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:59:19.908360 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:59:19.908602 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:59:20.086494 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m16:59:20.117453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0345f1d1-bad9-43be-9096-406c3f946800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e05340>]}
[0m16:59:20.118024 [info ] [Thread-2 (]: 1 of 1 OK created sql view model dbt_schema.obt ................................ [[32mSUCCESS 1[0m in 0.23s]
[0m16:59:20.118442 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:59:20.119257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:20.119438 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.obt' was left open.
[0m16:59:20.119603 [debug] [MainThread]: On model.dbt_snowflake_aws_project.obt: Close
[0m16:59:20.191945 [info ] [MainThread]: 
[0m16:59:20.192490 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m16:59:20.193215 [debug] [MainThread]: Command end result
[0m16:59:20.214107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:59:20.224096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:59:20.229608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:59:20.229812 [info ] [MainThread]: 
[0m16:59:20.230036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:20.230198 [info ] [MainThread]: 
[0m16:59:20.230370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:59:20.230740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3382561, "process_in_blocks": "0", "process_kernel_time": 0.900072, "process_mem_max_rss": "158826496", "process_out_blocks": "0", "process_user_time": 1.962905}
[0m16:59:20.231008 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:20.230958 after 3.34 seconds
[0m16:59:20.231231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac33f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acf82c0>]}
[0m16:59:20.231432 [debug] [MainThread]: Flushing usage events
[0m16:59:21.446980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:41.395959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc248f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d115490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d115400>]}


============================== 16:59:41.400947 | 88009637-46bd-4759-9a65-ba77c8980d64 ==============================
[0m16:59:41.400947 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:59:41.401313 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_colors': 'True', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80'}
[0m16:59:42.457001 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:59:42.457343 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:59:42.457527 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:59:42.573791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beecd70>]}
[0m16:59:42.618278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8077d0>]}
[0m16:59:42.620837 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m16:59:42.690247 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:59:42.828296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:42.828519 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:59:42.828632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:42.845114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebae150>]}
[0m16:59:42.877195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:59:42.879635 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:59:42.902608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b5370>]}
[0m16:59:42.902811 [info ] [MainThread]: Found 7 models, 3 analyses, 3 sources, 526 macros
[0m16:59:42.902954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de59fd0>]}
[0m16:59:42.903794 [info ] [MainThread]: 
[0m16:59:42.903940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:42.904048 [info ] [MainThread]: 
[0m16:59:42.904246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:42.906025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m16:59:43.135627 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:59:43.135906 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:59:43.136086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:43.959761 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.823 seconds
[0m16:59:43.968448 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:59:43.969155 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:59:44.044102 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.074 seconds
[0m16:59:44.048912 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m16:59:44.049278 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m16:59:44.112740 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.063 seconds
[0m16:59:44.114611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_dbt_schema)
[0m16:59:44.122503 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m16:59:44.122752 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m16:59:44.197749 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:59:44.199637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_silver)
[0m16:59:44.202377 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m16:59:44.202675 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m16:59:44.282028 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m16:59:44.285858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m16:59:44.290919 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m16:59:44.291373 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m16:59:44.378440 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m16:59:44.382396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed47380>]}
[0m16:59:44.390904 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m16:59:44.391616 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m16:59:44.392179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m16:59:44.393006 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m16:59:44.401074 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m16:59:44.404575 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m16:59:44.423842 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m16:59:44.426958 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m16:59:44.427171 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m16:59:44.597117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m16:59:44.623270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94d4c0>]}
[0m16:59:44.623748 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.23s]
[0m16:59:44.624125 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m16:59:44.624369 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m16:59:44.624747 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m16:59:44.625138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m16:59:44.625359 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m16:59:44.627148 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m16:59:44.628961 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m16:59:44.631863 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m16:59:44.633564 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m16:59:44.633796 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m16:59:44.791502 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m16:59:44.794118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158bb620>]}
[0m16:59:44.794996 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.17s]
[0m16:59:44.795610 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m16:59:44.796011 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m16:59:44.796581 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m16:59:44.797211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m16:59:44.797663 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m16:59:44.800490 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m16:59:44.802003 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m16:59:44.804306 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m16:59:44.806051 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m16:59:44.806307 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m16:59:44.953527 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m16:59:44.958604 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa86b0>]}
[0m16:59:44.959339 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.16s]
[0m16:59:44.959834 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m16:59:44.960162 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m16:59:44.960614 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_schema.obt ..................................... [RUN]
[0m16:59:44.961086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m16:59:44.961364 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m16:59:44.966831 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m16:59:44.979261 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m16:59:44.981145 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m16:59:44.993813 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m16:59:44.994162 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace   view AIRBNB_PRO.dbt_schema.obt
  
  
  
  
  as (
    

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m16:59:45.192682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m16:59:45.196602 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff1cf20>]}
[0m16:59:45.197367 [info ] [Thread-2 (]: 4 of 7 OK created sql view model dbt_schema.obt ................................ [[32mSUCCESS 1[0m in 0.24s]
[0m16:59:45.197947 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m16:59:45.198356 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:45.199015 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m16:59:45.199531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m16:59:45.199893 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:45.204317 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.219804 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:45.247246 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.247499 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:45.431223 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:59:45.445196 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.445624 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:45.517733 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m16:59:45.524517 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.525026 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:45.587713 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.062 seconds
[0m16:59:45.602984 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.603489 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:45.668177 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.064 seconds
[0m16:59:45.705195 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.714798 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.715054 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:45.794416 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:59:45.795274 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:45.795778 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m16:59:46.433152 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.637 seconds
[0m16:59:46.434567 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:46.435291 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:46.591452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m16:59:46.603219 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m16:59:46.608611 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m16:59:46.608893 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m16:59:46.704315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:59:46.708290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f40e0>]}
[0m16:59:46.709371 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.51s]
[0m16:59:46.710262 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m16:59:46.710866 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:46.711637 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m16:59:46.712247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m16:59:46.712690 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:46.717259 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:46.732802 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:46.736425 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:46.736729 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:46.927313 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m16:59:46.932922 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:46.933475 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:47.006373 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.072 seconds
[0m16:59:47.012134 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.012582 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:47.077244 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m16:59:47.087993 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.088537 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:47.147025 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.058 seconds
[0m16:59:47.153166 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.165428 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.165890 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:47.266071 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m16:59:47.267483 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.268552 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m16:59:47.882643 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.613 seconds
[0m16:59:47.883672 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:47.884199 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:48.078954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m16:59:48.085121 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m16:59:48.085919 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m16:59:48.086239 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m16:59:48.185831 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m16:59:48.190020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115969670>]}
[0m16:59:48.191035 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.48s]
[0m16:59:48.191836 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m16:59:48.192368 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:48.192909 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m16:59:48.193449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m16:59:48.193854 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:48.198785 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.214237 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:48.217121 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.217414 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:48.382307 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m16:59:48.389102 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.389858 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:48.464028 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.073 seconds
[0m16:59:48.470541 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.471073 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:48.533940 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.062 seconds
[0m16:59:48.540379 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.540782 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:48.601792 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.060 seconds
[0m16:59:48.610189 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.622801 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.623354 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:48.698150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m16:59:48.699559 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:48.700280 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m16:59:49.240972 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.540 seconds
[0m16:59:49.242745 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:49.243853 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:49.428424 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:59:49.435272 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m16:59:49.436656 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m16:59:49.437190 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m16:59:49.531155 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m16:59:49.534868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88009637-46bd-4759-9a65-ba77c8980d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f40e0>]}
[0m16:59:49.535751 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.34s]
[0m16:59:49.536510 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m16:59:49.537965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:49.538353 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m16:59:49.538652 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m16:59:49.640685 [info ] [MainThread]: 
[0m16:59:49.641387 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m16:59:49.643113 [debug] [MainThread]: Command end result
[0m16:59:49.666769 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m16:59:49.674525 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m16:59:49.680388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m16:59:49.680612 [info ] [MainThread]: 
[0m16:59:49.680848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:49.681024 [info ] [MainThread]: 
[0m16:59:49.681218 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m16:59:49.681624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.354086, "process_in_blocks": "0", "process_kernel_time": 0.93882, "process_mem_max_rss": "161218560", "process_out_blocks": "0", "process_user_time": 2.305755}
[0m16:59:49.681901 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:49.681849 after 8.35 seconds
[0m16:59:49.682125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc248f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a82c0>]}
[0m16:59:49.682348 [debug] [MainThread]: Flushing usage events
[0m16:59:51.245852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:18.153561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac95190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43c170>]}


============================== 17:15:18.157307 | 9c972b4b-a07a-43c8-9de8-2e0cacc9896b ==============================
[0m17:15:18.157307 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:15:18.157590 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:15:18.225286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c972b4b-a07a-43c8-9de8-2e0cacc9896b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4eba10>]}
[0m17:15:18.258677 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:18.260149 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:18.260421 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18570545, "process_in_blocks": "0", "process_kernel_time": 0.259416, "process_mem_max_rss": "111755264", "process_out_blocks": "0", "process_user_time": 0.797916}
[0m17:15:18.260621 [debug] [MainThread]: Command `cli deps` succeeded at 17:15:18.260579 after 0.19 seconds
[0m17:15:18.260760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d534f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43c260>]}
[0m17:15:18.260898 [debug] [MainThread]: Flushing usage events
[0m17:15:19.251278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:40.627379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af84ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7300e0>]}


============================== 17:15:40.632419 | 2a41e94c-ecb9-49ff-9de2-0975ab25f0bb ==============================
[0m17:15:40.632419 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:15:40.632774 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80'}
[0m17:15:41.318681 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:15:41.319141 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:15:41.319445 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:15:41.454951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a41e94c-ecb9-49ff-9de2-0975ab25f0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d2a20>]}
[0m17:15:41.502478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a41e94c-ecb9-49ff-9de2-0975ab25f0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf63c0>]}
[0m17:15:41.505560 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m17:15:41.576963 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:15:41.748491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m17:15:41.748795 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/hosts.sql
[0m17:15:41.748939 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/bookings.sql
[0m17:15:41.749059 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/listings.sql
[0m17:15:41.816484 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "hosts".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("hosts").
  
  To fix this, change the name of one of these resources:
  - model.dbt_snowflake_aws_project.hosts (models/gold/ephemeral/hosts.sql)
  - model.dbt_snowflake_aws_project.hosts (models/bronze/hosts.sql)
[0m17:15:41.816873 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.2601472, "process_in_blocks": "0", "process_kernel_time": 0.547613, "process_mem_max_rss": "144474112", "process_out_blocks": "0", "process_user_time": 1.389646}
[0m17:15:41.817102 [debug] [MainThread]: Command `dbt compile` failed at 17:15:41.817059 after 1.26 seconds
[0m17:15:41.817270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7301a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca49340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df59a00>]}
[0m17:15:41.817411 [debug] [MainThread]: Flushing usage events
[0m17:15:43.060447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:45.103343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bec0>]}


============================== 17:16:45.108373 | ceeb693d-2563-4f69-9173-72911efcf60d ==============================
[0m17:16:45.108373 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:16:45.108727 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'empty': 'False'}
[0m17:16:46.171906 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m17:16:46.173063 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m17:16:46.173627 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m17:16:46.324849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9220>]}
[0m17:16:46.368393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a413950>]}
[0m17:16:46.371284 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m17:16:46.455270 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:16:46.596234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m17:16:46.596547 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/host.sql
[0m17:16:46.596687 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/booking.sql
[0m17:16:46.596799 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://models/gold/ephemeral/listing.sql
[0m17:16:46.694183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0f8f0>]}
[0m17:16:46.727780 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m17:16:46.734256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m17:16:46.788407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a909280>]}
[0m17:16:46.788669 [info ] [MainThread]: Found 10 models, 3 analyses, 3 sources, 526 macros
[0m17:16:46.788831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b839e0>]}
[0m17:16:46.789825 [info ] [MainThread]: 
[0m17:16:46.789978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:46.790089 [info ] [MainThread]: 
[0m17:16:46.790309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:46.792289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_gold'
[0m17:16:47.046924 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m17:16:47.047131 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m17:16:47.047247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:47.883972 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c213a2-0001-88f0-000c-0f16000347da
[0m17:16:47.884862 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:16:47.886048 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:16:47.887208 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:47.888240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m17:16:47.892560 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m17:16:47.893006 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m17:16:48.193662 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.300 seconds
[0m17:16:48.197623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m17:16:48.201749 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m17:16:48.202257 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m17:16:48.294188 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.091 seconds
[0m17:16:48.299919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceeb693d-2563-4f69-9173-72911efcf60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a707fe0>]}
[0m17:16:48.311207 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m17:16:48.312002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m17:16:48.312517 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m17:16:48.321215 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m17:16:48.324630 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m17:16:48.325360 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m17:16:48.325743 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m17:16:48.326259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m17:16:48.326736 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m17:16:48.329284 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m17:16:48.332479 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m17:16:48.333010 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m17:16:48.333315 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m17:16:48.333657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m17:16:48.333970 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m17:16:48.336260 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m17:16:48.339303 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m17:16:48.339776 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m17:16:48.340043 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m17:16:48.340334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m17:16:48.340601 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m17:16:48.344875 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m17:16:48.347844 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m17:16:48.348247 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m17:16:48.348501 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m17:16:48.348776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now analysis.dbt_snowflake_aws_project.if_else_jinja)
[0m17:16:48.349068 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m17:16:48.351599 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.if_else_jinja"
[0m17:16:48.354327 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m17:16:48.354666 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m17:16:48.354875 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m17:16:48.355092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.if_else_jinja, now analysis.dbt_snowflake_aws_project.incremental_load_m)
[0m17:16:48.355283 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m17:16:48.358094 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.incremental_load_m"
[0m17:16:48.360124 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m17:16:48.360459 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m17:16:48.360662 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.ref
[0m17:16:48.360874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.incremental_load_m, now analysis.dbt_snowflake_aws_project.ref)
[0m17:16:48.361060 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.ref
[0m17:16:48.362761 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.ref"
[0m17:16:48.364433 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.ref
[0m17:16:48.364758 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.ref
[0m17:16:48.364968 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m17:16:48.365184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.ref, now model.dbt_snowflake_aws_project.silver_bookings)
[0m17:16:48.365372 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m17:16:48.369245 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m17:16:48.370968 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m17:16:48.371294 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m17:16:48.371498 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m17:16:48.371704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m17:16:48.371895 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m17:16:48.373558 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m17:16:48.384654 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m17:16:48.384980 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m17:16:48.385183 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m17:16:48.385389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m17:16:48.385579 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m17:16:48.387811 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m17:16:48.391368 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m17:16:48.391697 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m17:16:48.391901 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking
[0m17:16:48.392104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_listings, now model.dbt_snowflake_aws_project.booking)
[0m17:16:48.392292 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking
[0m17:16:48.393917 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking"
[0m17:16:48.398689 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking
[0m17:16:48.398895 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host
[0m17:16:48.399102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking, now model.dbt_snowflake_aws_project.host)
[0m17:16:48.399287 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host
[0m17:16:48.400896 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host"
[0m17:16:48.410206 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host
[0m17:16:48.410410 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing
[0m17:16:48.410629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host, now model.dbt_snowflake_aws_project.listing)
[0m17:16:48.410850 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing
[0m17:16:48.412718 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing"
[0m17:16:48.414249 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing
[0m17:16:48.414932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:48.415143 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing' was left open.
[0m17:16:48.415481 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing: Close
[0m17:16:48.515631 [debug] [MainThread]: Command end result
[0m17:16:48.537664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m17:16:48.542291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m17:16:48.548877 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m17:16:48.549358 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.5183365, "process_in_blocks": "0", "process_kernel_time": 0.923329, "process_mem_max_rss": "164036608", "process_out_blocks": "0", "process_user_time": 1.99102}
[0m17:16:48.549657 [debug] [MainThread]: Command `dbt compile` succeeded at 17:16:48.549599 after 3.52 seconds
[0m17:16:48.549898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9742c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bfe0>]}
[0m17:16:48.550109 [debug] [MainThread]: Flushing usage events
[0m17:16:49.582156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:44.718531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101babdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109251550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109251640>]}


============================== 17:17:44.723843 | 060deaf0-a488-4728-a5ae-d449481014a9 ==============================
[0m17:17:44.723843 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:17:44.724128 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'use_colors': 'True', 'empty': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None'}
[0m17:17:44.786466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060deaf0-a488-4728-a5ae-d449481014a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ca180>]}
[0m17:17:44.847877 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17968024, "process_in_blocks": "0", "process_kernel_time": 0.350252, "process_mem_max_rss": "112295936", "process_out_blocks": "0", "process_user_time": 0.834707}
[0m17:17:44.848081 [debug] [MainThread]: Command `dbt clean` succeeded at 17:17:44.848045 after 0.18 seconds
[0m17:17:44.848226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101babdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09bc80>]}
[0m17:17:44.848365 [debug] [MainThread]: Flushing usage events
[0m17:17:46.143413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:00.960773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4abfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4abdd0>]}


============================== 18:03:00.967011 | 5f236949-35d6-4e70-814e-e1bd5a829568 ==============================
[0m18:03:00.967011 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:00.967394 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False'}
[0m18:03:02.062127 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:03:02.063441 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:03:02.063964 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:03:02.215775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f236949-35d6-4e70-814e-e1bd5a829568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be17b00>]}
[0m18:03:02.260228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f236949-35d6-4e70-814e-e1bd5a829568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b90a0>]}
[0m18:03:02.262479 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:03:02.335074 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:03:02.336661 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:03:02.336818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f236949-35d6-4e70-814e-e1bd5a829568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1700>]}
[0m18:03:02.455011 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m18:03:02.455282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f236949-35d6-4e70-814e-e1bd5a829568', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e6900>]}
[0m18:03:03.005541 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_snowflake_aws_project.dim_bookings' (snapshots/dim_bookings.yml) depends on a node named 'booking_emphemeral_source' which was not found
[0m18:03:03.005893 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:03.006185 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.122389, "process_in_blocks": "0", "process_kernel_time": 0.844589, "process_mem_max_rss": "150159360", "process_out_blocks": "0", "process_user_time": 2.00232}
[0m18:03:03.006344 [debug] [MainThread]: Command `dbt snapshot` failed at 18:03:03.006313 after 2.12 seconds
[0m18:03:03.006480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c904110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c91d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54e6c0>]}
[0m18:03:03.006602 [debug] [MainThread]: Flushing usage events
[0m18:03:04.189616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:54.676192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108600800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a5580>]}


============================== 18:03:54.681338 | 19d39f31-c839-428f-86fa-ac6703b3ce92 ==============================
[0m18:03:54.681338 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:54.681681 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'False'}
[0m18:03:55.855666 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:03:55.857191 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:03:55.857938 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:03:56.020552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19d39f31-c839-428f-86fa-ac6703b3ce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f911f0>]}
[0m18:03:56.063519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19d39f31-c839-428f-86fa-ac6703b3ce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07d0d0>]}
[0m18:03:56.066946 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:03:56.140663 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:03:56.143123 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:03:56.143286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19d39f31-c839-428f-86fa-ac6703b3ce92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07cda0>]}
[0m18:03:56.261743 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m18:03:56.262002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '19d39f31-c839-428f-86fa-ac6703b3ce92', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07ce90>]}
[0m18:03:56.818984 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_snowflake_aws_project.dim_bookings' (snapshots/dim_bookings.yml) depends on a node named 'booking_emphemeral_source' which was not found
[0m18:03:56.819343 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:56.819651 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.2142024, "process_in_blocks": "0", "process_kernel_time": 0.836794, "process_mem_max_rss": "151404544", "process_out_blocks": "0", "process_user_time": 2.004121}
[0m18:03:56.819837 [debug] [MainThread]: Command `dbt snapshot` failed at 18:03:56.819802 after 2.21 seconds
[0m18:03:56.819986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b55e0>]}
[0m18:03:56.820129 [debug] [MainThread]: Flushing usage events
[0m18:03:57.818394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:58.280061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5314c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a531430>]}


============================== 18:04:58.285023 | 75ea7fd0-746b-4b48-8ef4-0709e9953c18 ==============================
[0m18:04:58.285023 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:58.285392 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt compile', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:59.131417 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:04:59.132709 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:04:59.133332 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:04:59.296025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108badf40>]}
[0m18:04:59.338738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54a240>]}
[0m18:04:59.341303 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:04:59.406513 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:04:59.408449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:04:59.408612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b090e60>]}
[0m18:04:59.524068 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m18:04:59.524325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2acb90>]}
[0m18:05:00.104972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d408f0>]}
[0m18:05:00.142060 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:05:00.147480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:05:00.191678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c694c20>]}
[0m18:05:00.191884 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:05:00.192021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac9940>]}
[0m18:05:00.192922 [info ] [MainThread]: 
[0m18:05:00.193055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:00.193152 [info ] [MainThread]: 
[0m18:05:00.193335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:05:00.195196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_semi_raw'
[0m18:05:00.456680 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:05:00.456878 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:05:00.456986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:01.490946 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.034 seconds
[0m18:05:01.492950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m18:05:01.495449 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:05:01.495731 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:05:02.250423 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.754 seconds
[0m18:05:02.255041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m18:05:02.260775 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:05:02.261273 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:05:02.422868 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c213d3-0001-88b7-000c-0f1600037632
[0m18:05:02.423625 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:05:02.424234 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:05:02.424578 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:05:02.425286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_gold)
[0m18:05:02.429205 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:05:02.429804 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:05:02.531541 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c213d3-0001-88f0-000c-0f16000347e6
[0m18:05:02.532452 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:05:02.533178 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:05:02.533673 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:05:02.534912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ea7fd0-746b-4b48-8ef4-0709e9953c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c433cb0>]}
[0m18:05:02.547564 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m18:05:02.548592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now model.dbt_snowflake_aws_project.bookings)
[0m18:05:02.549225 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m18:05:02.561182 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m18:05:02.568192 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m18:05:02.568903 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m18:05:02.569295 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m18:05:02.569846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m18:05:02.570440 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m18:05:02.573081 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m18:05:02.574992 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m18:05:02.575547 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m18:05:02.575870 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m18:05:02.576220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m18:05:02.576582 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m18:05:02.579041 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m18:05:02.580944 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m18:05:02.581472 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m18:05:02.581778 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:05:02.582115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m18:05:02.582417 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:05:02.587208 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:05:02.590669 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:05:02.591088 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:05:02.591343 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m18:05:02.591615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now analysis.dbt_snowflake_aws_project.if_else_jinja)
[0m18:05:02.591884 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m18:05:02.594478 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.if_else_jinja"
[0m18:05:02.597010 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m18:05:02.597407 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.if_else_jinja
[0m18:05:02.597651 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m18:05:02.597909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.if_else_jinja, now analysis.dbt_snowflake_aws_project.incremental_load_m)
[0m18:05:02.598134 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m18:05:02.601220 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.incremental_load_m"
[0m18:05:02.603008 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m18:05:02.603339 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.incremental_load_m
[0m18:05:02.603545 [debug] [Thread-2 (]: Began running node analysis.dbt_snowflake_aws_project.ref
[0m18:05:02.603765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.incremental_load_m, now analysis.dbt_snowflake_aws_project.ref)
[0m18:05:02.603954 [debug] [Thread-2 (]: Began compiling node analysis.dbt_snowflake_aws_project.ref
[0m18:05:02.605633 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_snowflake_aws_project.ref"
[0m18:05:02.606954 [debug] [Thread-2 (]: Began executing node analysis.dbt_snowflake_aws_project.ref
[0m18:05:02.607279 [debug] [Thread-2 (]: Finished running node analysis.dbt_snowflake_aws_project.ref
[0m18:05:02.607494 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:02.607707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_snowflake_aws_project.ref, now model.dbt_snowflake_aws_project.silver_bookings)
[0m18:05:02.607901 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:02.609810 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:02.612255 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:02.612591 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:02.612797 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:02.613005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m18:05:02.613198 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:02.614901 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:02.616105 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:02.616430 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:02.616634 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:02.616839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m18:05:02.617027 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:02.618883 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:02.619957 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:02.620277 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:02.620477 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:02.620684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_listings, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m18:05:02.620873 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:02.622482 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m18:05:02.624468 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:02.624674 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:02.624888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m18:05:02.625121 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:02.628214 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m18:05:02.629446 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:02.629643 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:02.629882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m18:05:02.630060 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:02.631607 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m18:05:02.632757 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:02.632950 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:05:02.633164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listing_ephemeral_source, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m18:05:02.633340 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:05:02.635011 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:05:02.635327 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:05:02.635509 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:05:02.635700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m18:05:02.635878 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:05:02.637392 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:05:02.637699 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:05:02.637879 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:05:02.638066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m18:05:02.638235 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:05:02.639597 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:05:02.639877 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:05:02.640370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:02.640515 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m18:05:02.640655 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m18:05:02.743759 [debug] [MainThread]: Command end result
[0m18:05:02.769243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:05:02.775374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:05:02.781454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:05:02.781804 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:05:02.782189 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.574335, "process_in_blocks": "0", "process_kernel_time": 0.822831, "process_mem_max_rss": "168329216", "process_out_blocks": "0", "process_user_time": 2.370665}
[0m18:05:02.782439 [debug] [MainThread]: Command `dbt compile` succeeded at 18:05:02.782388 after 4.57 seconds
[0m18:05:02.782638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7786e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b243d10>]}
[0m18:05:02.782841 [debug] [MainThread]: Flushing usage events
[0m18:05:03.980650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:44.270182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109044bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7fb0>]}


============================== 18:05:44.274986 | d701f9d6-3cb3-4f65-ac96-2858e0916ed1 ==============================
[0m18:05:44.274986 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:44.275345 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False'}
[0m18:05:45.213129 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:05:45.213514 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:05:45.213714 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:05:45.328689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931b1a0>]}
[0m18:05:45.371771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc7740>]}
[0m18:05:45.374363 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:05:45.443325 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:05:45.608609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:45.608835 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:05:45.608959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:45.630069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a758080>]}
[0m18:05:45.666146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:05:45.668456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:05:45.691157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab97800>]}
[0m18:05:45.691373 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:05:45.691519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d8590>]}
[0m18:05:45.692365 [info ] [MainThread]: 
[0m18:05:45.692500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:45.692606 [info ] [MainThread]: 
[0m18:05:45.692805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:05:45.694520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:05:45.946297 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:05:45.946500 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:05:45.946612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:46.893485 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.947 seconds
[0m18:05:46.896271 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:05:46.896515 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:05:46.969921 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.073 seconds
[0m18:05:46.973715 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:05:46.974092 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:05:47.063536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.089 seconds
[0m18:05:47.067044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_gold)
[0m18:05:47.067899 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "gold"
"
[0m18:05:47.074763 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_gold"
[0m18:05:47.075221 [debug] [ThreadPool]: On create_AIRBNB_PRO_gold: create schema if not exists AIRBNB_PRO.gold
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_gold"} */
[0m18:05:47.162147 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m18:05:47.166180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_gold, now list_AIRBNB_gold)
[0m18:05:47.180233 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:05:47.180609 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:05:47.262426 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c213d3-0001-8904-000c-0f16000357a2
[0m18:05:47.263339 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:05:47.264210 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:05:47.264741 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:05:47.265694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m18:05:47.270236 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:05:47.270909 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:05:47.369089 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.098 seconds
[0m18:05:47.373715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m18:05:47.377145 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:05:47.377502 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:05:47.446823 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.069 seconds
[0m18:05:47.449816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m18:05:47.453500 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:05:47.453947 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:05:47.552958 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.098 seconds
[0m18:05:47.557786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9da690>]}
[0m18:05:47.566135 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m18:05:47.566695 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m18:05:47.567154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m18:05:47.567500 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m18:05:47.576438 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m18:05:47.579557 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m18:05:47.598277 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m18:05:47.604156 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m18:05:47.604370 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m18:05:47.808078 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m18:05:47.840584 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c41040>]}
[0m18:05:47.841168 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.27s]
[0m18:05:47.841602 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m18:05:47.841893 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m18:05:47.842280 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m18:05:47.842685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m18:05:47.842949 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m18:05:47.845116 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m18:05:47.847820 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m18:05:47.849674 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m18:05:47.851570 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m18:05:47.851789 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m18:05:48.115284 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m18:05:48.119753 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb6f320>]}
[0m18:05:48.120810 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.28s]
[0m18:05:48.121558 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m18:05:48.122093 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m18:05:48.122702 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m18:05:48.123337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m18:05:48.123785 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m18:05:48.128147 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m18:05:48.132114 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m18:05:48.134912 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m18:05:48.137271 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m18:05:48.137834 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m18:05:48.526899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m18:05:48.530990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba1640>]}
[0m18:05:48.532024 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.41s]
[0m18:05:48.532716 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m18:05:48.533201 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:05:48.533919 [info ] [Thread-2 (]: 4 of 7 START sql table model gold.obt .......................................... [RUN]
[0m18:05:48.534491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m18:05:48.534887 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:05:48.542100 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:05:48.545593 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:05:48.563851 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m18:05:48.567656 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m18:05:48.567933 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m18:05:50.263176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.695 seconds
[0m18:05:50.264397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb0b90>]}
[0m18:05:50.264779 [info ] [Thread-2 (]: 4 of 7 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.73s]
[0m18:05:50.265084 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:05:50.265289 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:50.265588 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m18:05:50.265911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m18:05:50.266103 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:50.268778 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.271303 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:50.293660 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.293943 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:05:50.470477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m18:05:50.481302 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.481702 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:05:50.561356 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.079 seconds
[0m18:05:50.569725 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.570499 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:05:50.637983 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m18:05:50.651923 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.652372 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:05:50.723798 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m18:05:50.752180 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.755663 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.755889 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:05:50.845629 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m18:05:50.846373 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:50.846825 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:05:51.564566 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.717 seconds
[0m18:05:51.565791 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:51.566438 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:05:51.726085 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m18:05:51.743962 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m18:05:51.750527 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:05:51.750889 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:05:51.849756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m18:05:51.852868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba631a0>]}
[0m18:05:51.853970 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.59s]
[0m18:05:51.854910 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:05:51.855569 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:51.856379 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m18:05:51.857214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m18:05:51.857819 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:51.863691 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:51.867616 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:51.872192 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:51.872641 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:05:52.096227 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m18:05:52.099499 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.099907 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:05:52.193795 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.093 seconds
[0m18:05:52.200402 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.200992 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:05:52.262666 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.061 seconds
[0m18:05:52.268586 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.269087 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:05:52.343083 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.073 seconds
[0m18:05:52.350789 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.355438 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.356011 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:05:52.448129 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m18:05:52.449230 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:52.449985 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:05:53.035018 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.584 seconds
[0m18:05:53.036185 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:53.036731 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:05:53.203336 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m18:05:53.209437 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m18:05:53.210735 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:05:53.211148 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:05:53.312117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m18:05:53.315969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba2960>]}
[0m18:05:53.316824 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.46s]
[0m18:05:53.317490 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:05:53.318332 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:53.319018 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m18:05:53.319592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m18:05:53.319973 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:53.324589 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.328392 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:53.333145 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.333530 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:05:53.545113 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m18:05:53.551855 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.552626 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:05:53.630578 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m18:05:53.638266 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.638862 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:05:53.708571 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.069 seconds
[0m18:05:53.716075 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.716643 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:05:53.793412 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m18:05:53.800278 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.804451 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.804853 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:05:53.883735 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m18:05:53.885187 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:53.885767 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:05:54.464526 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.578 seconds
[0m18:05:54.465941 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:54.466582 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:05:54.633015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m18:05:54.638696 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m18:05:54.639948 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:05:54.640456 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:05:54.748656 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m18:05:54.752864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd701f9d6-3cb3-4f65-ac96-2858e0916ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc42f30>]}
[0m18:05:54.754071 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.43s]
[0m18:05:54.755078 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m18:05:54.755758 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:54.756459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_listings, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m18:05:54.756985 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:54.762194 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m18:05:54.766034 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:05:54.766500 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:54.766971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m18:05:54.767362 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:54.770807 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m18:05:54.772953 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:05:54.773270 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:54.773617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m18:05:54.773943 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:54.776413 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m18:05:54.778062 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:05:54.778946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:54.779204 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m18:05:54.779417 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m18:05:54.865394 [info ] [MainThread]: 
[0m18:05:54.866175 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 3 view models in 0 hours 0 minutes and 9.17 seconds (9.17s).
[0m18:05:54.867801 [debug] [MainThread]: Command end result
[0m18:05:54.959607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:05:54.966920 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:05:54.973580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:05:54.973827 [info ] [MainThread]: 
[0m18:05:54.974089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:54.974294 [info ] [MainThread]: 
[0m18:05:54.974523 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:05:54.975001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.772988, "process_in_blocks": "0", "process_kernel_time": 0.885153, "process_mem_max_rss": "161972224", "process_out_blocks": "0", "process_user_time": 2.387795}
[0m18:05:54.975330 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:54.975263 after 10.77 seconds
[0m18:05:54.975601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a613c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7d40>]}
[0m18:05:54.975858 [debug] [MainThread]: Flushing usage events
[0m18:05:56.331914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:02.122529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109467350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2ff20>]}


============================== 18:06:02.126477 | a22425ec-145e-4830-9dbf-320e2fb271f3 ==============================
[0m18:06:02.126477 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:02.126797 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt snapshot', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs'}
[0m18:06:02.666186 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:06:02.667457 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:06:02.668125 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:06:02.813865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5e30e0>]}
[0m18:06:02.856902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38d160>]}
[0m18:06:02.859555 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:06:02.928497 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:06:03.095917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:03.096151 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:06:03.096267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:03.117688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d769f0>]}
[0m18:06:03.153849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:06:03.157352 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:06:03.193468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10addeb70>]}
[0m18:06:03.193684 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:06:03.193823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bf500>]}
[0m18:06:03.194675 [info ] [MainThread]: 
[0m18:06:03.194811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:03.194916 [info ] [MainThread]: 
[0m18:06:03.195111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:03.196818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:06:03.475397 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:06:03.475625 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m18:06:03.475739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:04.081865 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.606 seconds
[0m18:06:04.086018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO)
[0m18:06:04.090675 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:06:04.091176 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:06:04.170390 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.079 seconds
[0m18:06:04.173792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_gold)
[0m18:06:04.174454 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "gold"
"
[0m18:06:04.180333 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_gold"
[0m18:06:04.180749 [debug] [ThreadPool]: On create_AIRBNB_gold: create schema if not exists AIRBNB.gold
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_gold"} */
[0m18:06:04.271172 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m18:06:04.276426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m18:06:04.291958 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:06:04.292366 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:06:04.403117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.110 seconds
[0m18:06:04.407377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m18:06:04.410647 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:06:04.410998 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:06:04.487062 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.076 seconds
[0m18:06:04.490538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_gold)
[0m18:06:04.494294 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:06:04.494682 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:06:04.590800 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m18:06:04.594701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m18:06:04.598759 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:06:04.599273 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:06:04.696849 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.097 seconds
[0m18:06:04.701764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb8980>]}
[0m18:06:04.711390 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:06:04.712226 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m18:06:04.712731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m18:06:04.713093 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:06:04.724456 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:06:04.734265 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:06:04.776347 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:06:04.776598 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m18:06:04.864708 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c213d4-0001-88f0-000c-0f160003482e
[0m18:06:04.865021 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 12
invalid identifier 'BOOKING_STATUS'
[0m18:06:04.870932 [debug] [Thread-2 (]: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:06:04.873943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbd1c0>]}
[0m18:06:04.874522 [error] [Thread-2 (]: 1 of 3 ERROR snapshotting gold.dim_bookings .................................... [[31mERROR[0m in 0.16s]
[0m18:06:04.874899 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:06:04.875143 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:06:04.875481 [debug] [Thread-5 (]: Marking all children of 'snapshot.dbt_snowflake_aws_project.dim_bookings' to be skipped because of status 'error'.  Reason: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'.
[0m18:06:04.875770 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m18:06:04.876527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m18:06:04.876781 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:06:04.880554 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:06:04.890389 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:06:04.892957 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:06:04.893215 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    

    select *,
        md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        HOST_CREATED_AT as dbt_updated_at,
        HOST_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:06:05.214107 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.321 seconds
[0m18:06:05.217656 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:06:05.217895 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:06:05.298869 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m18:06:05.299456 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:06:05.305859 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:06:05.306206 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace transient table AIRBNB.gold.dim_hosts
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        HOST_CREATED_AT as dbt_updated_at,
        HOST_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m18:06:05.932941 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m18:06:05.956405 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107659370>]}
[0m18:06:05.957071 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 1[0m in 1.08s]
[0m18:06:05.957466 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:06:05.957719 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:06:05.958056 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m18:06:05.958349 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m18:06:05.958564 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:06:05.963082 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:06:05.976355 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:06:05.978732 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:06:05.978973 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        LISTING_CREATED_AT as dbt_updated_at,
        LISTING_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:06:06.083058 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m18:06:06.084740 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:06:06.085140 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:06:06.241228 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.155 seconds
[0m18:06:06.242840 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:06:06.249590 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:06:06.250170 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace transient table AIRBNB.gold.dim_listings
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        LISTING_CREATED_AT as dbt_updated_at,
        LISTING_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m18:06:06.850412 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m18:06:06.854002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a22425ec-145e-4830-9dbf-320e2fb271f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde91c0>]}
[0m18:06:06.855026 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 1[0m in 0.90s]
[0m18:06:06.855732 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:06:06.857438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:06.857979 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m18:06:06.858311 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m18:06:06.952236 [info ] [MainThread]: 
[0m18:06:06.953172 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m18:06:06.954447 [debug] [MainThread]: Command end result
[0m18:06:07.049263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:06:07.057454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:06:07.067414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:06:07.067718 [info ] [MainThread]: 
[0m18:06:07.068054 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:07.068309 [info ] [MainThread]: 
[0m18:06:07.068622 [error] [MainThread]: [31mFailure in snapshot dim_bookings (snapshots/dim_bookings.yml)[0m
[0m18:06:07.068912 [error] [MainThread]:   Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:06:07.069143 [info ] [MainThread]: 
[0m18:06:07.069393 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m18:06:07.069936 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.020398, "process_in_blocks": "0", "process_kernel_time": 0.740678, "process_mem_max_rss": "160612352", "process_out_blocks": "0", "process_user_time": 1.95078}
[0m18:06:07.070301 [debug] [MainThread]: Command `dbt snapshot` failed at 18:06:07.070239 after 5.02 seconds
[0m18:06:07.070578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109467350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8be5d0>]}
[0m18:06:07.070834 [debug] [MainThread]: Flushing usage events
[0m18:06:08.288628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:06.411424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109988680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109988320>]}


============================== 18:07:06.415391 | 0cc208a5-2bfe-40cd-831c-394b9b99c007 ==============================
[0m18:07:06.415391 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:06.415670 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/aadil.mansoori/.dbt', 'invocation_command': 'dbt ', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None'}
[0m18:07:06.483463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc208a5-2bfe-40cd-831c-394b9b99c007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099244a0>]}
[0m18:07:06.516211 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:07:06.517067 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:07:06.517349 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14812833, "process_in_blocks": "0", "process_kernel_time": 0.221037, "process_mem_max_rss": "111771648", "process_out_blocks": "0", "process_user_time": 0.781432}
[0m18:07:06.517544 [debug] [MainThread]: Command `cli deps` succeeded at 18:07:06.517502 after 0.15 seconds
[0m18:07:06.517688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109988410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099887d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a83e00>]}
[0m18:07:06.517814 [debug] [MainThread]: Flushing usage events
[0m18:07:07.475220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:39.332089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0bb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b723f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa195e0>]}


============================== 18:09:39.338074 | ee387e7e-48a4-4596-b7ba-6793143af42d ==============================
[0m18:09:39.338074 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:09:39.338424 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt'}
[0m18:09:40.356216 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:09:40.357532 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:09:40.358189 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:09:40.518608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090320f0>]}
[0m18:09:40.561615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa74d70>]}
[0m18:09:40.564947 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:09:40.636621 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:09:40.800591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:40.800835 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:09:40.800949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:40.821938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c42f290>]}
[0m18:09:40.857839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:09:40.860276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:09:40.887247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95ed50>]}
[0m18:09:40.887474 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:09:40.887614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed9fa0>]}
[0m18:09:40.888506 [info ] [MainThread]: 
[0m18:09:40.888642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:40.888743 [info ] [MainThread]: 
[0m18:09:40.888943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:09:40.890605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:09:41.131437 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:09:41.131689 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:09:41.131872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:41.979060 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.847 seconds
[0m18:09:41.987303 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:09:41.987852 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:09:42.056821 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.069 seconds
[0m18:09:42.059345 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:09:42.059629 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:09:42.118097 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.058 seconds
[0m18:09:42.120281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m18:09:42.129108 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:09:42.129369 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:09:42.202256 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.073 seconds
[0m18:09:42.204458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m18:09:42.207442 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:09:42.207738 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:09:42.276512 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.068 seconds
[0m18:09:42.279994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_gold)
[0m18:09:42.284866 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:09:42.285331 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:09:42.390676 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:09:42.394582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m18:09:42.399129 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:09:42.399620 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:09:42.493702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.094 seconds
[0m18:09:42.498313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f8380>]}
[0m18:09:42.510127 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m18:09:42.510761 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m18:09:42.511231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m18:09:42.511568 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m18:09:42.520114 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m18:09:42.527032 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m18:09:42.545988 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m18:09:42.548946 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m18:09:42.549142 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m18:09:42.768913 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m18:09:42.797077 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cecf0>]}
[0m18:09:42.797678 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.28s]
[0m18:09:42.798114 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m18:09:42.798403 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m18:09:42.798782 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m18:09:42.799144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m18:09:42.799380 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m18:09:42.801319 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m18:09:42.807862 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m18:09:42.809534 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m18:09:42.811948 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m18:09:42.812166 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m18:09:42.982909 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m18:09:42.987901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d90b200>]}
[0m18:09:42.989116 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.19s]
[0m18:09:42.990104 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m18:09:42.990747 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m18:09:42.991434 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m18:09:42.992266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m18:09:42.992700 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m18:09:42.997342 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m18:09:43.006751 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m18:09:43.009212 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m18:09:43.012098 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m18:09:43.012357 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m18:09:43.193703 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m18:09:43.197671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cecf0>]}
[0m18:09:43.198476 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m18:09:43.199025 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m18:09:43.199413 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:09:43.199943 [info ] [Thread-2 (]: 4 of 7 START sql table model gold.obt .......................................... [RUN]
[0m18:09:43.200490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m18:09:43.200928 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:09:43.206608 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:09:43.219986 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:09:43.235710 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m18:09:43.239047 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m18:09:43.239308 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m18:09:44.157156 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.917 seconds
[0m18:09:44.160779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d98f800>]}
[0m18:09:44.161670 [info ] [Thread-2 (]: 4 of 7 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.96s]
[0m18:09:44.162313 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:09:44.162759 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:09:44.163304 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m18:09:44.164224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m18:09:44.164714 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m18:09:44.170924 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.183237 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m18:09:44.208279 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.208510 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:09:44.381400 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m18:09:44.389672 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.390052 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:09:44.450901 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.061 seconds
[0m18:09:44.453208 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.453410 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:09:44.503910 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.050 seconds
[0m18:09:44.510729 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.510990 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:09:44.570047 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.059 seconds
[0m18:09:44.598369 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.601577 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.601797 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:09:44.809935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m18:09:44.811089 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:44.811719 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:09:45.378954 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.566 seconds
[0m18:09:45.380097 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:45.380748 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:09:45.687662 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m18:09:45.700655 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m18:09:45.705932 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:09:45.706235 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:09:45.833904 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m18:09:45.838214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da1f350>]}
[0m18:09:45.839233 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.67s]
[0m18:09:45.840010 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:09:45.840594 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:09:45.841259 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m18:09:45.841967 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m18:09:45.842463 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m18:09:45.847478 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:45.861296 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m18:09:45.864187 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:45.864456 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:09:46.087978 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m18:09:46.093826 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.094245 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:09:46.160346 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.065 seconds
[0m18:09:46.167796 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.168377 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:09:46.231630 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.063 seconds
[0m18:09:46.237165 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.237665 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:09:46.291786 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.053 seconds
[0m18:09:46.297061 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.301658 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.302069 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:09:46.417968 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m18:09:46.419475 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.420314 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:09:46.852594 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.431 seconds
[0m18:09:46.854101 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:46.854643 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:09:47.065585 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m18:09:47.071155 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m18:09:47.072385 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:09:47.072817 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:09:47.212973 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m18:09:47.214642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9c5f0>]}
[0m18:09:47.215102 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.37s]
[0m18:09:47.215448 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:09:47.215688 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m18:09:47.216045 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m18:09:47.216404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m18:09:47.216645 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m18:09:47.219590 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.232540 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m18:09:47.234925 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.235162 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:09:47.410982 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m18:09:47.417689 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.418245 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:09:47.490515 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.072 seconds
[0m18:09:47.498435 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.499113 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:09:47.558717 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.059 seconds
[0m18:09:47.566606 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.567314 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:09:47.638532 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.070 seconds
[0m18:09:47.645904 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.650801 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.651320 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:09:47.716554 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m18:09:47.717390 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:47.717840 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:09:48.450477 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.732 seconds
[0m18:09:48.451751 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:48.452412 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:09:48.619993 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m18:09:48.626765 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m18:09:48.628174 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:09:48.628662 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:09:48.739825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m18:09:48.743599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee387e7e-48a4-4596-b7ba-6793143af42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da83170>]}
[0m18:09:48.744543 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.53s]
[0m18:09:48.745368 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m18:09:48.745949 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:09:48.746561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_listings, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m18:09:48.747033 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:09:48.751628 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m18:09:48.755647 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:09:48.756007 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:09:48.756411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m18:09:48.756764 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:09:48.759630 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m18:09:48.762814 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:09:48.763081 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:09:48.763375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m18:09:48.763631 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:09:48.765679 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m18:09:48.768648 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:09:48.769651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:48.769959 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m18:09:48.770180 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m18:09:48.868948 [info ] [MainThread]: 
[0m18:09:48.869793 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 3 view models in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m18:09:48.871744 [debug] [MainThread]: Command end result
[0m18:09:48.896602 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:09:48.906865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:09:48.912379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:09:48.912577 [info ] [MainThread]: 
[0m18:09:48.912800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:48.912968 [info ] [MainThread]: 
[0m18:09:48.913159 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:09:48.913552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.656727, "process_in_blocks": "0", "process_kernel_time": 0.940076, "process_mem_max_rss": "161497088", "process_out_blocks": "0", "process_user_time": 2.209952}
[0m18:09:48.913829 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:48.913773 after 9.66 seconds
[0m18:09:48.914064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa195e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa19670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5669f0>]}
[0m18:09:48.914284 [debug] [MainThread]: Flushing usage events
[0m18:09:50.394179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:56.386780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bd3a0>]}


============================== 18:09:56.389779 | c4f98386-f000-49b1-b7ce-77d9b9ba3d3a ==============================
[0m18:09:56.389779 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:09:56.390208 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m18:09:56.628873 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:09:56.629159 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:09:56.629301 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:09:56.717425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1df40>]}
[0m18:09:56.775552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb12b0>]}
[0m18:09:56.776529 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:09:56.845405 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:09:56.983417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:56.983654 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:09:56.983771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:57.006291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d00fce0>]}
[0m18:09:57.045782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:09:57.047864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:09:57.078795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d403710>]}
[0m18:09:57.079064 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:09:57.079211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29da90>]}
[0m18:09:57.080140 [info ] [MainThread]: 
[0m18:09:57.080279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:57.080382 [info ] [MainThread]: 
[0m18:09:57.080590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:09:57.082368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:09:57.254759 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:09:57.254964 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m18:09:57.255075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:57.862320 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.607 seconds
[0m18:09:57.864397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO)
[0m18:09:57.867214 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:09:57.867591 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:09:57.942432 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.074 seconds
[0m18:09:57.945568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_gold)
[0m18:09:57.959281 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:09:57.959676 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:09:58.037332 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.077 seconds
[0m18:09:58.039930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m18:09:58.043100 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:09:58.043491 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:09:58.131774 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.088 seconds
[0m18:09:58.133854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m18:09:58.137028 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:09:58.137432 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:09:58.222045 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.084 seconds
[0m18:09:58.224509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m18:09:58.227675 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:09:58.228449 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:09:58.294708 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.066 seconds
[0m18:09:58.295713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e433950>]}
[0m18:09:58.298114 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:09:58.298351 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m18:09:58.298542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m18:09:58.298684 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:09:58.302996 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:09:58.309904 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:09:58.340964 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:09:58.341243 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m18:09:58.418048 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c213d7-0001-8904-000c-0f160003589e
[0m18:09:58.418394 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 12
invalid identifier 'BOOKING_STATUS'
[0m18:09:58.422300 [debug] [Thread-2 (]: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:09:58.424849 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b461130>]}
[0m18:09:58.425253 [error] [Thread-2 (]: 1 of 3 ERROR snapshotting gold.dim_bookings .................................... [[31mERROR[0m in 0.12s]
[0m18:09:58.425629 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:09:58.425870 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:09:58.426179 [debug] [Thread-5 (]: Marking all children of 'snapshot.dbt_snowflake_aws_project.dim_bookings' to be skipped because of status 'error'.  Reason: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'.
[0m18:09:58.426454 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m18:09:58.427089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m18:09:58.427276 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:09:58.429873 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:58.439273 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:09:58.444246 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:58.444439 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:58.531361 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m18:09:58.560591 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:58.560978 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m18:09:59.202499 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m18:09:59.207721 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.208431 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.288677 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m18:09:59.294780 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.295464 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.377776 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m18:09:59.382095 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.382480 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.451162 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.068 seconds
[0m18:09:59.453233 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.453426 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.523524 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.070 seconds
[0m18:09:59.529229 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.529536 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.586793 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.057 seconds
[0m18:09:59.602968 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.603387 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.869007 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.265 seconds
[0m18:09:59.876539 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.877085 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:09:59.948414 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m18:09:59.949523 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.952278 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:09:59.952700 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:10:00.157476 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m18:10:00.158457 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:10:00.159215 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m18:10:01.045550 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.885 seconds
[0m18:10:01.046558 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:10:01.047144 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:10:01.456468 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m18:10:01.483189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1d190>]}
[0m18:10:01.483947 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 0[0m in 3.06s]
[0m18:10:01.484407 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:10:01.484703 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:10:01.485123 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m18:10:01.485524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m18:10:01.485798 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:10:01.489722 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:01.498758 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:10:01.502593 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:01.502847 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:01.583053 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.080 seconds
[0m18:10:01.588538 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:01.589050 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m18:10:02.234305 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m18:10:02.240591 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.241331 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.329515 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.087 seconds
[0m18:10:02.336639 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.337249 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.446092 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m18:10:02.454135 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.455032 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.523413 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.067 seconds
[0m18:10:02.529778 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.530331 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.607821 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m18:10:02.614592 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.615114 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.684856 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.069 seconds
[0m18:10:02.693662 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.694361 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.846157 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m18:10:02.848590 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.849341 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:02.949067 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.099 seconds
[0m18:10:02.950531 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.955203 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:02.955808 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:03.108348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m18:10:03.109289 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:03.109895 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m18:10:03.701452 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.591 seconds
[0m18:10:03.702629 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:10:03.703313 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:10:04.014654 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m18:10:04.018248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f98386-f000-49b1-b7ce-77d9b9ba3d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104445220>]}
[0m18:10:04.019291 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 2.53s]
[0m18:10:04.019987 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:10:04.021937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:04.022489 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m18:10:04.022937 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m18:10:04.110405 [info ] [MainThread]: 
[0m18:10:04.111333 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m18:10:04.112838 [debug] [MainThread]: Command end result
[0m18:10:04.141912 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:10:04.153475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:10:04.160388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:10:04.160652 [info ] [MainThread]: 
[0m18:10:04.160942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:10:04.161166 [info ] [MainThread]: 
[0m18:10:04.161438 [error] [MainThread]: [31mFailure in snapshot dim_bookings (snapshots/dim_bookings.yml)[0m
[0m18:10:04.161695 [error] [MainThread]:   Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:10:04.161889 [info ] [MainThread]: 
[0m18:10:04.162103 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m18:10:04.162588 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 7.8134446, "process_in_blocks": "0", "process_kernel_time": 0.625765, "process_mem_max_rss": "161693696", "process_out_blocks": "0", "process_user_time": 1.922346}
[0m18:10:04.162939 [debug] [MainThread]: Command `dbt snapshot` failed at 18:10:04.162875 after 7.81 seconds
[0m18:10:04.163223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c7ec0>]}
[0m18:10:04.163478 [debug] [MainThread]: Flushing usage events
[0m18:10:05.344565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:30.285774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094abfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094abef0>]}


============================== 18:10:30.290924 | e903a56f-b1fa-4e06-a805-288f2f2a7dae ==============================
[0m18:10:30.290924 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:10:30.291282 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select models/gold', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True'}
[0m18:10:31.074004 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:10:31.075869 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:10:31.077025 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:10:31.226975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aaec00>]}
[0m18:10:31.270705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a189fd0>]}
[0m18:10:31.273233 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:10:31.344108 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:10:31.512733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:31.512967 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:10:31.513086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:31.534378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7fa70>]}
[0m18:10:31.571828 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:10:31.574279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:10:31.599856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c6630>]}
[0m18:10:31.600063 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:10:31.600208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d54f0>]}
[0m18:10:31.601904 [info ] [MainThread]: 
[0m18:10:31.602037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:31.602143 [info ] [MainThread]: 
[0m18:10:31.602337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:31.602700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:10:31.857877 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:10:31.858203 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:10:31.858435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:32.721930 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.863 seconds
[0m18:10:32.730452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m18:10:32.741471 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:10:32.741817 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:10:32.892933 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.151 seconds
[0m18:10:32.896738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m18:10:32.901467 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:10:32.901907 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:10:33.001970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m18:10:33.005373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_gold)
[0m18:10:33.009198 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:10:33.009828 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:10:33.093775 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.083 seconds
[0m18:10:33.098380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m18:10:33.104450 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:10:33.105025 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:10:33.193951 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.088 seconds
[0m18:10:33.198919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e999a0>]}
[0m18:10:33.210585 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:10:33.211705 [info ] [Thread-2 (]: 1 of 1 START sql table model gold.obt .......................................... [RUN]
[0m18:10:33.212563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.obt)
[0m18:10:33.213198 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:10:33.225893 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:10:33.229080 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:10:33.250483 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m18:10:33.265884 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m18:10:33.266177 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m18:10:34.224139 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m18:10:34.251347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e903a56f-b1fa-4e06-a805-288f2f2a7dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087313a0>]}
[0m18:10:34.251976 [info ] [Thread-2 (]: 1 of 1 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.03s]
[0m18:10:34.252419 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:10:34.253167 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:10:34.253528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m18:10:34.253794 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:10:34.256065 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m18:10:34.259384 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:10:34.259667 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:10:34.259977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m18:10:34.260246 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:10:34.262218 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m18:10:34.265444 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:10:34.265697 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:10:34.265952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m18:10:34.266170 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:10:34.267780 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m18:10:34.270393 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:10:34.271014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:34.271188 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m18:10:34.271347 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m18:10:34.352144 [info ] [MainThread]: 
[0m18:10:34.352579 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m18:10:34.353264 [debug] [MainThread]: Command end result
[0m18:10:34.375082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:10:34.385715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:10:34.391199 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:10:34.391424 [info ] [MainThread]: 
[0m18:10:34.391677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:34.391860 [info ] [MainThread]: 
[0m18:10:34.392060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:34.392450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.175456, "process_in_blocks": "0", "process_kernel_time": 0.835352, "process_mem_max_rss": "159760384", "process_out_blocks": "0", "process_user_time": 1.929631}
[0m18:10:34.392739 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:34.392680 after 4.18 seconds
[0m18:10:34.392968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a721880>]}
[0m18:10:34.393187 [debug] [MainThread]: Flushing usage events
[0m18:10:35.552945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:10.894547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b89b0>]}


============================== 18:11:10.899540 | 0ea68ebb-68fe-4af0-bc05-115b30a571db ==============================
[0m18:11:10.899540 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:11:10.899871 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True'}
[0m18:11:12.032267 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:11:12.033223 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:11:12.033635 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:11:12.188206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d268c80>]}
[0m18:11:12.231600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bd730>]}
[0m18:11:12.235001 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:11:12.309299 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:11:12.535468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:12.535764 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:11:12.535917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:12.561346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ec050>]}
[0m18:11:12.601241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:11:12.607859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:11:12.684350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4fed20>]}
[0m18:11:12.684636 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:11:12.684810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfda9c0>]}
[0m18:11:12.685932 [info ] [MainThread]: 
[0m18:11:12.686105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:12.686230 [info ] [MainThread]: 
[0m18:11:12.686476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:11:12.688715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:11:13.129848 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:11:13.130535 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:11:13.130802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:13.930928 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.800 seconds
[0m18:11:13.933390 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:11:13.933621 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:11:14.262086 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.328 seconds
[0m18:11:14.269662 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:11:14.270227 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:11:14.354368 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.084 seconds
[0m18:11:14.358656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m18:11:14.370628 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:11:14.370946 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:11:14.446797 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.076 seconds
[0m18:11:14.448567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m18:11:14.450953 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:11:14.451260 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:11:14.527149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.075 seconds
[0m18:11:14.531295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m18:11:14.536724 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:11:14.537269 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:11:14.643559 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.106 seconds
[0m18:11:14.647397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_semi_raw)
[0m18:11:14.651507 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:11:14.651946 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:11:14.732691 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.080 seconds
[0m18:11:14.736872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e10bfb0>]}
[0m18:11:14.748679 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m18:11:14.749728 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m18:11:14.750440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.bookings)
[0m18:11:14.750911 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m18:11:14.760708 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m18:11:14.764070 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m18:11:14.786594 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m18:11:14.799523 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m18:11:14.799783 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m18:11:14.998947 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m18:11:15.030586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c551220>]}
[0m18:11:15.031175 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.28s]
[0m18:11:15.031617 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m18:11:15.031916 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m18:11:15.032325 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m18:11:15.032773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m18:11:15.033051 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m18:11:15.035267 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m18:11:15.038010 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m18:11:15.040005 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m18:11:15.053505 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m18:11:15.053802 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m18:11:15.208386 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m18:11:15.212436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f47ba70>]}
[0m18:11:15.213386 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.18s]
[0m18:11:15.214058 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m18:11:15.214522 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m18:11:15.215353 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m18:11:15.215966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m18:11:15.216316 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m18:11:15.219266 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m18:11:15.222567 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m18:11:15.224886 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m18:11:15.236342 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m18:11:15.236640 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m18:11:15.420445 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m18:11:15.425152 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c551220>]}
[0m18:11:15.425841 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m18:11:15.426317 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m18:11:15.426637 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:11:15.427056 [info ] [Thread-2 (]: 4 of 7 START sql table model gold.obt .......................................... [RUN]
[0m18:11:15.427489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m18:11:15.427807 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:11:15.433100 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:11:15.446443 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:11:15.461833 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m18:11:15.464875 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m18:11:15.465135 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m18:11:16.310586 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m18:11:16.314857 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5afbc0>]}
[0m18:11:16.315994 [info ] [Thread-2 (]: 4 of 7 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.89s]
[0m18:11:16.316965 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:11:16.317636 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:11:16.318487 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m18:11:16.319470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m18:11:16.320130 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m18:11:16.329106 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.333271 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m18:11:16.362154 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.362400 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:11:16.616958 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m18:11:16.629675 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.630090 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:11:16.708188 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.077 seconds
[0m18:11:16.716342 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.716985 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:11:16.780027 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.062 seconds
[0m18:11:16.792251 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.792676 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:11:16.850825 [debug] [Thread-2 (]: SQL status: SUCCESS 5 in 0.058 seconds
[0m18:11:16.882491 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.890728 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.890976 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:11:16.974843 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m18:11:16.975645 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:16.976116 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:11:17.639493 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 0.663 seconds
[0m18:11:17.641034 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:17.641870 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:11:17.859698 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m18:11:17.873514 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m18:11:17.879487 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:11:17.879798 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:11:17.989850 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m18:11:17.994110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f597dd0>]}
[0m18:11:17.995480 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 1.67s]
[0m18:11:17.996505 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:11:17.997208 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:11:17.997927 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m18:11:17.998572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m18:11:17.999036 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m18:11:18.004136 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.008354 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m18:11:18.012597 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.013257 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:11:18.226797 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m18:11:18.232529 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.233123 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:11:18.323686 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.090 seconds
[0m18:11:18.329478 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.329924 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:11:18.389253 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m18:11:18.394716 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.395258 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:11:18.479803 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.084 seconds
[0m18:11:18.485563 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.497438 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.497834 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:11:18.571919 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m18:11:18.573326 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:18.574019 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:11:19.176917 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.602 seconds
[0m18:11:19.177806 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:19.178316 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:11:19.335452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m18:11:19.342869 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m18:11:19.344540 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:11:19.345074 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:11:19.895350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m18:11:19.899413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f55a390>]}
[0m18:11:19.900631 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.90s]
[0m18:11:19.901546 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:11:19.902084 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m18:11:19.902734 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m18:11:19.903407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m18:11:19.903839 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m18:11:19.909911 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:19.913653 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m18:11:19.917396 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:19.917820 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:11:20.151521 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m18:11:20.159720 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.160151 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:11:20.283243 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.122 seconds
[0m18:11:20.291470 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.292080 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:11:20.358969 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.066 seconds
[0m18:11:20.365746 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.366255 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:11:20.429310 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.062 seconds
[0m18:11:20.436588 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.446606 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.447168 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:11:20.529728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m18:11:20.530262 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:20.530644 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:11:21.124223 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.593 seconds
[0m18:11:21.125520 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:21.126192 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:11:21.358055 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m18:11:21.364537 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m18:11:21.365925 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:11:21.366432 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:11:21.479867 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m18:11:21.483947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ea68ebb-68fe-4af0-bc05-115b30a571db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f677f20>]}
[0m18:11:21.484788 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.58s]
[0m18:11:21.485427 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m18:11:21.486073 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:11:21.486816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_listings, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m18:11:21.487241 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:11:21.490889 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m18:11:21.504920 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:11:21.505259 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:11:21.505567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m18:11:21.505832 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:11:21.508189 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m18:11:21.519516 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:11:21.519775 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:11:21.520041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m18:11:21.520271 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:11:21.522340 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m18:11:21.533118 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:11:21.534027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:21.534290 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m18:11:21.534509 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m18:11:21.648230 [info ] [MainThread]: 
[0m18:11:21.649278 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 3 view models in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m18:11:21.651885 [debug] [MainThread]: Command end result
[0m18:11:21.680564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:11:21.691300 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:11:21.697162 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:11:21.697386 [info ] [MainThread]: 
[0m18:11:21.697622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:21.697801 [info ] [MainThread]: 
[0m18:11:21.698003 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:11:21.698407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.870814, "process_in_blocks": "0", "process_kernel_time": 1.19143, "process_mem_max_rss": "161300480", "process_out_blocks": "0", "process_user_time": 2.41186}
[0m18:11:21.698683 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:21.698628 after 10.87 seconds
[0m18:11:21.698912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e108c80>]}
[0m18:11:21.699141 [debug] [MainThread]: Flushing usage events
[0m18:11:23.057604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:32.578728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3d580>]}


============================== 18:11:32.583626 | c4027f2e-3d7a-4f21-9637-11da6515ed3b ==============================
[0m18:11:32.583626 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:11:32.583980 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_colors': 'True'}
[0m18:11:33.259998 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:11:33.260277 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:11:33.260414 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:11:33.358472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bf680>]}
[0m18:11:33.405586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d4e30>]}
[0m18:11:33.407262 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:11:33.472555 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:11:33.638265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:33.638476 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:11:33.638587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:33.659277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba25af0>]}
[0m18:11:33.696021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:11:33.698849 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:11:33.719343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd27ef0>]}
[0m18:11:33.719577 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:11:33.719720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4bc80>]}
[0m18:11:33.720575 [info ] [MainThread]: 
[0m18:11:33.720710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:33.720824 [info ] [MainThread]: 
[0m18:11:33.721030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:11:33.722610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:11:33.951446 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:11:33.951690 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:11:33.951831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:34.624421 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.672 seconds
[0m18:11:34.628773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB)
[0m18:11:34.633530 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:11:34.634035 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m18:11:34.706627 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.072 seconds
[0m18:11:34.711540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO_semi_raw)
[0m18:11:34.728074 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:11:34.728880 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:11:34.805911 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.077 seconds
[0m18:11:34.808938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_gold)
[0m18:11:34.813570 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:11:34.814071 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:11:34.903205 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.089 seconds
[0m18:11:34.906738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_gold)
[0m18:11:34.911347 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:11:34.911889 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:11:34.996065 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m18:11:34.999761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m18:11:35.003615 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:11:35.004070 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:11:35.233667 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.229 seconds
[0m18:11:35.237323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a3d70>]}
[0m18:11:35.247590 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:11:35.248634 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m18:11:35.249355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m18:11:35.249856 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:11:35.264059 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:11:35.267222 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:11:35.312776 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m18:11:35.313097 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m18:11:35.405583 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c213d9-0001-88f0-000c-0f1600034a1a
[0m18:11:35.405920 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 12
invalid identifier 'BOOKING_STATUS'
[0m18:11:35.411909 [debug] [Thread-2 (]: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:11:35.415576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce5640>]}
[0m18:11:35.416213 [error] [Thread-2 (]: 1 of 3 ERROR snapshotting gold.dim_bookings .................................... [[31mERROR[0m in 0.16s]
[0m18:11:35.416570 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m18:11:35.416825 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:11:35.417146 [debug] [Thread-5 (]: Marking all children of 'snapshot.dbt_snowflake_aws_project.dim_bookings' to be skipped because of status 'error'.  Reason: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'.
[0m18:11:35.417433 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m18:11:35.418238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m18:11:35.418486 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:11:35.421874 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:35.423750 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:11:35.431129 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:35.431492 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:35.501053 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m18:11:35.528569 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:35.529014 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m18:11:36.059600 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m18:11:36.063733 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.064295 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.144899 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m18:11:36.149449 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.149936 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.209934 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.060 seconds
[0m18:11:36.214801 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.215250 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.296881 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m18:11:36.300811 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.301342 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.384338 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m18:11:36.391310 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.391715 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.457808 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.066 seconds
[0m18:11:36.476337 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.477079 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.779984 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.302 seconds
[0m18:11:36.784851 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.785273 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.853892 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.068 seconds
[0m18:11:36.854754 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.870868 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.871337 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:36.958914 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m18:11:36.959578 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:36.960025 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m18:11:37.507899 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.547 seconds
[0m18:11:37.509000 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m18:11:37.509579 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m18:11:37.768160 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m18:11:37.794148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579220>]}
[0m18:11:37.794947 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 0[0m in 2.38s]
[0m18:11:37.795415 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m18:11:37.795725 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:11:37.796168 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m18:11:37.796619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m18:11:37.796901 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:11:37.800821 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:37.803791 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:11:37.808030 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:37.808329 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:37.895285 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m18:11:37.900349 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:37.900880 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m18:11:38.500378 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m18:11:38.502684 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.502971 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:38.572758 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.069 seconds
[0m18:11:38.577903 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.578363 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:38.647663 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.069 seconds
[0m18:11:38.650726 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.650946 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:38.740925 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.090 seconds
[0m18:11:38.745599 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.746138 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:38.803669 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.057 seconds
[0m18:11:38.807745 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.808188 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:38.874088 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.065 seconds
[0m18:11:38.880459 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:38.880966 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:39.097081 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.216 seconds
[0m18:11:39.098473 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:39.098910 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:39.161965 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m18:11:39.162868 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:39.176300 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:39.176683 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:39.261676 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m18:11:39.262502 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:39.263042 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m18:11:39.760156 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.496 seconds
[0m18:11:39.761311 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m18:11:39.761928 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m18:11:39.990174 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m18:11:39.992784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4027f2e-3d7a-4f21-9637-11da6515ed3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923d910>]}
[0m18:11:39.993415 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 2.20s]
[0m18:11:39.993794 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m18:11:39.994838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:39.995026 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m18:11:39.995187 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m18:11:40.082853 [info ] [MainThread]: 
[0m18:11:40.083395 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m18:11:40.083960 [debug] [MainThread]: Command end result
[0m18:11:40.102148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:11:40.113538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:11:40.120000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:11:40.120325 [info ] [MainThread]: 
[0m18:11:40.120591 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:11:40.120779 [info ] [MainThread]: 
[0m18:11:40.121014 [error] [MainThread]: [31mFailure in snapshot dim_bookings (snapshots/dim_bookings.yml)[0m
[0m18:11:40.121214 [error] [MainThread]:   Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'BOOKING_STATUS'
[0m18:11:40.121378 [info ] [MainThread]: 
[0m18:11:40.121566 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m18:11:40.122098 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 7.6124988, "process_in_blocks": "0", "process_kernel_time": 0.634265, "process_mem_max_rss": "161824768", "process_out_blocks": "0", "process_user_time": 1.919729}
[0m18:11:40.122445 [debug] [MainThread]: Command `dbt snapshot` failed at 18:11:40.122391 after 7.61 seconds
[0m18:11:40.122702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd2f60>]}
[0m18:11:40.122918 [debug] [MainThread]: Flushing usage events
[0m18:11:41.984695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:06.904018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107850bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02bf20>]}


============================== 18:13:06.909520 | c22c9564-321d-4d8c-b614-af6e97ec2744 ==============================
[0m18:13:06.909520 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:13:06.909802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False'}
[0m18:13:07.549331 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m18:13:07.549804 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m18:13:07.549994 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m18:13:07.661806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad38ec0>]}
[0m18:13:07.727400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926d220>]}
[0m18:13:07.729520 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m18:13:07.808619 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:13:08.031272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:08.031527 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:13:08.031667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:08.054258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee3650>]}
[0m18:13:08.094441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:13:08.099185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:13:08.149501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25f0e0>]}
[0m18:13:08.149798 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m18:13:08.149949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf24b0>]}
[0m18:13:08.150980 [info ] [MainThread]: 
[0m18:13:08.151122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:08.151224 [info ] [MainThread]: 
[0m18:13:08.151438 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:08.153335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m18:13:08.373964 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:13:08.374203 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:13:08.374346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:09.008316 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.634 seconds
[0m18:13:09.013525 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:13:09.014080 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:13:09.078835 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.064 seconds
[0m18:13:09.083455 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m18:13:09.083917 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m18:13:09.461678 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.377 seconds
[0m18:13:09.463575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m18:13:09.471260 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m18:13:09.471523 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m18:13:09.557012 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.085 seconds
[0m18:13:09.559061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m18:13:09.562007 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m18:13:09.562339 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m18:13:09.627289 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.065 seconds
[0m18:13:09.629208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m18:13:09.631812 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m18:13:09.632144 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m18:13:09.724763 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.092 seconds
[0m18:13:09.727127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m18:13:09.731346 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m18:13:09.731980 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m18:13:09.822134 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.090 seconds
[0m18:13:09.824192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c157320>]}
[0m18:13:09.830255 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.bookings
[0m18:13:09.830743 [info ] [Thread-2 (]: 1 of 7 START sql view model semi_raw.bookings .................................. [RUN]
[0m18:13:09.831121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now model.dbt_snowflake_aws_project.bookings)
[0m18:13:09.831379 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.bookings
[0m18:13:09.837147 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.bookings"
[0m18:13:09.842552 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.bookings
[0m18:13:09.860436 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.bookings"
[0m18:13:09.862769 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.bookings"
[0m18:13:09.862962 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.bookings: create or replace   view AIRBNB_PRO.semi_raw.bookings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.bookings"} */;
[0m18:13:10.081748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m18:13:10.113636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ad190>]}
[0m18:13:10.114301 [info ] [Thread-2 (]: 1 of 7 OK created sql view model semi_raw.bookings ............................. [[32mSUCCESS 1[0m in 0.28s]
[0m18:13:10.114765 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.bookings
[0m18:13:10.115060 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.hosts
[0m18:13:10.115502 [info ] [Thread-2 (]: 2 of 7 START sql view model semi_raw.hosts ..................................... [RUN]
[0m18:13:10.115986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.bookings, now model.dbt_snowflake_aws_project.hosts)
[0m18:13:10.116336 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.hosts
[0m18:13:10.118627 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.hosts"
[0m18:13:10.125759 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.hosts
[0m18:13:10.128103 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.hosts"
[0m18:13:10.130107 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.hosts"
[0m18:13:10.130355 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.hosts: create or replace   view AIRBNB_PRO.semi_raw.hosts
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.hosts"} */;
[0m18:13:10.310719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m18:13:10.315746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cf200>]}
[0m18:13:10.316972 [info ] [Thread-2 (]: 2 of 7 OK created sql view model semi_raw.hosts ................................ [[32mSUCCESS 1[0m in 0.20s]
[0m18:13:10.317992 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.hosts
[0m18:13:10.318631 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listings
[0m18:13:10.319385 [info ] [Thread-2 (]: 3 of 7 START sql view model semi_raw.listings .................................. [RUN]
[0m18:13:10.320164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.hosts, now model.dbt_snowflake_aws_project.listings)
[0m18:13:10.320626 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listings
[0m18:13:10.325247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listings"
[0m18:13:10.332263 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.listings
[0m18:13:10.334803 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.listings"
[0m18:13:10.336630 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.listings"
[0m18:13:10.336951 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.listings: create or replace   view AIRBNB_PRO.semi_raw.listings
  
  
  
  
  as (
    select * from AIRBNB_PRO.STAGING.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.listings"} */;
[0m18:13:10.486922 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m18:13:10.490676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bbc20>]}
[0m18:13:10.491683 [info ] [Thread-2 (]: 3 of 7 OK created sql view model semi_raw.listings ............................. [[32mSUCCESS 1[0m in 0.17s]
[0m18:13:10.492497 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listings
[0m18:13:10.493062 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m18:13:10.493760 [info ] [Thread-2 (]: 4 of 7 START sql table model gold.obt .......................................... [RUN]
[0m18:13:10.494526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.listings, now model.dbt_snowflake_aws_project.obt)
[0m18:13:10.495036 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m18:13:10.502616 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m18:13:10.504665 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m18:13:10.523023 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m18:13:10.538923 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m18:13:10.539231 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m18:13:10.624292 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c213db-0001-8904-000c-0f1600035ae2
[0m18:13:10.624827 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB_PRO.SILVER.SILVER_BOOKINGS' does not exist or not authorized.
[0m18:13:10.629757 [debug] [Thread-2 (]: Database Error in model obt (models/gold/obt.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.SILVER.SILVER_BOOKINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m18:13:10.630329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1db830>]}
[0m18:13:10.630996 [error] [Thread-2 (]: 4 of 7 ERROR creating sql table model gold.obt ................................. [[31mERROR[0m in 0.14s]
[0m18:13:10.631554 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m18:13:10.631929 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:13:10.632381 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.obt' to be skipped because of status 'error'.  Reason: Database Error in model obt (models/gold/obt.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.SILVER.SILVER_BOOKINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql.
[0m18:13:10.632800 [info ] [Thread-2 (]: 5 of 7 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m18:13:10.633900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.silver_bookings)
[0m18:13:10.634231 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m18:13:10.639728 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:13:10.650503 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m18:13:10.677063 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:13:10.679970 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:13:10.680162 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace transient table AIRBNB_PRO.silver.silver_bookings
    
    
    
    as (

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m18:13:11.303816 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m18:13:11.308209 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m18:13:11.311557 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m18:13:11.311817 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m18:13:11.368008 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.056 seconds
[0m18:13:11.369376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a3350>]}
[0m18:13:11.369759 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 1[0m in 0.74s]
[0m18:13:11.370045 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m18:13:11.370240 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:13:11.370504 [info ] [Thread-2 (]: 6 of 7 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m18:13:11.370756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m18:13:11.370927 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m18:13:11.372826 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.383155 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m18:13:11.385493 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.385714 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:13:11.590287 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m18:13:11.596849 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.597163 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:13:11.670302 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.073 seconds
[0m18:13:11.673930 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.674244 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:13:11.733538 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m18:13:11.755132 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.756181 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:13:11.811047 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.054 seconds
[0m18:13:11.830180 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.833610 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.833794 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:13:11.921533 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m18:13:11.922001 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:11.922271 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m18:13:12.536221 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.613 seconds
[0m18:13:12.537515 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:12.538210 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:13:12.768467 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m18:13:12.775148 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m18:13:12.776436 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m18:13:12.776922 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m18:13:12.889684 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:13:12.893529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ba840>]}
[0m18:13:12.894485 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.52s]
[0m18:13:12.895195 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m18:13:12.895694 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m18:13:12.896261 [info ] [Thread-2 (]: 7 of 7 START sql incremental model silver.silver_listings ...................... [RUN]
[0m18:13:12.896823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m18:13:12.897214 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m18:13:12.903484 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:12.921765 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m18:13:12.925295 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:12.925641 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:13:13.127472 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m18:13:13.132681 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.133316 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:13:13.212912 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.079 seconds
[0m18:13:13.218666 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.219055 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:13:13.280445 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.061 seconds
[0m18:13:13.287070 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.287636 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:13:13.355354 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.066 seconds
[0m18:13:13.361222 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.366547 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.366917 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:13:13.447900 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m18:13:13.448935 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.449524 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m18:13:13.970261 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.520 seconds
[0m18:13:13.971396 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:13.971960 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:13:14.179325 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m18:13:14.189209 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m18:13:14.190666 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m18:13:14.191157 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m18:13:14.300128 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m18:13:14.303536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22c9564-321d-4d8c-b614-af6e97ec2744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ec290>]}
[0m18:13:14.304475 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.41s]
[0m18:13:14.305329 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m18:13:14.306002 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:13:14.306697 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m18:13:14.307449 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:13:14.308006 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m18:13:14.308483 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:13:14.308925 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m18:13:14.310966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:14.311345 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m18:13:14.311702 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m18:13:14.407287 [info ] [MainThread]: 
[0m18:13:14.408218 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 3 view models in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m18:13:14.410355 [debug] [MainThread]: Command end result
[0m18:13:14.434057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m18:13:14.448432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m18:13:14.453220 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m18:13:14.453464 [info ] [MainThread]: 
[0m18:13:14.453682 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:13:14.453851 [info ] [MainThread]: 
[0m18:13:14.454060 [error] [MainThread]: [31mFailure in model obt (models/gold/obt.sql)[0m
[0m18:13:14.454252 [error] [MainThread]:   Database Error in model obt (models/gold/obt.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.SILVER.SILVER_BOOKINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/obt.sql
[0m18:13:14.454399 [info ] [MainThread]: 
[0m18:13:14.454569 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/obt.sql
[0m18:13:14.454716 [info ] [MainThread]: 
[0m18:13:14.454879 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:13:14.455246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.6015453, "process_in_blocks": "0", "process_kernel_time": 0.404008, "process_mem_max_rss": "161316864", "process_out_blocks": "0", "process_user_time": 1.579195}
[0m18:13:14.455488 [debug] [MainThread]: Command `dbt run` failed at 18:13:14.455441 after 7.60 seconds
[0m18:13:14.455689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107850bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ddbb0>]}
[0m18:13:14.455875 [debug] [MainThread]: Flushing usage events
[0m18:13:15.716851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:12.929112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3aa0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d507fe0>]}


============================== 19:00:12.935953 | ace7151a-fc71-48a8-a779-821ae7fbfcbf ==============================
[0m19:00:12.935953 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:00:12.936312 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/silver', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False'}
[0m19:00:13.794023 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:00:13.795167 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:00:13.795682 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:00:13.951003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae72480>]}
[0m19:00:13.997330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7d5ca0>]}
[0m19:00:14.000386 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:00:14.069563 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:00:14.307173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:14.307457 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:00:14.307613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:14.333319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfbb3b0>]}
[0m19:00:14.372045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:00:14.379250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:00:14.431403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e73e180>]}
[0m19:00:14.431637 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:00:14.431791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a95b0>]}
[0m19:00:14.433474 [info ] [MainThread]: 
[0m19:00:14.433620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:14.433731 [info ] [MainThread]: 
[0m19:00:14.433952 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:14.435822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:00:14.763211 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:00:14.763480 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:00:14.763616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:15.816399 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.053 seconds
[0m19:00:15.822172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_gold)
[0m19:00:15.838785 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:00:15.839313 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:00:15.929115 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.089 seconds
[0m19:00:15.933467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m19:00:15.938293 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:00:15.938821 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:00:16.167644 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.228 seconds
[0m19:00:16.171631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m19:00:16.175979 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:00:16.176423 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:00:16.244682 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.068 seconds
[0m19:00:16.248054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:00:16.252601 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:00:16.253055 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:00:16.671603 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.418 seconds
[0m19:00:16.676439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d291c40>]}
[0m19:00:16.685796 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:00:16.686416 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m19:00:16.686897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.silver_bookings)
[0m19:00:16.687255 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m19:00:16.695645 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:16.698407 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m19:00:16.731986 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:16.732263 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:00:17.691465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.959 seconds
[0m19:00:17.704953 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:17.705503 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:00:17.997913 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.292 seconds
[0m19:00:18.006373 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:18.007132 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:00:18.092814 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.085 seconds
[0m19:00:18.107250 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:18.107669 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:00:18.387751 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.280 seconds
[0m19:00:18.422745 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:18.436751 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:18.437033 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:00:18.514142 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m19:00:18.514493 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:18.514726 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","BOOKING_STATUS" = DBT_INTERNAL_SOURCE."BOOKING_STATUS","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:00:20.322829 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.808 seconds
[0m19:00:20.324086 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:20.324758 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:00:21.029582 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m19:00:21.043580 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m19:00:21.051291 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:00:21.051732 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:00:21.158807 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m19:00:21.186719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae71580>]}
[0m19:00:21.187318 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 4.50s]
[0m19:00:21.187762 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:00:21.188058 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:00:21.188499 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m19:00:21.188922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m19:00:21.189210 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m19:00:21.191857 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:21.194537 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m19:00:21.198805 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:21.199134 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:00:22.773635 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m19:00:22.778338 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:22.778846 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:00:22.858702 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m19:00:22.865996 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:22.866603 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:00:23.149974 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.282 seconds
[0m19:00:23.156573 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:23.157124 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:00:23.230698 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.073 seconds
[0m19:00:23.238320 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:23.248397 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:23.249026 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:00:23.433074 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m19:00:23.434200 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:23.434952 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:00:24.069281 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.633 seconds
[0m19:00:24.070771 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:24.071470 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:00:24.923487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m19:00:24.930226 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m19:00:24.931927 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:00:24.932491 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:00:25.041151 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m19:00:25.045364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115028680>]}
[0m19:00:25.046379 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 3.86s]
[0m19:00:25.047205 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:00:25.047761 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m19:00:25.048437 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m19:00:25.049094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m19:00:25.049533 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m19:00:25.055229 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:25.059276 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m19:00:25.063554 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:25.064073 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:00:25.900341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m19:00:25.905942 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:25.906578 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:00:25.995915 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m19:00:26.003191 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:26.003758 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:00:26.256568 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.252 seconds
[0m19:00:26.267327 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:26.267952 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:00:26.333436 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.065 seconds
[0m19:00:26.342608 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:26.351544 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:26.352265 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:00:26.493298 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m19:00:26.494427 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:26.495185 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:00:27.128708 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.632 seconds
[0m19:00:27.130209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:27.130944 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:00:27.754122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m19:00:27.759854 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m19:00:27.761149 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:00:27.761567 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:00:28.121242 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m19:00:28.124998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace7151a-fc71-48a8-a779-821ae7fbfcbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11506aed0>]}
[0m19:00:28.126019 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 3.08s]
[0m19:00:28.126785 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m19:00:28.128455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:28.128894 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m19:00:28.129215 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m19:00:28.248625 [info ] [MainThread]: 
[0m19:00:28.249364 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 13.81 seconds (13.81s).
[0m19:00:28.250420 [debug] [MainThread]: Command end result
[0m19:00:28.274664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:00:28.282597 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:00:28.288731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:00:28.288948 [info ] [MainThread]: 
[0m19:00:28.289180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:28.289354 [info ] [MainThread]: 
[0m19:00:28.289554 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:00:28.289958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.433527, "process_in_blocks": "0", "process_kernel_time": 0.696541, "process_mem_max_rss": "161284096", "process_out_blocks": "0", "process_user_time": 1.941043}
[0m19:00:28.290249 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:28.290195 after 15.43 seconds
[0m19:00:28.290478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115013aa0>]}
[0m19:00:28.290701 [debug] [MainThread]: Flushing usage events
[0m19:00:29.242513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:56.791496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c88e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65c0e0>]}


============================== 19:00:56.796134 | 81a48a2e-f688-4172-8e5e-6a1e705ed4cc ==============================
[0m19:00:56.796134 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:00:56.796468 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select models/gold'}
[0m19:00:57.895111 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:00:57.895819 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:00:57.896184 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:00:58.017839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0db080>]}
[0m19:00:58.060914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df093a0>]}
[0m19:00:58.063592 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:00:58.131708 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:00:58.302148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:58.302367 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:00:58.302483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:58.323769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5f8110>]}
[0m19:00:58.359175 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:00:58.361450 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:00:58.389998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e85fa40>]}
[0m19:00:58.390215 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:00:58.390356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e3380>]}
[0m19:00:58.391686 [info ] [MainThread]: 
[0m19:00:58.391824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:58.391926 [info ] [MainThread]: 
[0m19:00:58.392120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:58.392477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:00:58.663959 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:00:58.664399 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:00:58.664673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:59.348327 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.683 seconds
[0m19:00:59.361091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_gold)
[0m19:00:59.375480 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:00:59.375943 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:00:59.456284 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.080 seconds
[0m19:00:59.460606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m19:00:59.465884 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:00:59.466377 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:01:00.394739 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.928 seconds
[0m19:01:00.398198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:01:00.402682 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:01:00.403263 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:01:00.480080 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.076 seconds
[0m19:01:00.484199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:01:00.488343 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:01:00.488785 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:01:00.564526 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.075 seconds
[0m19:01:00.567964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8880e0>]}
[0m19:01:00.578474 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:01:00.579396 [info ] [Thread-2 (]: 1 of 1 START sql table model gold.obt .......................................... [RUN]
[0m19:01:00.580042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.obt)
[0m19:01:00.580481 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:01:00.592061 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:01:00.603106 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:01:00.624883 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:01:00.628355 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:01:00.628642 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:01:02.258536 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.629 seconds
[0m19:01:02.282662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a48a2e-f688-4172-8e5e-6a1e705ed4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b51c0>]}
[0m19:01:02.283157 [info ] [Thread-2 (]: 1 of 1 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.70s]
[0m19:01:02.283537 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:01:02.284108 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:01:02.284439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:01:02.284669 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:01:02.286652 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:01:02.301720 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:01:02.301973 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:01:02.302213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:01:02.302397 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:01:02.304190 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:01:02.316509 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:01:02.316745 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:01:02.317020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:01:02.317287 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:01:02.319239 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:01:02.329508 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:01:02.330251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:02.330438 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:01:02.330609 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:01:02.430322 [info ] [MainThread]: 
[0m19:01:02.431066 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m19:01:02.431936 [debug] [MainThread]: Command end result
[0m19:01:02.456914 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:01:02.468381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:01:02.473915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:01:02.474131 [info ] [MainThread]: 
[0m19:01:02.474385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:02.474560 [info ] [MainThread]: 
[0m19:01:02.474757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:01:02.475160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7514963, "process_in_blocks": "0", "process_kernel_time": 0.920036, "process_mem_max_rss": "159547392", "process_out_blocks": "0", "process_user_time": 1.968668}
[0m19:01:02.475453 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:02.475395 after 5.75 seconds
[0m19:01:02.475691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d072ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d282930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e12a6f0>]}
[0m19:01:02.475916 [debug] [MainThread]: Flushing usage events
[0m19:01:03.464036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:27.103427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5d4c0>]}


============================== 19:01:27.108117 | d30828b8-7664-4db8-9509-414db29fd9ab ==============================
[0m19:01:27.108117 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:01:27.108454 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:01:28.275374 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:01:28.276710 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:01:28.277382 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:01:28.438165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcdee0>]}
[0m19:01:28.481364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ffb980>]}
[0m19:01:28.483694 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:01:28.554186 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:01:28.722847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:28.723064 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:01:28.723182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:28.744303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47e000>]}
[0m19:01:28.779513 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:01:28.782232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:01:28.807156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6501a0>]}
[0m19:01:28.807377 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:01:28.807518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970ed80>]}
[0m19:01:28.808394 [info ] [MainThread]: 
[0m19:01:28.808539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:28.808646 [info ] [MainThread]: 
[0m19:01:28.808839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:28.810475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:01:29.048326 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:01:29.048658 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m19:01:29.048856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:29.700157 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.651 seconds
[0m19:01:29.704604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO)
[0m19:01:29.708509 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:01:29.708932 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:01:29.774117 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.065 seconds
[0m19:01:29.779391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_gold)
[0m19:01:29.794179 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:01:29.794588 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:01:29.875052 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.080 seconds
[0m19:01:29.879089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m19:01:29.884164 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:01:29.884692 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:01:29.958117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.073 seconds
[0m19:01:29.960145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:01:29.962551 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:01:29.962808 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:01:30.046712 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.084 seconds
[0m19:01:30.048579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:01:30.050792 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:01:30.051056 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:01:30.130217 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m19:01:30.133081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071598b0>]}
[0m19:01:30.141016 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:01:30.141697 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:01:30.142368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:01:30.142912 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:01:30.152920 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:01:30.155913 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:01:30.195892 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:01:30.196194 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:01:30.272536 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2140b-0001-88b7-000c-0f1600037c16
[0m19:01:30.272863 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 12
invalid identifier 'CREATED_AT'
[0m19:01:30.278089 [debug] [Thread-2 (]: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'CREATED_AT'
[0m19:01:30.281034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba11c70>]}
[0m19:01:30.281593 [error] [Thread-2 (]: 1 of 3 ERROR snapshotting gold.dim_bookings .................................... [[31mERROR[0m in 0.14s]
[0m19:01:30.281974 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:01:30.282215 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:01:30.282532 [debug] [Thread-5 (]: Marking all children of 'snapshot.dbt_snowflake_aws_project.dim_bookings' to be skipped because of status 'error'.  Reason: Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'CREATED_AT'.
[0m19:01:30.282843 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m19:01:30.283645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:01:30.283922 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:01:30.287383 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:30.289725 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:01:30.295325 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:30.295560 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:30.349820 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.054 seconds
[0m19:01:30.378985 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:30.379286 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:01:31.195947 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m19:01:31.202240 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.202850 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.281797 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.078 seconds
[0m19:01:31.288981 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.289544 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.351834 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.062 seconds
[0m19:01:31.356012 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.356420 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.436489 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m19:01:31.438618 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.438820 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.496027 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.057 seconds
[0m19:01:31.501717 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.502000 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.562819 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.060 seconds
[0m19:01:31.579705 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.580202 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.723824 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.143 seconds
[0m19:01:31.731716 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.732167 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.784445 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.052 seconds
[0m19:01:31.785925 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.791367 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.792097 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:31.871051 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m19:01:31.872556 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:31.873730 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:01:32.342512 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.468 seconds
[0m19:01:32.343737 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:01:32.344351 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:01:32.578215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m19:01:32.604694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b913c20>]}
[0m19:01:32.605386 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 0[0m in 2.32s]
[0m19:01:32.605834 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:01:32.606132 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:01:32.606529 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m19:01:32.606864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:01:32.607116 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:01:32.610942 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:32.614911 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:01:32.619448 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:32.619813 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:32.686618 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.066 seconds
[0m19:01:32.692305 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:32.692764 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:01:33.365238 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m19:01:33.370417 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.371098 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.437911 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.066 seconds
[0m19:01:33.443906 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.444287 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.507326 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.062 seconds
[0m19:01:33.514677 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.515274 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.574266 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.058 seconds
[0m19:01:33.580241 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.580736 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.639932 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.059 seconds
[0m19:01:33.646281 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.646824 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.723723 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.076 seconds
[0m19:01:33.730503 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.731137 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.927135 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.195 seconds
[0m19:01:33.929577 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.930291 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:33.989719 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.059 seconds
[0m19:01:33.991407 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.997543 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:33.998213 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:34.086359 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m19:01:34.087668 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:34.088347 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:01:34.696315 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.607 seconds
[0m19:01:34.697579 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:01:34.698207 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:01:34.917622 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m19:01:34.922742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd30828b8-7664-4db8-9509-414db29fd9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae9880>]}
[0m19:01:34.923941 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 2.32s]
[0m19:01:34.924781 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:01:34.926773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:34.927151 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:01:34.927480 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:01:35.017168 [info ] [MainThread]: 
[0m19:01:35.017674 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m19:01:35.018627 [debug] [MainThread]: Command end result
[0m19:01:35.041328 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:01:35.047227 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:01:35.051420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:01:35.051608 [info ] [MainThread]: 
[0m19:01:35.051807 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:01:35.051967 [info ] [MainThread]: 
[0m19:01:35.052170 [error] [MainThread]: [31mFailure in snapshot dim_bookings (snapshots/dim_bookings.yml)[0m
[0m19:01:35.052349 [error] [MainThread]:   Database Error in snapshot dim_bookings (snapshots/dim_bookings.yml)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'CREATED_AT'
[0m19:01:35.052501 [info ] [MainThread]: 
[0m19:01:35.052657 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m19:01:35.052989 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 8.019025, "process_in_blocks": "0", "process_kernel_time": 0.861496, "process_mem_max_rss": "161316864", "process_out_blocks": "0", "process_user_time": 2.195471}
[0m19:01:35.053227 [debug] [MainThread]: Command `dbt snapshot` failed at 19:01:35.053182 after 8.02 seconds
[0m19:01:35.053431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61e8a0>]}
[0m19:01:35.053615 [debug] [MainThread]: Flushing usage events
[0m19:01:35.998984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:45.049035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109273920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd1670>]}


============================== 19:04:45.052573 | b4a5c25e-1703-4191-83e0-584c88b51c44 ==============================
[0m19:04:45.052573 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:04:45.052875 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt run --select models/silver', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'log_format': 'default'}
[0m19:04:45.361036 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:04:45.361292 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:04:45.361430 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:04:45.447321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dc140>]}
[0m19:04:45.500716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee6930>]}
[0m19:04:45.501737 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:04:45.571125 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:04:45.716244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:45.716480 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:04:45.716599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:45.747983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b9d30>]}
[0m19:04:45.796035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:04:45.798838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:04:45.827297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9fad0>]}
[0m19:04:45.827571 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:04:45.827724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bea330>]}
[0m19:04:45.829163 [info ] [MainThread]: 
[0m19:04:45.829316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:45.829420 [info ] [MainThread]: 
[0m19:04:45.829625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:45.831416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:04:46.019880 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:04:46.020103 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:04:46.020231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:46.685309 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.665 seconds
[0m19:04:46.688687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:04:46.701877 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:04:46.702073 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:04:46.767658 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.065 seconds
[0m19:04:46.770204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:04:46.773345 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:04:46.773853 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:04:46.900925 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.127 seconds
[0m19:04:46.902997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:04:46.907344 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:04:46.907886 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:04:46.980210 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.072 seconds
[0m19:04:46.981724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_gold)
[0m19:04:46.983787 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:04:46.984052 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:04:47.064711 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.080 seconds
[0m19:04:47.066434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ae630>]}
[0m19:04:47.070096 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:04:47.070524 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m19:04:47.070872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now model.dbt_snowflake_aws_project.silver_bookings)
[0m19:04:47.071100 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m19:04:47.077733 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:04:47.086479 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m19:04:47.120413 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:04:47.121931 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:04:47.122111 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace transient table AIRBNB_PRO.silver.silver_bookings
    
    
    
    as (

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_amount,
    CREATED_AT
from
    AIRBNB_PRO.semi_raw.bookings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:04:47.722079 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m19:04:47.732690 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m19:04:47.741697 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:04:47.742267 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:04:47.810572 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m19:04:47.836515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a93a0>]}
[0m19:04:47.837157 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 1[0m in 0.76s]
[0m19:04:47.837611 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:04:47.837915 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:04:47.838300 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m19:04:47.838616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m19:04:47.838861 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m19:04:47.841316 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:47.849912 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m19:04:47.856155 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:47.856413 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:04:48.001934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m19:04:48.014295 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.015055 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:04:48.097427 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.082 seconds
[0m19:04:48.103874 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.104630 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:04:48.160938 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.056 seconds
[0m19:04:48.173764 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.174509 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:04:48.250828 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m19:04:48.288163 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.290130 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.290380 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:04:48.357213 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m19:04:48.357697 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.358161 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:04:48.861167 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.502 seconds
[0m19:04:48.862547 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:48.863302 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:04:49.048231 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m19:04:49.054227 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m19:04:49.055770 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:04:49.056293 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:04:49.158432 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m19:04:49.162772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae2b10>]}
[0m19:04:49.163869 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.32s]
[0m19:04:49.164745 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:04:49.165335 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m19:04:49.166005 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m19:04:49.166626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m19:04:49.167032 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m19:04:49.172519 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.189706 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m19:04:49.193180 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.193495 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:04:49.337205 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m19:04:49.342783 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.343607 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:04:49.415079 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.071 seconds
[0m19:04:49.422984 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.423750 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:04:49.483055 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.059 seconds
[0m19:04:49.490287 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.490982 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:04:49.547176 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.055 seconds
[0m19:04:49.554702 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.559370 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.560013 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:04:49.648009 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m19:04:49.649392 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:49.650198 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:04:50.171666 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.521 seconds
[0m19:04:50.172789 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:50.173426 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:04:50.322904 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m19:04:50.328867 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m19:04:50.330254 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:04:50.330839 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:04:50.442891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m19:04:50.446241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a5c25e-1703-4191-83e0-584c88b51c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb228d0>]}
[0m19:04:50.447421 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.28s]
[0m19:04:50.448455 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m19:04:50.450276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:50.450706 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m19:04:50.451050 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m19:04:50.538556 [info ] [MainThread]: 
[0m19:04:50.539333 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m19:04:50.540410 [debug] [MainThread]: Command end result
[0m19:04:50.564317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:04:50.570353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:04:50.575021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:04:50.575223 [info ] [MainThread]: 
[0m19:04:50.575434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:50.575597 [info ] [MainThread]: 
[0m19:04:50.575778 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:04:50.576133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5667663, "process_in_blocks": "0", "process_kernel_time": 0.839029, "process_mem_max_rss": "160694272", "process_out_blocks": "0", "process_user_time": 1.945732}
[0m19:04:50.576382 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:50.576334 after 5.57 seconds
[0m19:04:50.576587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100807170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dfd40>]}
[0m19:04:50.576779 [debug] [MainThread]: Flushing usage events
[0m19:04:51.817362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:59.025995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d4170>]}


============================== 19:04:59.030809 | 7798b001-7bd6-4b6f-8063-cb04d5f12414 ==============================
[0m19:04:59.030809 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:04:59.031164 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'invocation_command': 'dbt run --select models/gold', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m19:05:00.214749 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:05:00.216047 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:05:00.216660 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:05:00.382206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb06de0>]}
[0m19:05:00.426076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b801490>]}
[0m19:05:00.428750 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:05:00.498780 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:05:00.678642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:00.678878 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:05:00.679012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:00.702216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c550dd0>]}
[0m19:05:00.740041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:05:00.746059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:05:00.804742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d7f80>]}
[0m19:05:00.804988 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:05:00.805147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b3d40>]}
[0m19:05:00.806932 [info ] [MainThread]: 
[0m19:05:00.807093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:00.807208 [info ] [MainThread]: 
[0m19:05:00.807435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:00.807845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:05:01.214347 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:05:01.215182 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:05:01.215620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:02.406082 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.190 seconds
[0m19:05:02.416029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:05:02.428483 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:05:02.428813 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:05:02.673649 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.244 seconds
[0m19:05:02.677630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:05:02.682325 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:05:02.682814 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:05:02.769986 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m19:05:02.774228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m19:05:02.777948 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:05:02.778396 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:05:02.980740 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.202 seconds
[0m19:05:02.984831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:05:02.989647 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:05:02.990097 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:05:03.136081 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.146 seconds
[0m19:05:03.139846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d4d40>]}
[0m19:05:03.149610 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:05:03.150359 [info ] [Thread-2 (]: 1 of 1 START sql table model gold.obt .......................................... [RUN]
[0m19:05:03.151115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.obt)
[0m19:05:03.151770 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:05:03.162196 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:05:03.164757 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:05:03.183930 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:05:03.200557 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:05:03.200844 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:05:04.107169 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m19:05:04.135649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7798b001-7bd6-4b6f-8063-cb04d5f12414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef13a0>]}
[0m19:05:04.136237 [info ] [Thread-2 (]: 1 of 1 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.98s]
[0m19:05:04.136680 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:05:04.137331 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:05:04.137695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:05:04.137990 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:05:04.140149 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:05:04.154302 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:05:04.154832 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:05:04.155450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:05:04.155843 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:05:04.159062 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:05:04.166401 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:05:04.166687 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:05:04.167068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:05:04.167556 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:05:04.170108 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:05:04.177676 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:05:04.178292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:04.178428 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:05:04.178548 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:05:04.286795 [info ] [MainThread]: 
[0m19:05:04.287273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m19:05:04.287991 [debug] [MainThread]: Command end result
[0m19:05:04.309082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:05:04.319693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:05:04.324697 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:05:04.324894 [info ] [MainThread]: 
[0m19:05:04.325116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:04.325275 [info ] [MainThread]: 
[0m19:05:04.325453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:05:04.325805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.367608, "process_in_blocks": "0", "process_kernel_time": 0.932571, "process_mem_max_rss": "159842304", "process_out_blocks": "0", "process_user_time": 1.916557}
[0m19:05:04.326072 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:04.326019 after 5.37 seconds
[0m19:05:04.326276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb13020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37c980>]}
[0m19:05:04.326479 [debug] [MainThread]: Flushing usage events
[0m19:05:05.264667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:11.921068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae667e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ed580>]}


============================== 19:05:11.925706 | ad2eb552-ed6a-49a3-9b75-14d4902cac63 ==============================
[0m19:05:11.925706 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:05:11.926035 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'static_parser': 'True'}
[0m19:05:12.727253 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:05:12.728546 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:05:12.729198 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:05:12.884685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c297110>]}
[0m19:05:12.927561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ec6b0>]}
[0m19:05:12.930243 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:05:12.998578 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:05:13.174258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:13.174493 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:05:13.174620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:13.196935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c434080>]}
[0m19:05:13.233502 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:05:13.236388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:05:13.265642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e6d50>]}
[0m19:05:13.265867 [info ] [MainThread]: Found 10 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:05:13.266011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ef6480>]}
[0m19:05:13.266839 [info ] [MainThread]: 
[0m19:05:13.266980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:13.267084 [info ] [MainThread]: 
[0m19:05:13.267290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:13.268976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:05:13.518849 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:05:13.519214 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:05:13.519437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:14.272321 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.752 seconds
[0m19:05:14.276182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB)
[0m19:05:14.280054 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:05:14.280666 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m19:05:14.347000 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.066 seconds
[0m19:05:14.351807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_gold)
[0m19:05:14.364377 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:05:14.364788 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:05:14.441742 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.077 seconds
[0m19:05:14.443604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:05:14.446209 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:05:14.446508 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:05:14.587664 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.141 seconds
[0m19:05:14.590089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:05:14.593762 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:05:14.594219 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:05:14.713234 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m19:05:14.717357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:05:14.721430 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:05:14.721950 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:05:14.840887 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.118 seconds
[0m19:05:14.845690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fed5b0>]}
[0m19:05:14.855580 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:05:14.856438 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:05:14.857089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:05:14.857524 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:05:14.868755 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:05:14.873268 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:05:14.913997 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:05:14.914248 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:05:15.087768 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.173 seconds
[0m19:05:15.097491 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:05:15.098137 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:05:15.330437 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.231 seconds
[0m19:05:15.331949 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:05:15.339100 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:05:15.339650 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace transient table AIRBNB_PRO.gold.dim_bookings
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:05:16.069567 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m19:05:16.094881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09190>]}
[0m19:05:16.095487 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 1[0m in 1.23s]
[0m19:05:16.095877 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:05:16.096140 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:05:16.096480 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m19:05:16.096789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:05:16.097028 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:05:16.100326 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.103007 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:05:16.109054 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.109323 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:16.180217 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m19:05:16.212825 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.213160 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:05:16.805030 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m19:05:16.811041 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.811673 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:16.885329 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.073 seconds
[0m19:05:16.892416 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.892991 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:16.951452 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.058 seconds
[0m19:05:16.958374 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:16.958902 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.023964 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.064 seconds
[0m19:05:17.029957 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.030510 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.087672 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.057 seconds
[0m19:05:17.095677 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.096031 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.157398 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.061 seconds
[0m19:05:17.168148 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.168490 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.292316 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.123 seconds
[0m19:05:17.293890 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.294305 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.350414 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.055 seconds
[0m19:05:17.352033 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.373664 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.374571 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:17.463350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m19:05:17.464865 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.465650 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:05:17.930825 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.464 seconds
[0m19:05:17.932011 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:05:17.932677 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:05:18.088901 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m19:05:18.096920 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a2e70>]}
[0m19:05:18.098126 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 0[0m in 2.00s]
[0m19:05:18.098960 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:05:18.099513 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:05:18.100131 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m19:05:18.100715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:05:18.101137 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:05:18.108330 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:18.112506 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:05:18.118288 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:18.118719 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:18.179708 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.061 seconds
[0m19:05:18.185878 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:18.186530 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:05:18.888267 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m19:05:18.895512 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:18.896335 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:18.977930 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.081 seconds
[0m19:05:18.984805 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:18.985336 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.041963 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.056 seconds
[0m19:05:19.049392 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.049960 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.123806 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.073 seconds
[0m19:05:19.130098 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.130571 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.192539 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.061 seconds
[0m19:05:19.200473 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.201121 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.262486 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.061 seconds
[0m19:05:19.269253 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.269940 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.407115 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.136 seconds
[0m19:05:19.409533 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.410263 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.471925 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.061 seconds
[0m19:05:19.473503 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.496150 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.497006 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:19.576370 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m19:05:19.576749 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.577006 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:05:19.980395 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.403 seconds
[0m19:05:19.981713 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:05:19.982327 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:05:20.146230 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m19:05:20.149869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2eb552-ed6a-49a3-9b75-14d4902cac63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11300b9e0>]}
[0m19:05:20.150796 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 2.05s]
[0m19:05:20.151779 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:05:20.153362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:20.153781 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:05:20.154112 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:05:20.238932 [info ] [MainThread]: 
[0m19:05:20.239518 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m19:05:20.240528 [debug] [MainThread]: Command end result
[0m19:05:20.264406 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:05:20.274758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:05:20.280031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:05:20.280227 [info ] [MainThread]: 
[0m19:05:20.280458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:20.280617 [info ] [MainThread]: 
[0m19:05:20.280790 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:05:20.281132 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.426526, "process_in_blocks": "0", "process_kernel_time": 0.817067, "process_mem_max_rss": "161087488", "process_out_blocks": "0", "process_user_time": 2.284536}
[0m19:05:20.281385 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:05:20.281334 after 8.43 seconds
[0m19:05:20.281593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59e0c0>]}
[0m19:05:20.281794 [debug] [MainThread]: Flushing usage events
[0m19:05:21.412429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:46.272209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3284a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d990500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d990260>]}


============================== 19:13:46.277451 | f9eb355d-78e1-4e92-930a-dd61a28d250f ==============================
[0m19:13:46.277451 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:13:46.277828 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select models/gold', 'debug': 'False', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m19:13:47.235992 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:13:47.237139 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:13:47.237707 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:13:47.394422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e581280>]}
[0m19:13:47.437901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d052ba0>]}
[0m19:13:47.440872 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:13:47.520094 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:13:47.698057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:47.698320 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:13:47.698448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:47.720745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e985460>]}
[0m19:13:47.756762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:13:47.759772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:13:47.792458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdb0e0>]}
[0m19:13:47.792678 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:13:47.792821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e728a40>]}
[0m19:13:47.794102 [info ] [MainThread]: 
[0m19:13:47.794242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:47.794344 [info ] [MainThread]: 
[0m19:13:47.794533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:47.796130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:13:48.006278 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:13:48.006473 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:13:48.006584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:49.014332 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.008 seconds
[0m19:13:49.016433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:13:49.024389 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:13:49.024620 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:13:49.100508 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.076 seconds
[0m19:13:49.102844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:13:49.105216 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:13:49.105468 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:13:49.183582 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.078 seconds
[0m19:13:49.186182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m19:13:49.189668 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:13:49.190191 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:13:49.261766 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.071 seconds
[0m19:13:49.263775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_gold)
[0m19:13:49.266495 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:13:49.266783 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:13:49.386910 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.120 seconds
[0m19:13:49.391240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4369c0>]}
[0m19:13:49.404761 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:13:49.405566 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:13:49.406026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:13:49.406369 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:13:49.416051 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:13:49.418780 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:13:49.439623 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:13:49.442108 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:13:49.442346 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.TOTAL_AMOUNT, GOLD_obt.SERVICE_FEE, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:13:49.522398 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c21417-0001-88f0-000c-0f1600038096
[0m19:13:49.522744 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB_PRO.GOLD.DIM_LISTINGS' does not exist or not authorized.
[0m19:13:49.528006 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.DIM_LISTINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:13:49.531640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdd310>]}
[0m19:13:49.532124 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.12s]
[0m19:13:49.532525 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:13:49.532801 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:13:49.533233 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.DIM_LISTINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:13:49.533665 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:13:49.534624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:13:49.534919 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:13:49.539405 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:13:49.547705 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:13:49.549840 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:13:49.552232 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:13:49.552536 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:13:50.344933 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m19:13:50.366990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eb355d-78e1-4e92-930a-dd61a28d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2694c0>]}
[0m19:13:50.367446 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.83s]
[0m19:13:50.367805 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:13:50.368373 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:13:50.368655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:13:50.368900 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:13:50.370961 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:13:50.386089 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:13:50.386332 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:13:50.386573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:13:50.386792 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:13:50.388621 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:13:50.401682 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:13:50.401919 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:13:50.402195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:13:50.402467 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:13:50.404394 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:13:50.415441 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:13:50.416131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:50.416320 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:13:50.416493 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:13:50.500743 [info ] [MainThread]: 
[0m19:13:50.501495 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m19:13:50.502542 [debug] [MainThread]: Command end result
[0m19:13:50.526142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:13:50.536643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:13:50.542374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:13:50.542586 [info ] [MainThread]: 
[0m19:13:50.542807 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:13:50.542986 [info ] [MainThread]: 
[0m19:13:50.543215 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:13:50.543432 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.DIM_LISTINGS' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:13:50.543595 [info ] [MainThread]: 
[0m19:13:50.543785 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:13:50.543944 [info ] [MainThread]: 
[0m19:13:50.544128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:13:50.544536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3385634, "process_in_blocks": "0", "process_kernel_time": 0.803613, "process_mem_max_rss": "160382976", "process_out_blocks": "0", "process_user_time": 1.671904}
[0m19:13:50.544823 [debug] [MainThread]: Command `dbt run` failed at 19:13:50.544771 after 4.34 seconds
[0m19:13:50.545066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d14d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d3b60>]}
[0m19:13:50.545289 [debug] [MainThread]: Flushing usage events
[0m19:13:51.780050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:07.568402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cd4c0>]}


============================== 19:14:07.571776 | 9bb45ef0-ef47-44e8-b781-8f8d81f4080d ==============================
[0m19:14:07.571776 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:14:07.572035 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m19:14:07.883617 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:14:07.883938 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:14:07.884118 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:14:07.992915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec3560>]}
[0m19:14:08.041785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf4e180>]}
[0m19:14:08.043084 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:14:08.108335 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:14:08.247233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:08.247448 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:14:08.247561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:08.267810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4fd4f0>]}
[0m19:14:08.303969 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:14:08.306307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:14:08.328588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c757800>]}
[0m19:14:08.328809 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:14:08.328951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38c740>]}
[0m19:14:08.329776 [info ] [MainThread]: 
[0m19:14:08.329916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:08.330024 [info ] [MainThread]: 
[0m19:14:08.330226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:08.331924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:14:08.557909 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:14:08.558143 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m19:14:08.558279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:09.392640 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.834 seconds
[0m19:14:09.396688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO)
[0m19:14:09.401954 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:14:09.402543 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:14:09.472275 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.069 seconds
[0m19:14:09.478628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:14:09.495897 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:14:09.496382 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:14:09.589552 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.093 seconds
[0m19:14:09.590920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:14:09.592748 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:14:09.592959 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:14:09.664566 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.071 seconds
[0m19:14:09.666372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_gold)
[0m19:14:09.668876 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:14:09.669158 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:14:09.733065 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.064 seconds
[0m19:14:09.736085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now list_AIRBNB_PRO_silver)
[0m19:14:09.739620 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:14:09.740163 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:14:09.833625 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.093 seconds
[0m19:14:09.837829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f1dc0>]}
[0m19:14:09.848705 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:09.849685 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:14:09.850265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:14:09.850634 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:09.862279 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:09.865151 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:09.894033 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:09.894313 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:09.954597 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.060 seconds
[0m19:14:09.984614 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:09.984933 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:14:10.581725 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m19:14:10.588873 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.589696 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:10.668296 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m19:14:10.674812 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.675402 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:10.731431 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.056 seconds
[0m19:14:10.734543 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.734805 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:10.790862 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.056 seconds
[0m19:14:10.793837 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.794065 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:10.847039 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.053 seconds
[0m19:14:10.852937 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.853251 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:10.909274 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.056 seconds
[0m19:14:10.931505 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:10.931910 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:11.160177 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.228 seconds
[0m19:14:11.169498 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:11.169964 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:11.222574 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.052 seconds
[0m19:14:11.224111 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:11.231835 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:11.232541 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:11.322624 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m19:14:11.323904 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:11.324634 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: merge into "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:14:11.746611 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.421 seconds
[0m19:14:11.747817 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:11.748479 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:11.969318 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m19:14:11.999386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de9340>]}
[0m19:14:12.000154 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 0[0m in 2.14s]
[0m19:14:12.000616 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:12.000912 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:14:12.001316 [info ] [Thread-2 (]: 2 of 3 START snapshot AIRBNB.gold.dim_hosts .................................... [RUN]
[0m19:14:12.001678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:14:12.001940 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:14:12.005561 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.008942 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:14:12.011818 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.012059 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.076144 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.064 seconds
[0m19:14:12.080861 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.081274 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:14:12.545383 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m19:14:12.546709 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.546880 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.612387 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.065 seconds
[0m19:14:12.614610 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.614835 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.667935 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.053 seconds
[0m19:14:12.671030 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.671322 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.731240 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.060 seconds
[0m19:14:12.736589 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.737142 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.791560 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.054 seconds
[0m19:14:12.795505 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.795820 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.855348 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.059 seconds
[0m19:14:12.861729 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.862288 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:12.986200 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.123 seconds
[0m19:14:12.988559 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:12.989243 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:13.048216 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.058 seconds
[0m19:14:13.049640 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:13.057095 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:13.057949 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:13.137601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m19:14:13.138687 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:13.139417 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:14:13.569876 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.430 seconds
[0m19:14:13.571121 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:14:13.571813 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:14:13.745121 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m19:14:13.749680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ef230>]}
[0m19:14:13.750855 [info ] [Thread-2 (]: 2 of 3 OK snapshotted AIRBNB.gold.dim_hosts .................................... [[32mSUCCESS 0[0m in 1.75s]
[0m19:14:13.751606 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:14:13.752125 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:14:13.752729 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m19:14:13.753331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:14:13.753735 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:14:13.760478 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:13.764617 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:14:13.768502 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:13.768937 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:13.826548 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.057 seconds
[0m19:14:13.831905 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:13.832368 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:14:14.215894 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m19:14:14.223116 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.223689 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.297355 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.073 seconds
[0m19:14:14.302736 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.303191 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.364610 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.061 seconds
[0m19:14:14.372501 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.373230 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.434662 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.061 seconds
[0m19:14:14.441926 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.442575 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.498247 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.055 seconds
[0m19:14:14.506019 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.506641 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.568200 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.061 seconds
[0m19:14:14.577702 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.578677 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.688756 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m19:14:14.689599 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.689862 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.748785 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.059 seconds
[0m19:14:14.749795 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.754358 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.754768 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:14.832056 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m19:14:14.833380 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:14.834110 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:14:15.323297 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.488 seconds
[0m19:14:15.324807 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:14:15.325479 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:14:15.492646 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m19:14:15.496493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb45ef0-ef47-44e8-b781-8f8d81f4080d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113150830>]}
[0m19:14:15.497705 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 1.74s]
[0m19:14:15.498517 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:14:15.500458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:15.500883 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:14:15.501206 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:14:15.586868 [info ] [MainThread]: 
[0m19:14:15.587497 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m19:14:15.588510 [debug] [MainThread]: Command end result
[0m19:14:15.611824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:14:15.622890 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:14:15.628190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:14:15.628383 [info ] [MainThread]: 
[0m19:14:15.628598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:15.628757 [info ] [MainThread]: 
[0m19:14:15.628932 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:14:15.629287 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.104635, "process_in_blocks": "0", "process_kernel_time": 0.349128, "process_mem_max_rss": "161742848", "process_out_blocks": "0", "process_user_time": 1.644876}
[0m19:14:15.629557 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:14:15.629503 after 8.10 seconds
[0m19:14:15.629774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c470e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4dbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4dbef0>]}
[0m19:14:15.629973 [debug] [MainThread]: Flushing usage events
[0m19:14:16.765479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:55.353938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5bf20>]}


============================== 19:14:55.359583 | 104a9f91-0428-4ff4-8cf9-3e62e50c5ccd ==============================
[0m19:14:55.359583 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:14:55.359922 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True'}
[0m19:14:56.326616 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:14:56.326952 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:14:56.327126 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:14:56.444113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf3ec0>]}
[0m19:14:56.489266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13ddc0>]}
[0m19:14:56.491846 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:14:56.561015 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:14:56.731314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:56.731690 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://snapshots/dim_hosts.yml
[0m19:14:56.837436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf2150>]}
[0m19:14:56.874261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:14:56.880476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:14:56.939889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d37f890>]}
[0m19:14:56.940142 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:14:56.940303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d032b10>]}
[0m19:14:56.941290 [info ] [MainThread]: 
[0m19:14:56.941452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:56.941573 [info ] [MainThread]: 
[0m19:14:56.941794 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:56.943765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:14:57.356589 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:14:57.357303 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:14:57.357743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:58.166691 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.809 seconds
[0m19:14:58.168296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB)
[0m19:14:58.170258 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:14:58.170523 [debug] [ThreadPool]: On list_AIRBNB: show terse schemas in database AIRBNB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB"} */
[0m19:14:58.233544 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.063 seconds
[0m19:14:58.237222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_PRO_silver)
[0m19:14:58.248890 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:14:58.249242 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:14:58.316531 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.067 seconds
[0m19:14:58.319241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:14:58.324831 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:14:58.325252 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:14:58.395965 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.070 seconds
[0m19:14:58.398795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:14:58.402133 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:14:58.402512 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:14:58.472709 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.070 seconds
[0m19:14:58.476514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_gold)
[0m19:14:58.481605 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_gold"
[0m19:14:58.482100 [debug] [ThreadPool]: On list_AIRBNB_gold: show objects in AIRBNB.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_gold"} */;
[0m19:14:58.565155 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.082 seconds
[0m19:14:58.569793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f3110>]}
[0m19:14:58.581734 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:58.582833 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:14:58.583575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_gold, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:14:58.584093 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:58.595659 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:58.609033 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:14:58.642073 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:58.642375 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:58.701209 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.059 seconds
[0m19:14:58.734162 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:58.734476 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:14:59.172005 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m19:14:59.177849 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.178352 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.240717 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.062 seconds
[0m19:14:59.248287 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.248929 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.310181 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.060 seconds
[0m19:14:59.316115 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.316640 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.375479 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.058 seconds
[0m19:14:59.383245 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.383916 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.442401 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.058 seconds
[0m19:14:59.454996 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.455589 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.515740 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.059 seconds
[0m19:14:59.546373 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.546913 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.686469 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.139 seconds
[0m19:14:59.694740 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.695214 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.759797 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.064 seconds
[0m19:14:59.762001 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.781733 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.782340 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:14:59.870348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m19:14:59.871373 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:14:59.872090 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: merge into "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:15:00.425094 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.552 seconds
[0m19:15:00.426273 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:15:00.426899 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:15:00.852017 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m19:15:00.883116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb9280>]}
[0m19:15:00.883884 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 0[0m in 2.29s]
[0m19:15:00.884340 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:15:00.884638 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:15:00.885061 [info ] [Thread-2 (]: 2 of 3 START snapshot gold.dim_hosts ........................................... [RUN]
[0m19:15:00.885441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:15:00.885700 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:15:00.891077 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:15:00.903025 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:15:00.911932 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:15:00.912211 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    

    select *,
        md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        HOST_CREATED_AT as dbt_updated_at,
        HOST_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:15:01.099209 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.186 seconds
[0m19:15:01.101618 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:15:01.102277 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:15:01.192895 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m19:15:01.194355 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:15:01.213682 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:15:01.214714 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace transient table AIRBNB_PRO.gold.dim_hosts
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        HOST_CREATED_AT as dbt_updated_at,
        HOST_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:15:02.333935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.118 seconds
[0m19:15:02.341886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c4980>]}
[0m19:15:02.342855 [info ] [Thread-2 (]: 2 of 3 OK snapshotted gold.dim_hosts ........................................... [[32mSUCCESS 1[0m in 1.46s]
[0m19:15:02.343462 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:15:02.343852 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:15:02.344263 [info ] [Thread-2 (]: 3 of 3 START snapshot AIRBNB.gold.dim_listings ................................. [RUN]
[0m19:15:02.344777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:15:02.345209 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:15:02.350622 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:02.367351 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:15:02.371154 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:02.371474 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:02.440235 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.068 seconds
[0m19:15:02.447053 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:02.447548 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:15:05.406884 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.959 seconds
[0m19:15:05.412892 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:05.413645 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:05.714906 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.300 seconds
[0m19:15:05.721303 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:05.721816 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:05.819501 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m19:15:05.828863 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:05.829478 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:05.945738 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m19:15:05.952986 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:05.953585 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:06.070488 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.116 seconds
[0m19:15:06.078535 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:06.079170 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:06.287875 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.208 seconds
[0m19:15:06.295207 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:06.295866 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:07.148171 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.851 seconds
[0m19:15:07.150358 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:07.151002 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:07.307447 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.155 seconds
[0m19:15:07.309676 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:07.330320 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:07.330816 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:07.602880 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m19:15:07.604355 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:07.605058 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:15:08.476458 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.871 seconds
[0m19:15:08.477435 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:15:08.478000 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:15:09.194716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m19:15:09.198872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a9f91-0428-4ff4-8cf9-3e62e50c5ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c4c80>]}
[0m19:15:09.200059 [info ] [Thread-2 (]: 3 of 3 OK snapshotted AIRBNB.gold.dim_listings ................................. [[32mSUCCESS 0[0m in 6.85s]
[0m19:15:09.200835 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:15:09.203043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:09.203465 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:15:09.203824 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:15:09.422877 [info ] [MainThread]: 
[0m19:15:09.423948 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 12.48 seconds (12.48s).
[0m19:15:09.425710 [debug] [MainThread]: Command end result
[0m19:15:09.500302 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:15:09.511056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:15:09.514948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:15:09.515094 [info ] [MainThread]: 
[0m19:15:09.515270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:09.515388 [info ] [MainThread]: 
[0m19:15:09.515517 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:15:09.515805 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.229417, "process_in_blocks": "0", "process_kernel_time": 1.014762, "process_mem_max_rss": "167428096", "process_out_blocks": "0", "process_user_time": 2.417871}
[0m19:15:09.515995 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:15:09.515957 after 14.23 seconds
[0m19:15:09.516153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e418c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41ba40>]}
[0m19:15:09.516306 [debug] [MainThread]: Flushing usage events
[0m19:15:10.674528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:08.768063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb35400>]}


============================== 19:16:08.772918 | 548ed8d5-63ad-4ed7-ba5b-5841581bad16 ==============================
[0m19:16:08.772918 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:16:08.773262 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m19:16:09.811709 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:16:09.812827 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:16:09.813520 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:16:09.961854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e31a330>]}
[0m19:16:10.006283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4365d0>]}
[0m19:16:10.008667 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:16:10.079625 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:16:10.253618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:10.253999 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://snapshots/dim_listings.yml
[0m19:16:10.362853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac15b0>]}
[0m19:16:10.400702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:16:10.406747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:16:10.472440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecdc200>]}
[0m19:16:10.472719 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:16:10.472896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e87af90>]}
[0m19:16:10.473944 [info ] [MainThread]: 
[0m19:16:10.474116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:10.474247 [info ] [MainThread]: 
[0m19:16:10.474496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:10.476559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:16:10.773592 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:16:10.774011 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:16:10.774285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:11.747270 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.973 seconds
[0m19:16:11.750552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:16:11.761188 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:16:11.761494 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:16:11.967028 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.205 seconds
[0m19:16:11.971444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:16:11.976255 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:16:11.976683 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:16:12.166093 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.189 seconds
[0m19:16:12.170239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:16:12.177834 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:16:12.178360 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:16:12.349646 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.171 seconds
[0m19:16:12.354874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e527a70>]}
[0m19:16:12.366281 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:16:12.367285 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:16:12.368047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:16:12.368554 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:16:12.380227 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:12.382751 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:16:12.413524 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:12.413798 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:12.475944 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.062 seconds
[0m19:16:12.506874 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:12.507188 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:16:14.205452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m19:16:14.214019 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.214543 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:14.425756 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.211 seconds
[0m19:16:14.431083 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.431535 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:14.508313 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.076 seconds
[0m19:16:14.515031 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.515541 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:14.589906 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.074 seconds
[0m19:16:14.597414 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.598005 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:14.699723 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.101 seconds
[0m19:16:14.709930 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.710454 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:14.807284 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.096 seconds
[0m19:16:14.829943 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:14.830349 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:15.034389 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.203 seconds
[0m19:16:15.042628 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:15.043158 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:15.129766 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m19:16:15.131505 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:15.136803 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:15.137307 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:15.252479 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m19:16:15.253861 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:15.254542 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: merge into "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:16:16.369675 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 1.114 seconds
[0m19:16:16.370893 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:16:16.371544 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:16:16.582448 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m19:16:16.611687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b094e30>]}
[0m19:16:16.612330 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 0[0m in 4.24s]
[0m19:16:16.612723 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:16:16.612984 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:16:16.613346 [info ] [Thread-2 (]: 2 of 3 START snapshot gold.dim_hosts ........................................... [RUN]
[0m19:16:16.613695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:16:16.613935 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:16:16.617427 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:16.620186 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:16:16.624157 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:16.624498 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:16.696297 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m19:16:16.699925 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:16.700243 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:16:17.377187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m19:16:17.383146 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.383782 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.482696 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.098 seconds
[0m19:16:17.489820 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.490442 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.555721 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.065 seconds
[0m19:16:17.563594 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.564211 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.640285 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.075 seconds
[0m19:16:17.646522 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.647239 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.705962 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.058 seconds
[0m19:16:17.713508 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.714155 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.824656 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.110 seconds
[0m19:16:17.832853 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.833589 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:17.980358 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.146 seconds
[0m19:16:17.982593 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:17.983201 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:18.046881 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.063 seconds
[0m19:16:18.048611 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:18.054744 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:18.055289 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:18.142017 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m19:16:18.143500 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:18.144304 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB_PRO"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:16:18.632983 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.488 seconds
[0m19:16:18.634137 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:16:18.634821 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:16:18.843315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m19:16:18.847455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe7c290>]}
[0m19:16:18.848566 [info ] [Thread-2 (]: 2 of 3 OK snapshotted gold.dim_hosts ........................................... [[32mSUCCESS 0[0m in 2.23s]
[0m19:16:18.849291 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:16:18.849775 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:16:18.850351 [info ] [Thread-2 (]: 3 of 3 START snapshot gold.dim_listings ........................................ [RUN]
[0m19:16:18.851066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:16:18.851615 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:16:18.857813 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:16:18.862267 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:16:18.875559 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:16:18.875880 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        LISTING_CREATED_AT as dbt_updated_at,
        LISTING_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:16:19.229866 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.353 seconds
[0m19:16:19.232278 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:16:19.233017 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:16:19.300285 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.066 seconds
[0m19:16:19.301552 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:16:19.307834 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:16:19.308593 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace transient table AIRBNB_PRO.gold.dim_listings
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id,
        LISTING_CREATED_AT as dbt_updated_at,
        LISTING_CREATED_AT as dbt_valid_from,
        
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:16:19.857621 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m19:16:19.867433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548ed8d5-63ad-4ed7-ba5b-5841581bad16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feb3c80>]}
[0m19:16:19.868652 [info ] [Thread-2 (]: 3 of 3 OK snapshotted gold.dim_listings ........................................ [[32mSUCCESS 1[0m in 1.02s]
[0m19:16:19.869418 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:16:19.871600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:19.872112 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:16:19.872426 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:16:19.950639 [info ] [MainThread]: 
[0m19:16:19.951297 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m19:16:19.952277 [debug] [MainThread]: Command end result
[0m19:16:19.974602 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:16:19.985355 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:16:19.990467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:16:19.990648 [info ] [MainThread]: 
[0m19:16:19.990863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:19.991021 [info ] [MainThread]: 
[0m19:16:19.991193 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:16:19.991561 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.291961, "process_in_blocks": "0", "process_kernel_time": 0.723235, "process_mem_max_rss": "167559168", "process_out_blocks": "0", "process_user_time": 2.116317}
[0m19:16:19.991815 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:16:19.991766 after 11.29 seconds
[0m19:16:19.992008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d536de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d47f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a70230>]}
[0m19:16:19.992209 [debug] [MainThread]: Flushing usage events
[0m19:16:21.077559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:36.349694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a892ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f4080>]}


============================== 19:16:36.354205 | 855aced4-c49b-47b7-91bd-30106b16cb57 ==============================
[0m19:16:36.354205 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:16:36.354549 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_cache_events': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select models/gold', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True'}
[0m19:16:37.448197 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:16:37.449674 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:16:37.450718 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:16:37.600887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be96540>]}
[0m19:16:37.643749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64aed0>]}
[0m19:16:37.646075 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:16:37.714989 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:16:37.886278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:37.886541 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:16:37.886674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:37.908935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c188e00>]}
[0m19:16:37.946632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:16:37.949179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:16:37.974028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6835c0>]}
[0m19:16:37.974237 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:16:37.974381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e51c0>]}
[0m19:16:37.975757 [info ] [MainThread]: 
[0m19:16:37.975891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:37.975993 [info ] [MainThread]: 
[0m19:16:37.976187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:37.977795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:16:38.230017 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:16:38.230218 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:16:38.230330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:39.005865 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.775 seconds
[0m19:16:39.012158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m19:16:39.027014 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:16:39.027411 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:16:39.204255 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.177 seconds
[0m19:16:39.206162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:16:39.208513 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:16:39.208780 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:16:39.286401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.077 seconds
[0m19:16:39.288761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:16:39.291644 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:16:39.292003 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:16:39.456012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.164 seconds
[0m19:16:39.459080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e5550>]}
[0m19:16:39.468120 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:16:39.469128 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:16:39.469615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:16:39.469961 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:16:39.480466 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:16:39.483740 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:16:39.503523 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:16:39.506768 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:16:39.507000 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.TOTAL_AMOUNT, GOLD_obt.SERVICE_FEE, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:16:39.622497 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2141a-0001-88f0-000c-0f160003851e
[0m19:16:39.623263 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 90
invalid identifier 'GOLD_OBT.SERVICE_FEE'
[0m19:16:39.628942 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:16:39.633500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5f5580>]}
[0m19:16:39.634307 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.16s]
[0m19:16:39.634931 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:16:39.635320 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:16:39.635821 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:16:39.636324 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:16:39.637489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:16:39.637856 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:16:39.644938 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:16:39.647537 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:16:39.649780 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:16:39.664047 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:16:39.664413 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:16:40.332018 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m19:16:40.359218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '855aced4-c49b-47b7-91bd-30106b16cb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c89400>]}
[0m19:16:40.359812 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.72s]
[0m19:16:40.360240 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:16:40.360886 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:16:40.361223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:16:40.361516 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:16:40.363948 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:16:40.376661 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:16:40.376950 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:16:40.377234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:16:40.377479 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:16:40.379610 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:16:40.387843 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:16:40.388074 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:16:40.388315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:16:40.388522 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:16:40.390258 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:16:40.400263 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:16:40.400968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:40.401153 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:16:40.401324 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:16:40.496364 [info ] [MainThread]: 
[0m19:16:40.497152 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m19:16:40.498137 [debug] [MainThread]: Command end result
[0m19:16:40.521798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:16:40.531911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:16:40.537372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:16:40.537589 [info ] [MainThread]: 
[0m19:16:40.537820 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:16:40.538001 [info ] [MainThread]: 
[0m19:16:40.538241 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:16:40.538459 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:16:40.538624 [info ] [MainThread]: 
[0m19:16:40.538818 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:16:40.538981 [info ] [MainThread]: 
[0m19:16:40.539174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:16:40.539541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.258454, "process_in_blocks": "0", "process_kernel_time": 0.935787, "process_mem_max_rss": "160382976", "process_out_blocks": "0", "process_user_time": 1.939805}
[0m19:16:40.539794 [debug] [MainThread]: Command `dbt run` failed at 19:16:40.539747 after 4.26 seconds
[0m19:16:40.540008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c189730>]}
[0m19:16:40.540205 [debug] [MainThread]: Flushing usage events
[0m19:16:41.765830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:09.090634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd214f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd21460>]}


============================== 19:18:09.095184 | 14cbcb77-bb49-4642-b5da-172accb13739 ==============================
[0m19:18:09.095184 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:18:09.095565 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt clean', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs'}
[0m19:18:09.173158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14cbcb77-bb49-4642-b5da-172accb13739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39dfd0>]}
[0m19:18:09.251377 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23360442, "process_in_blocks": "0", "process_kernel_time": 0.507221, "process_mem_max_rss": "111509504", "process_out_blocks": "0", "process_user_time": 1.072341}
[0m19:18:09.251631 [debug] [MainThread]: Command `dbt clean` succeeded at 19:18:09.251585 after 0.23 seconds
[0m19:18:09.251810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db3bd10>]}
[0m19:18:09.251970 [debug] [MainThread]: Flushing usage events
[0m19:18:10.443654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:18.653840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2da1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac00b0>]}


============================== 19:18:18.659662 | b02a2d15-448f-4154-b3ae-a83cb5b41ab1 ==============================
[0m19:18:18.659662 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:18:18.660042 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt run --select models/silver', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m19:18:19.328360 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:18:19.328847 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:18:19.329113 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:18:19.460711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c80af60>]}
[0m19:18:19.523788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e9430>]}
[0m19:18:19.525684 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:18:19.595920 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:18:19.597785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:18:19.597966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf1dc0>]}
[0m19:18:19.703975 [warn ] [MainThread]: [[33mWARNING[0m][UnexpectedJinjaBlockDeprecation]: Deprecated functionality
Found unexpected 'if' block tag. in file `macros/trimmer.sql`
[0m19:18:19.704257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba60f50>]}
[0m19:18:20.295754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c71e5a0>]}
[0m19:18:20.333590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:18:20.338320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:18:20.377805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd5b920>]}
[0m19:18:20.378035 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:18:20.378173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd55d90>]}
[0m19:18:20.379532 [info ] [MainThread]: 
[0m19:18:20.379668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:20.379768 [info ] [MainThread]: 
[0m19:18:20.379957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:20.381715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:18:20.699849 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:18:20.700184 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:18:20.700372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:21.482762 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.782 seconds
[0m19:18:21.488636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:18:21.503647 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:18:21.504159 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:18:21.588520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.084 seconds
[0m19:18:21.590373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:18:21.592539 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:18:21.592777 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:18:21.671299 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.078 seconds
[0m19:18:21.672651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:18:21.674571 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:18:21.674803 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:18:21.746915 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.072 seconds
[0m19:18:21.748746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f7e90>]}
[0m19:18:21.756143 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:18:21.756546 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m19:18:21.756858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.silver_bookings)
[0m19:18:21.757083 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m19:18:21.762400 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:21.765853 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m19:18:21.796477 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:21.796796 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_fee_amount,
    CREATED_AT
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:18:21.989447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:18:22.000373 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.000896 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:18:22.080481 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m19:18:22.088797 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.089493 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:18:22.174147 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.084 seconds
[0m19:18:22.185999 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.186444 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:18:22.262620 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m19:18:22.293001 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.300226 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.300464 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:18:22.370309 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m19:18:22.370800 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:18:22.371179 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","BOOKING_STATUS" = DBT_INTERNAL_SOURCE."BOOKING_STATUS","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_AMOUNT","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT", "CREATED_AT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_AMOUNT", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:18:22.496539 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2141c-0001-88b7-000c-0f16000391aa
[0m19:18:22.496909 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 95
invalid identifier 'TOTAL_AMOUNT'
[0m19:18:22.501606 [debug] [Thread-2 (]: Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 95
  invalid identifier 'TOTAL_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m19:18:22.504172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de9ade0>]}
[0m19:18:22.504677 [error] [Thread-2 (]: 1 of 3 ERROR creating sql incremental model silver.silver_bookings ............. [[31mERROR[0m in 0.75s]
[0m19:18:22.505038 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:18:22.505271 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:18:22.505549 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.silver_bookings' to be skipped because of status 'error'.  Reason: Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 95
  invalid identifier 'TOTAL_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql.
[0m19:18:22.505822 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m19:18:22.506547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m19:18:22.506761 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m19:18:22.508742 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.510359 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m19:18:22.513425 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.513674 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:18:22.754719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m19:18:22.760565 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.761047 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:18:22.838716 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m19:18:22.844684 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.845125 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:18:22.910771 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.065 seconds
[0m19:18:22.916347 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.916909 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:18:22.991662 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m19:18:22.995259 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.998417 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:22.998782 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:18:23.074580 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m19:18:23.075488 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:23.076021 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:18:23.566350 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.489 seconds
[0m19:18:23.567714 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:23.568430 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:18:23.759695 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m19:18:23.772818 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m19:18:23.780462 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:18:23.780992 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:18:23.932723 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m19:18:23.954813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939d280>]}
[0m19:18:23.955487 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.45s]
[0m19:18:23.955929 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:18:23.956230 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m19:18:23.956686 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m19:18:23.957085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m19:18:23.957333 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m19:18:23.959729 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:23.962199 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m19:18:23.964807 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:23.965134 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:18:24.221858 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.256 seconds
[0m19:18:24.229240 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.229959 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:18:24.372775 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.142 seconds
[0m19:18:24.379043 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.379586 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:18:24.453820 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.073 seconds
[0m19:18:24.460798 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.461355 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:18:24.531150 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.069 seconds
[0m19:18:24.535937 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.538926 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.539259 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:18:24.621534 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m19:18:24.621820 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:24.622032 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:18:25.190473 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.568 seconds
[0m19:18:25.191671 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:25.192349 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:18:25.601393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m19:18:25.608198 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m19:18:25.609426 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:18:25.609864 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:18:26.010298 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m19:18:26.014077 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b02a2d15-448f-4154-b3ae-a83cb5b41ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deb89b0>]}
[0m19:18:26.015086 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 2.06s]
[0m19:18:26.015958 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m19:18:26.017784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:26.018201 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m19:18:26.018523 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m19:18:26.113614 [info ] [MainThread]: 
[0m19:18:26.114262 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m19:18:26.115324 [debug] [MainThread]: Command end result
[0m19:18:26.139115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:18:26.144276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:18:26.149013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:18:26.149206 [info ] [MainThread]: 
[0m19:18:26.149409 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:18:26.149568 [info ] [MainThread]: 
[0m19:18:26.149770 [error] [MainThread]: [31mFailure in model silver_bookings (models/silver/silver_bookings.sql)[0m
[0m19:18:26.149961 [error] [MainThread]:   Database Error in model silver_bookings (models/silver/silver_bookings.sql)
  000904 (42000): SQL compilation error: error line 13 at position 95
  invalid identifier 'TOTAL_AMOUNT'
  compiled code at target/run/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m19:18:26.150105 [info ] [MainThread]: 
[0m19:18:26.150276 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/silver/silver_bookings.sql
[0m19:18:26.150415 [info ] [MainThread]: 
[0m19:18:26.150574 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m19:18:26.150875 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- UnexpectedJinjaBlockDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:18:26.151261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5701365, "process_in_blocks": "0", "process_kernel_time": 0.620326, "process_mem_max_rss": "170917888", "process_out_blocks": "0", "process_user_time": 2.296858}
[0m19:18:26.151522 [debug] [MainThread]: Command `dbt run` failed at 19:18:26.151475 after 7.57 seconds
[0m19:18:26.151735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2da1b0>]}
[0m19:18:26.151927 [debug] [MainThread]: Flushing usage events
[0m19:18:27.237078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:08.641727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d839160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de93fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de93e90>]}


============================== 19:19:08.646672 | f4c30448-9616-438d-9b00-961d06eb3076 ==============================
[0m19:19:08.646672 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:19:08.647028 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/silver', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False'}
[0m19:19:09.807845 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:19:09.809741 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:19:09.810585 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:19:09.959394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec63c50>]}
[0m19:19:10.002131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcbae40>]}
[0m19:19:10.004705 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:19:10.072069 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:19:10.240158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:10.240404 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:19:10.240530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:10.262358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb2e120>]}
[0m19:19:10.299425 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:19:10.302161 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:19:10.327002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f03a870>]}
[0m19:19:10.327206 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:19:10.327345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1854c0>]}
[0m19:19:10.328739 [info ] [MainThread]: 
[0m19:19:10.328886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:10.328994 [info ] [MainThread]: 
[0m19:19:10.329193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:10.330823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:19:10.585614 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:19:10.585831 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:19:10.585973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:11.757957 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.172 seconds
[0m19:19:11.759961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m19:19:11.768295 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:19:11.768584 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:19:11.870836 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.102 seconds
[0m19:19:11.875236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m19:19:11.879897 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:19:11.880356 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:19:11.969150 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.088 seconds
[0m19:19:11.972840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_semi_raw)
[0m19:19:11.978000 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:19:11.978476 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:19:12.066754 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.088 seconds
[0m19:19:12.070010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de91b80>]}
[0m19:19:12.078528 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:19:12.079523 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m19:19:12.080055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.silver_bookings)
[0m19:19:12.080440 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m19:19:12.089081 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:19:12.091982 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m19:19:12.128117 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:19:12.131026 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:19:12.131227 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace transient table AIRBNB_PRO.silver.silver_bookings
    
    
    
    as (

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_fee_amount,
    CREATED_AT
from
    AIRBNB_PRO.semi_raw.bookings
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:19:12.705084 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m19:19:12.719432 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m19:19:12.725294 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:19:12.725619 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:19:12.795480 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m19:19:12.819348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1192e0>]}
[0m19:19:12.819915 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 1[0m in 0.74s]
[0m19:19:12.820362 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:19:12.820659 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:19:12.821066 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m19:19:12.821403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m19:19:12.821656 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m19:19:12.824053 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:12.827028 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m19:19:12.834287 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:12.834591 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:19:13.112532 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m19:19:13.118019 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.118253 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:19:13.201140 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m19:19:13.204709 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.205077 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:19:13.277957 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.072 seconds
[0m19:19:13.289008 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.289492 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:19:13.350689 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.061 seconds
[0m19:19:13.374461 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.376437 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.376668 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:19:13.465181 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m19:19:13.465559 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:13.465821 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:19:14.589621 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 1.123 seconds
[0m19:19:14.590355 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:14.590726 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:19:14.821652 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m19:19:14.825467 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m19:19:14.828538 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:19:14.829005 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:19:14.942724 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m19:19:14.945236 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11594d280>]}
[0m19:19:14.947117 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 2.12s]
[0m19:19:14.948417 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:19:14.949237 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m19:19:14.949802 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m19:19:14.950678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m19:19:14.951181 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m19:19:14.955251 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:14.958295 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m19:19:14.961644 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:14.962023 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:19:15.133453 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m19:19:15.138175 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.138651 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:19:15.214334 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.075 seconds
[0m19:19:15.219495 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.219965 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:19:15.287837 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.067 seconds
[0m19:19:15.293913 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.294520 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:19:15.360411 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.065 seconds
[0m19:19:15.366441 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.371809 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.372214 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:19:15.445435 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m19:19:15.446108 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.446709 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:19:15.975321 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.528 seconds
[0m19:19:15.976218 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:15.976690 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:19:16.150863 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m19:19:16.156347 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m19:19:16.158072 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:19:16.158726 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:19:16.290700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m19:19:16.293573 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c30448-9616-438d-9b00-961d06eb3076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11594e630>]}
[0m19:19:16.294444 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.34s]
[0m19:19:16.295152 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m19:19:16.298274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:16.299002 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m19:19:16.299495 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m19:19:16.391473 [info ] [MainThread]: 
[0m19:19:16.392085 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m19:19:16.393072 [debug] [MainThread]: Command end result
[0m19:19:16.416169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:19:16.422084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:19:16.426468 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:19:16.426663 [info ] [MainThread]: 
[0m19:19:16.426874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:16.427029 [info ] [MainThread]: 
[0m19:19:16.427206 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:19:16.427567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.855827, "process_in_blocks": "0", "process_kernel_time": 0.999176, "process_mem_max_rss": "161284096", "process_out_blocks": "0", "process_user_time": 2.160253}
[0m19:19:16.427825 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:16.427775 after 7.86 seconds
[0m19:19:16.428029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb2e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f083860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159b0c20>]}
[0m19:19:16.428224 [debug] [MainThread]: Flushing usage events
[0m19:19:17.639828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:43.655648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d500740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b7f20>]}


============================== 19:19:43.660529 | 8288bb90-025d-43fa-8d22-f5c31068a0c6 ==============================
[0m19:19:43.660529 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:19:43.660886 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/gold', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False'}
[0m19:19:44.807197 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:19:44.808638 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:19:44.809327 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:19:44.964753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd91820>]}
[0m19:19:45.007584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0e720>]}
[0m19:19:45.010141 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:19:45.078096 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:19:45.243116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:45.243335 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:19:45.243454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:45.264319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6843e0>]}
[0m19:19:45.299720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:19:45.302010 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:19:45.335220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e89c2f0>]}
[0m19:19:45.335440 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:19:45.335583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2dd00>]}
[0m19:19:45.337020 [info ] [MainThread]: 
[0m19:19:45.337162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:45.337272 [info ] [MainThread]: 
[0m19:19:45.337466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:45.339102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:19:45.622651 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:19:45.623067 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:19:45.623404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:46.287181 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.664 seconds
[0m19:19:46.293472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m19:19:46.309874 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:19:46.310307 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:19:46.497925 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.187 seconds
[0m19:19:46.500027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m19:19:46.502486 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:19:46.502765 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:19:46.596908 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.094 seconds
[0m19:19:46.598125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m19:19:46.599748 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:19:46.599930 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:19:46.691380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.091 seconds
[0m19:19:46.693926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e454cb0>]}
[0m19:19:46.701113 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:19:46.702041 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:19:46.702527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:19:46.702839 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:19:46.711391 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:19:46.714231 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:19:46.733303 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:19:46.735632 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:19:46.735843 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.TOTAL_AMOUNT, GOLD_obt.SERVICE_FEE, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:19:46.818927 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2141d-0001-88f0-000c-0f16000385fe
[0m19:19:46.819301 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 90
invalid identifier 'GOLD_OBT.SERVICE_FEE'
[0m19:19:46.824238 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:19:46.827725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09d820>]}
[0m19:19:46.828303 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.12s]
[0m19:19:46.828784 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:19:46.829097 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:19:46.829531 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:19:46.829984 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:19:46.831018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:19:46.831339 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:19:46.836569 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:19:46.838341 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:19:46.842123 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:19:46.844610 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:19:46.844929 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:19:47.829063 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.983 seconds
[0m19:19:47.851455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8288bb90-025d-43fa-8d22-f5c31068a0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c945220>]}
[0m19:19:47.851969 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.02s]
[0m19:19:47.852331 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:19:47.852852 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:19:47.853137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:19:47.853418 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:19:47.855501 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:19:47.858971 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:19:47.859198 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:19:47.859448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:19:47.859692 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:19:47.861641 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:19:47.863671 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:19:47.863880 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:19:47.864319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:19:47.864755 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:19:47.866555 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:19:47.868255 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:19:47.868906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:47.869082 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:19:47.869239 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:19:47.944512 [info ] [MainThread]: 
[0m19:19:47.944936 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m19:19:47.945752 [debug] [MainThread]: Command end result
[0m19:19:47.967860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:19:47.978679 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:19:47.984056 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:19:47.984248 [info ] [MainThread]: 
[0m19:19:47.984449 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:19:47.984610 [info ] [MainThread]: 
[0m19:19:47.984815 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:19:47.985009 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 90
  invalid identifier 'GOLD_OBT.SERVICE_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:19:47.985158 [info ] [MainThread]: 
[0m19:19:47.985326 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:19:47.985469 [info ] [MainThread]: 
[0m19:19:47.985641 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:19:47.985989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3995633, "process_in_blocks": "0", "process_kernel_time": 0.941392, "process_mem_max_rss": "159842304", "process_out_blocks": "0", "process_user_time": 1.951692}
[0m19:19:47.986234 [debug] [MainThread]: Command `dbt run` failed at 19:19:47.986185 after 4.40 seconds
[0m19:19:47.986449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaae540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b7dd0>]}
[0m19:19:47.986646 [debug] [MainThread]: Flushing usage events
[0m19:19:49.160125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:57.153838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d222870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdd490>]}


============================== 19:19:57.159100 | 47b05f4f-02f2-4bce-bd88-2b7d75670c79 ==============================
[0m19:19:57.159100 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:19:57.159394 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt snapshot', 'quiet': 'False'}
[0m19:19:58.286214 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:19:58.287455 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:19:58.288084 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:19:58.447957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b5160>]}
[0m19:19:58.491734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1b30e0>]}
[0m19:19:58.494287 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:19:58.565175 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:19:58.720222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:58.720442 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:19:58.720555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:58.741404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71b8c0>]}
[0m19:19:58.779358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:19:58.782282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:19:58.806790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaad5b0>]}
[0m19:19:58.807016 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:19:58.807163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e586b70>]}
[0m19:19:58.808042 [info ] [MainThread]: 
[0m19:19:58.808180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:58.808287 [info ] [MainThread]: 
[0m19:19:58.808488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:58.810100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:19:59.064959 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:19:59.065149 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:19:59.065255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:59.660219 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.595 seconds
[0m19:19:59.665762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:19:59.680542 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:19:59.680978 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:19:59.754099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.073 seconds
[0m19:19:59.757819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:19:59.761236 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:19:59.761602 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:19:59.844433 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.082 seconds
[0m19:19:59.848444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:19:59.851627 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:19:59.851960 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:19:59.932702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.080 seconds
[0m19:19:59.937776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c5ca0>]}
[0m19:19:59.949599 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:19:59.950663 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:19:59.951507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:19:59.951997 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:19:59.964044 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:19:59.977155 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:20:00.010528 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.010810 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:00.069389 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.058 seconds
[0m19:20:00.096954 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.097254 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:20:00.643294 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m19:20:00.649974 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.650656 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:00.728716 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.077 seconds
[0m19:20:00.735898 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.736584 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:00.800284 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.063 seconds
[0m19:20:00.802936 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.803206 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:00.860698 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.057 seconds
[0m19:20:00.863324 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.863573 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:00.924086 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.060 seconds
[0m19:20:00.931412 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:00.931776 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: describe table "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:01.006995 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.074 seconds
[0m19:20:01.037436 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:01.037888 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        booking_id as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        booking_id as dbt_unique_key
    
,
            created_at as dbt_updated_at,
            created_at as dbt_valid_from,
            created_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.created_at)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.created_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:01.153544 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m19:20:01.165289 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:01.165843 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:01.227884 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.061 seconds
[0m19:20:01.229411 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:01.238287 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:01.239013 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:01.331341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m19:20:01.332963 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:01.333926 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: merge into "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_BOOKINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("BOOKING_ID", "BOOKING_DATE", "BOOKING_STATUS", "CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:20:02.166195 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.831 seconds
[0m19:20:02.167989 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:20:02.168678 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:20:02.382587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m19:20:02.409879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2590d0>]}
[0m19:20:02.410608 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 0[0m in 2.45s]
[0m19:20:02.411066 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:20:02.411363 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:20:02.411768 [info ] [Thread-2 (]: 2 of 3 START snapshot gold.dim_hosts ........................................... [RUN]
[0m19:20:02.412120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:20:02.412374 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:20:02.416271 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:02.419634 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:20:02.422518 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:02.422766 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:02.483193 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.060 seconds
[0m19:20:02.488315 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:02.488793 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:20:03.066019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m19:20:03.071816 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.072272 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:03.141233 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.068 seconds
[0m19:20:03.147468 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.147845 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:03.208758 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.060 seconds
[0m19:20:03.216214 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.216779 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:03.291947 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.074 seconds
[0m19:20:03.297902 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.298269 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:03.354818 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.056 seconds
[0m19:20:03.364794 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.365345 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:03.442729 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m19:20:03.449261 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:03.449836 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:04.215660 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.765 seconds
[0m19:20:04.218292 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:04.218711 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:04.280118 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.061 seconds
[0m19:20:04.281804 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:04.290012 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:04.290807 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:04.372099 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m19:20:04.373457 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:04.374165 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB_PRO"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:20:04.734140 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.359 seconds
[0m19:20:04.735304 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:20:04.735869 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:20:04.954156 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m19:20:04.958675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa709e0>]}
[0m19:20:04.960219 [info ] [Thread-2 (]: 2 of 3 OK snapshotted gold.dim_hosts ........................................... [[32mSUCCESS 0[0m in 2.55s]
[0m19:20:04.961908 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:20:04.962492 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:20:04.963173 [info ] [Thread-2 (]: 3 of 3 START snapshot gold.dim_listings ........................................ [RUN]
[0m19:20:04.963834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:20:04.964272 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:20:04.971636 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:04.976430 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:20:04.980738 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:04.981079 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:05.040139 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.059 seconds
[0m19:20:05.047232 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:05.047867 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:20:05.545119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m19:20:05.551037 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:05.551744 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.057333 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.505 seconds
[0m19:20:06.063834 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.064486 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.140881 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.076 seconds
[0m19:20:06.146709 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.147156 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.217292 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.070 seconds
[0m19:20:06.227442 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.228002 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.294214 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.066 seconds
[0m19:20:06.301509 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.302070 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.363351 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.061 seconds
[0m19:20:06.370379 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.370952 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.574547 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.203 seconds
[0m19:20:06.577332 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.577903 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.652124 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m19:20:06.654313 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.661468 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.661897 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:06.742890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m19:20:06.744103 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:06.744813 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB_PRO"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:20:07.181952 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.436 seconds
[0m19:20:07.183714 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:20:07.184824 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:20:07.359689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m19:20:07.364201 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b05f4f-02f2-4bce-bd88-2b7d75670c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb5cd10>]}
[0m19:20:07.365700 [info ] [Thread-2 (]: 3 of 3 OK snapshotted gold.dim_listings ........................................ [[32mSUCCESS 0[0m in 2.40s]
[0m19:20:07.366703 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:20:07.369087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:07.369560 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:20:07.369965 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:20:07.457113 [info ] [MainThread]: 
[0m19:20:07.457990 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m19:20:07.459278 [debug] [MainThread]: Command end result
[0m19:20:07.484276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:20:07.495165 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:20:07.500645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:20:07.500857 [info ] [MainThread]: 
[0m19:20:07.501108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:07.501285 [info ] [MainThread]: 
[0m19:20:07.501487 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:20:07.501868 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.4075165, "process_in_blocks": "0", "process_kernel_time": 0.905454, "process_mem_max_rss": "161120256", "process_out_blocks": "0", "process_user_time": 2.310579}
[0m19:20:07.502149 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:20:07.502087 after 10.41 seconds
[0m19:20:07.502377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8efda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8efec0>]}
[0m19:20:07.502595 [debug] [MainThread]: Flushing usage events
[0m19:20:08.616257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:39.264581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1cdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf03bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf34080>]}


============================== 19:20:39.270024 | 4d344c1f-3d80-4151-bc7d-b44cb37a568b ==============================
[0m19:20:39.270024 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:20:39.270380 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select models/gold', 'target_path': 'None', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m19:20:40.408034 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:20:40.409847 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:20:40.411017 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:20:40.562274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c061d00>]}
[0m19:20:40.605783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e02f30>]}
[0m19:20:40.608384 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:20:40.679066 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:20:40.835893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:40.836097 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:20:40.836212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:40.856950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd424b0>]}
[0m19:20:40.892227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:20:40.894765 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:20:40.921495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13b110>]}
[0m19:20:40.921716 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:20:40.921863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea1940>]}
[0m19:20:40.923574 [info ] [MainThread]: 
[0m19:20:40.923714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:40.923819 [info ] [MainThread]: 
[0m19:20:40.924020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:40.925617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:20:41.205435 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:20:41.205835 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:20:41.206105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:41.985652 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.779 seconds
[0m19:20:41.991937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m19:20:42.010715 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:20:42.011164 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:20:42.147349 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.136 seconds
[0m19:20:42.149509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:20:42.152167 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:20:42.152453 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:20:42.240545 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.088 seconds
[0m19:20:42.243651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:20:42.247896 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:20:42.248360 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:20:42.370813 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.122 seconds
[0m19:20:42.375139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdfe60>]}
[0m19:20:42.384653 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:20:42.385485 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:20:42.386491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:20:42.386933 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:20:42.397509 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:20:42.400569 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:20:42.420637 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:20:42.423766 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:20:42.424009 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.TOTAL_AMOUNT, GOLD_obt.SERVICE_FEE, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:20:42.510630 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2141e-0001-88b7-000c-0f160003928e
[0m19:20:42.511096 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB_PRO.GOLD.OBT' does not exist or not authorized.
[0m19:20:42.516577 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.OBT' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:20:42.519536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17d280>]}
[0m19:20:42.520108 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.13s]
[0m19:20:42.520579 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:20:42.520894 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:20:42.521325 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.OBT' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:20:42.521779 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:20:42.522813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:20:42.523126 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:20:42.528036 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:20:42.529471 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:20:42.532873 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:20:42.535014 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:20:42.535307 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:20:43.534714 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m19:20:43.560544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d344c1f-3d80-4151-bc7d-b44cb37a568b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e199b20>]}
[0m19:20:43.561167 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.04s]
[0m19:20:43.561593 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:20:43.562236 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:20:43.562581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:20:43.562866 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:20:43.565334 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:20:43.569280 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:20:43.569586 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:20:43.569873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:20:43.570127 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:20:43.572261 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:20:43.575462 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:20:43.575759 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:20:43.576050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:20:43.576303 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:20:43.578250 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:20:43.580685 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:20:43.581310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:43.581470 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:20:43.581620 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:20:43.664673 [info ] [MainThread]: 
[0m19:20:43.665045 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m19:20:43.665732 [debug] [MainThread]: Command end result
[0m19:20:43.686490 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:20:43.696414 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:20:43.701101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:20:43.701278 [info ] [MainThread]: 
[0m19:20:43.701457 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:20:43.701591 [info ] [MainThread]: 
[0m19:20:43.701763 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:20:43.701920 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB_PRO.GOLD.OBT' does not exist or not authorized.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:20:43.702044 [info ] [MainThread]: 
[0m19:20:43.702184 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:20:43.702303 [info ] [MainThread]: 
[0m19:20:43.702444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:20:43.702761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5106907, "process_in_blocks": "0", "process_kernel_time": 0.923864, "process_mem_max_rss": "159744000", "process_out_blocks": "0", "process_user_time": 1.947373}
[0m19:20:43.702976 [debug] [MainThread]: Command `dbt run` failed at 19:20:43.702937 after 4.51 seconds
[0m19:20:43.703163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109869400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc06030>]}
[0m19:20:43.703342 [debug] [MainThread]: Flushing usage events
[0m19:20:44.864008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:25.430885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a24830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a25cd0>]}


============================== 19:51:25.436194 | dac96167-9ce3-4862-804a-cc72b513de87 ==============================
[0m19:51:25.436194 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:51:25.436529 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run --select models/silver', 'send_anonymous_usage_stats': 'True'}
[0m19:51:26.461185 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:51:26.462278 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:51:26.462743 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:51:26.622272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d7560>]}
[0m19:51:26.665500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a559790>]}
[0m19:51:26.668279 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:51:26.738322 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:51:26.957986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:26.958253 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:51:26.958400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:26.982878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b8110>]}
[0m19:51:27.021217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:51:27.027987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:51:27.094113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac9f110>]}
[0m19:51:27.094369 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:51:27.094531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78bce0>]}
[0m19:51:27.096323 [info ] [MainThread]: 
[0m19:51:27.096477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:27.096594 [info ] [MainThread]: 
[0m19:51:27.096817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:27.098773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:51:27.386066 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:51:27.386269 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:51:27.386383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:28.250971 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.864 seconds
[0m19:51:28.254673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m19:51:28.265565 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:51:28.265874 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:51:28.347765 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.082 seconds
[0m19:51:28.349065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:51:28.350673 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:51:28.350856 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:51:28.468757 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.118 seconds
[0m19:51:28.470831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:51:28.473326 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:51:28.473608 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:51:28.595273 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.121 seconds
[0m19:51:28.598600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bceaea0>]}
[0m19:51:28.608939 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:51:28.609496 [info ] [Thread-2 (]: 1 of 3 START sql incremental model silver.silver_bookings ...................... [RUN]
[0m19:51:28.610245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now model.dbt_snowflake_aws_project.silver_bookings)
[0m19:51:28.610623 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_bookings
[0m19:51:28.619394 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:28.640108 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_bookings
[0m19:51:28.675231 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:28.675488 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: create or replace  temporary view AIRBNB_PRO.silver.silver_bookings__dbt_tmp
  
  
  
  
  as (
    

select 
    booking_id,
    listing_id,
    booking_date,
    booking_status,
    
    round(NIGHTS_BOOKED * BOOKING_AMOUNT,2)
 as total_booking_amount,
    CLEANING_FEE + SERVICE_FEE as total_fee_amount,
    CREATED_AT
from
    AIRBNB_PRO.semi_raw.bookings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:51:28.995846 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m19:51:29.008975 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.009438 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:51:29.088375 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.078 seconds
[0m19:51:29.095971 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.096621 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table AIRBNB_PRO.silver.silver_bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:51:29.159245 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.062 seconds
[0m19:51:29.170886 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.171291 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: describe table "AIRBNB_PRO"."SILVER"."SILVER_BOOKINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:51:29.243368 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.072 seconds
[0m19:51:29.278847 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.295704 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.295992 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:51:29.381186 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m19:51:29.382211 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:29.382899 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: merge into AIRBNB_PRO.silver.silver_bookings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_bookings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.BOOKING_ID = DBT_INTERNAL_DEST.BOOKING_ID))

    
    when matched then update set
        "BOOKING_ID" = DBT_INTERNAL_SOURCE."BOOKING_ID","LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","BOOKING_DATE" = DBT_INTERNAL_SOURCE."BOOKING_DATE","BOOKING_STATUS" = DBT_INTERNAL_SOURCE."BOOKING_STATUS","TOTAL_BOOKING_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_BOOKING_AMOUNT","TOTAL_FEE_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FEE_AMOUNT","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_FEE_AMOUNT", "CREATED_AT")
    values
        ("BOOKING_ID", "LISTING_ID", "BOOKING_DATE", "BOOKING_STATUS", "TOTAL_BOOKING_AMOUNT", "TOTAL_FEE_AMOUNT", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */;
[0m19:51:30.718118 [debug] [Thread-2 (]: SQL status: SUCCESS 5000 in 1.335 seconds
[0m19:51:30.718434 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:30.718615 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:51:30.914048 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m19:51:30.925596 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_bookings__dbt_tmp
[0m19:51:30.931155 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_bookings"
[0m19:51:30.931451 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_bookings: drop view if exists AIRBNB_PRO.silver.silver_bookings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_bookings"} */
[0m19:51:31.042600 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m19:51:31.064659 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d15b0>]}
[0m19:51:31.065159 [info ] [Thread-2 (]: 1 of 3 OK created sql incremental model silver.silver_bookings ................. [[32mSUCCESS 5000[0m in 2.45s]
[0m19:51:31.065543 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_bookings
[0m19:51:31.065792 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:51:31.066144 [info ] [Thread-2 (]: 2 of 3 START sql incremental model silver.silver_hosts ......................... [RUN]
[0m19:51:31.066441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_bookings, now model.dbt_snowflake_aws_project.silver_hosts)
[0m19:51:31.066656 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_hosts
[0m19:51:31.068474 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.081214 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_hosts
[0m19:51:31.083578 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.083806 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: create or replace  temporary view AIRBNB_PRO.silver.silver_hosts__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    HOST_ID,
    REPLACE(HOST_NAME, ' ', '_') AS HOST_NAME,
    HOST_SINCE AS HOST_SINCE,
    IS_SUPERHOST AS IS_SUPERHOST,
    RESPONSE_RATE AS RESPONSE_RATE,
    CASE 
    WHEN RESPONSE_RATE > 95 THEN 'VERY GOOD'
    WHEN RESPONSE_RATE > 80 THEN 'GOOD'
    WHEN RESPONSE_RATE > 60 THEN 'FAIR'
    ELSE 'POOR'
    END AS RESPONSE_RATE_QUALITY,
    CREATED_AT AS CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.hosts
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:51:31.264643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m19:51:31.270381 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.271030 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:51:31.348105 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m19:51:31.355516 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.355948 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table AIRBNB_PRO.silver.silver_hosts
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:51:31.420594 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m19:51:31.428478 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.429099 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: describe table "AIRBNB_PRO"."SILVER"."SILVER_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:51:31.491370 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.062 seconds
[0m19:51:31.496973 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.510201 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.510799 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:51:31.592383 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m19:51:31.593650 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:31.594307 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: merge into AIRBNB_PRO.silver.silver_hosts as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_hosts__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.HOST_ID = DBT_INTERNAL_DEST.HOST_ID))

    
    when matched then update set
        "HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","HOST_NAME" = DBT_INTERNAL_SOURCE."HOST_NAME","HOST_SINCE" = DBT_INTERNAL_SOURCE."HOST_SINCE","IS_SUPERHOST" = DBT_INTERNAL_SOURCE."IS_SUPERHOST","RESPONSE_RATE" = DBT_INTERNAL_SOURCE."RESPONSE_RATE","RESPONSE_RATE_QUALITY" = DBT_INTERNAL_SOURCE."RESPONSE_RATE_QUALITY","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")
    values
        ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE", "RESPONSE_RATE_QUALITY", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */;
[0m19:51:32.462492 [debug] [Thread-2 (]: SQL status: SUCCESS 200 in 0.867 seconds
[0m19:51:32.463947 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:32.464487 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:51:32.722013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m19:51:32.728672 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_hosts__dbt_tmp
[0m19:51:32.730116 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_hosts"
[0m19:51:32.730601 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_hosts: drop view if exists AIRBNB_PRO.silver.silver_hosts__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_hosts"} */
[0m19:51:32.843398 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m19:51:32.847044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad590d0>]}
[0m19:51:32.848003 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model silver.silver_hosts .................... [[32mSUCCESS 200[0m in 1.78s]
[0m19:51:32.848723 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_hosts
[0m19:51:32.849224 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.silver_listings
[0m19:51:32.849797 [info ] [Thread-2 (]: 3 of 3 START sql incremental model silver.silver_listings ...................... [RUN]
[0m19:51:32.850360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.silver_hosts, now model.dbt_snowflake_aws_project.silver_listings)
[0m19:51:32.850752 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.silver_listings
[0m19:51:32.855689 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:32.871559 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.silver_listings
[0m19:51:32.874666 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:32.874958 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: create or replace  temporary view AIRBNB_PRO.silver.silver_listings__dbt_tmp
  
  
  
  
  as (
    

SELECT 
    LISTING_ID,
    HOST_ID,
    PROPERTY_TYPE,
    ROOM_TYPE,
    CITY,
    COUNTRY,
    ACCOMMODATES,
    BEDROOMS,
    BATHROOMS,
    PRICE_PER_NIGHT,
    
    CASE 
        WHEN price_per_night < 100 THEN 'low'
        WHEN price_per_night < 200 THEN 'medium'
        ELSE 'high'
    END
 as price_per_night_tagged,
    CREATED_AT
FROM 
    AIRBNB_PRO.semi_raw.listings
  )
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:51:33.088648 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m19:51:33.094275 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.094700 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:51:33.170640 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.075 seconds
[0m19:51:33.177209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.177847 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table AIRBNB_PRO.silver.silver_listings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:51:33.280494 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.102 seconds
[0m19:51:33.287727 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.288201 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: describe table "AIRBNB_PRO"."SILVER"."SILVER_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:51:33.366633 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.078 seconds
[0m19:51:33.370923 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.377442 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.377782 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:51:33.473881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m19:51:33.474292 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:33.474598 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: merge into AIRBNB_PRO.silver.silver_listings as DBT_INTERNAL_DEST
        using AIRBNB_PRO.silver.silver_listings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.LISTING_ID = DBT_INTERNAL_DEST.LISTING_ID))

    
    when matched then update set
        "LISTING_ID" = DBT_INTERNAL_SOURCE."LISTING_ID","HOST_ID" = DBT_INTERNAL_SOURCE."HOST_ID","PROPERTY_TYPE" = DBT_INTERNAL_SOURCE."PROPERTY_TYPE","ROOM_TYPE" = DBT_INTERNAL_SOURCE."ROOM_TYPE","CITY" = DBT_INTERNAL_SOURCE."CITY","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","ACCOMMODATES" = DBT_INTERNAL_SOURCE."ACCOMMODATES","BEDROOMS" = DBT_INTERNAL_SOURCE."BEDROOMS","BATHROOMS" = DBT_INTERNAL_SOURCE."BATHROOMS","PRICE_PER_NIGHT" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT","PRICE_PER_NIGHT_TAGGED" = DBT_INTERNAL_SOURCE."PRICE_PER_NIGHT_TAGGED","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT"
    

    when not matched then insert
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")
    values
        ("LISTING_ID", "HOST_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "ACCOMMODATES", "BEDROOMS", "BATHROOMS", "PRICE_PER_NIGHT", "PRICE_PER_NIGHT_TAGGED", "CREATED_AT")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */;
[0m19:51:34.065819 [debug] [Thread-2 (]: SQL status: SUCCESS 500 in 0.591 seconds
[0m19:51:34.067103 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:34.067803 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:51:34.275246 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m19:51:34.284161 [debug] [Thread-2 (]: Applying DROP to: AIRBNB_PRO.silver.silver_listings__dbt_tmp
[0m19:51:34.285340 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.silver_listings"
[0m19:51:34.285799 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.silver_listings: drop view if exists AIRBNB_PRO.silver.silver_listings__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.silver_listings"} */
[0m19:51:34.393450 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m19:51:34.398048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac96167-9ce3-4862-804a-cc72b513de87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde8440>]}
[0m19:51:34.398851 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model silver.silver_listings ................. [[32mSUCCESS 500[0m in 1.55s]
[0m19:51:34.399365 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.silver_listings
[0m19:51:34.400537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:34.400802 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.silver_listings' was left open.
[0m19:51:34.401050 [debug] [MainThread]: On model.dbt_snowflake_aws_project.silver_listings: Close
[0m19:51:34.488685 [info ] [MainThread]: 
[0m19:51:34.489524 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m19:51:34.490864 [debug] [MainThread]: Command end result
[0m19:51:34.513960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:51:34.524308 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:51:34.529940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:51:34.530146 [info ] [MainThread]: 
[0m19:51:34.530375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:34.530546 [info ] [MainThread]: 
[0m19:51:34.530739 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:51:34.531125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.171635, "process_in_blocks": "0", "process_kernel_time": 1.006358, "process_mem_max_rss": "160890880", "process_out_blocks": "0", "process_user_time": 2.118624}
[0m19:51:34.531417 [debug] [MainThread]: Command `dbt run` succeeded at 19:51:34.531360 after 9.17 seconds
[0m19:51:34.531648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a24830>]}
[0m19:51:34.531860 [debug] [MainThread]: Flushing usage events
[0m19:51:35.688191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:45.508168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058205c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba01a0>]}


============================== 19:51:45.512746 | 1ae6ab1b-297e-4d9f-9c51-9892bffe1c59 ==============================
[0m19:51:45.512746 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:51:45.513104 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select models/gold', 'debug': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs'}
[0m19:51:46.413803 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:51:46.415441 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:51:46.416164 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:51:46.575873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04fd10>]}
[0m19:51:46.618894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8d4440>]}
[0m19:51:46.621116 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:51:46.690536 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:51:46.854727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:46.854952 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:51:46.855068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:46.876133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e872570>]}
[0m19:51:46.911570 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:51:46.913787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:51:46.948044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f6630>]}
[0m19:51:46.948270 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:51:46.948411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea2f200>]}
[0m19:51:46.949858 [info ] [MainThread]: 
[0m19:51:46.950000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:46.950099 [info ] [MainThread]: 
[0m19:51:46.950297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:46.951969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:51:47.205243 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:51:47.205493 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:51:47.205767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:48.111110 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.905 seconds
[0m19:51:48.117003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_gold)
[0m19:51:48.130982 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:51:48.131399 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:51:48.197579 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.066 seconds
[0m19:51:48.199081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m19:51:48.200871 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:51:48.201088 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:51:48.269962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.069 seconds
[0m19:51:48.271757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:51:48.274546 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:51:48.274858 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:51:48.375716 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.100 seconds
[0m19:51:48.379944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b9910>]}
[0m19:51:48.389881 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:51:48.390690 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:51:48.391798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now model.dbt_snowflake_aws_project.facts)
[0m19:51:48.392221 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:51:48.403066 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:51:48.411829 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:51:48.430248 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:51:48.446068 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:51:48.446330 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.total_fee_amount GOLD_obt.SERVICE_FEE, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:51:48.532805 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2143d-0001-88b7-000c-0f16000394fa
[0m19:51:48.533224 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 101 unexpected '.'.
syntax error line 23 at position 11 unexpected 'GOLD_obt'.
[0m19:51:48.539100 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 101 unexpected '.'.
  syntax error line 23 at position 11 unexpected 'GOLD_obt'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:51:48.542827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd42fc0>]}
[0m19:51:48.543419 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.15s]
[0m19:51:48.543902 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:51:48.544217 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:51:48.544671 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 101 unexpected '.'.
  syntax error line 23 at position 11 unexpected 'GOLD_obt'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:51:48.545137 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:51:48.546161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:51:48.546474 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:51:48.551073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:51:48.561957 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:51:48.565381 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:51:48.579462 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:51:48.579822 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:51:49.562191 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m19:51:49.584663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae6ab1b-297e-4d9f-9c51-9892bffe1c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d54c0>]}
[0m19:51:49.585234 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 1.04s]
[0m19:51:49.585659 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:51:49.586320 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:51:49.586680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:51:49.586933 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:51:49.589094 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:51:49.606662 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:51:49.607003 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:51:49.607363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:51:49.607652 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:51:49.609832 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:51:49.622142 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:51:49.622380 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:51:49.622667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:51:49.622926 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:51:49.624891 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:51:49.636913 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:51:49.637739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:49.637966 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:51:49.638168 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:51:49.722818 [info ] [MainThread]: 
[0m19:51:49.723628 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m19:51:49.724768 [debug] [MainThread]: Command end result
[0m19:51:49.751822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:51:49.760860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:51:49.766371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:51:49.766576 [info ] [MainThread]: 
[0m19:51:49.766804 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:51:49.766984 [info ] [MainThread]: 
[0m19:51:49.767211 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:51:49.767421 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 101 unexpected '.'.
  syntax error line 23 at position 11 unexpected 'GOLD_obt'.
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:51:49.767589 [info ] [MainThread]: 
[0m19:51:49.767778 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:51:49.767936 [info ] [MainThread]: 
[0m19:51:49.768124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:51:49.768505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.327773, "process_in_blocks": "0", "process_kernel_time": 0.803541, "process_mem_max_rss": "160088064", "process_out_blocks": "0", "process_user_time": 1.876557}
[0m19:51:49.768784 [debug] [MainThread]: Command `dbt run` failed at 19:51:49.768732 after 4.33 seconds
[0m19:51:49.769013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058205c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3fd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba04a0>]}
[0m19:51:49.769229 [debug] [MainThread]: Flushing usage events
[0m19:51:50.892643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:31.229905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8bcaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e033fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e033fe0>]}


============================== 19:53:31.234482 | 1f4ce29c-a861-4d96-bfea-1506cff2908b ==============================
[0m19:53:31.234482 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:53:31.234788 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'invocation_command': 'dbt run --select models/gold', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False'}
[0m19:53:32.373275 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:53:32.375166 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:53:32.376255 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:53:32.528729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e611ee0>]}
[0m19:53:32.571295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9fc440>]}
[0m19:53:32.573945 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:53:32.641865 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:53:32.817899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:32.818126 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:53:32.818245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:32.840182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed84cb0>]}
[0m19:53:32.876910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:53:32.879721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:53:32.903978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1dbb00>]}
[0m19:53:32.904205 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:53:32.904349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0338f0>]}
[0m19:53:32.905965 [info ] [MainThread]: 
[0m19:53:32.906111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:53:32.906213 [info ] [MainThread]: 
[0m19:53:32.906413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:32.908016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:53:33.167721 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:53:33.167929 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:53:33.168040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:34.011373 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.843 seconds
[0m19:53:34.017731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_semi_raw)
[0m19:53:34.035090 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:53:34.035506 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:53:34.626369 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.590 seconds
[0m19:53:34.630252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_silver)
[0m19:53:34.634426 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:53:34.634990 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:53:34.715829 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.080 seconds
[0m19:53:34.718843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_gold)
[0m19:53:34.722516 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:53:34.722950 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:53:34.812708 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.089 seconds
[0m19:53:34.817338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc3fb0>]}
[0m19:53:34.827731 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:53:34.828747 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:53:34.829732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:53:34.830144 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:53:34.839810 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:53:34.842970 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:53:34.862597 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:53:34.865876 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:53:34.866113 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.total_fee_amount, GOLD_obt.CLEANING_FEE, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:53:34.951700 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c2143f-0001-88f0-000c-0f160003889a
[0m19:53:34.952125 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 94
invalid identifier 'GOLD_OBT.CLEANING_FEE'
[0m19:53:34.957710 [debug] [Thread-2 (]: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 94
  invalid identifier 'GOLD_OBT.CLEANING_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:53:34.961365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2c1490>]}
[0m19:53:34.961944 [error] [Thread-2 (]: 1 of 2 ERROR creating sql table model gold.facts ............................... [[31mERROR[0m in 0.13s]
[0m19:53:34.962475 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:53:34.962846 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:53:34.963347 [debug] [Thread-5 (]: Marking all children of 'model.dbt_snowflake_aws_project.facts' to be skipped because of status 'error'.  Reason: Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 94
  invalid identifier 'GOLD_OBT.CLEANING_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql.
[0m19:53:34.963806 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:53:34.964851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:53:34.965221 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:53:34.970346 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:53:34.972754 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:53:34.976134 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:53:34.979430 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:53:34.979733 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:53:35.648696 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m19:53:35.669789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f4ce29c-a861-4d96-bfea-1506cff2908b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101cc470>]}
[0m19:53:35.670296 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.70s]
[0m19:53:35.670662 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:53:35.671235 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:53:35.671488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:53:35.671701 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:53:35.673678 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:53:35.676939 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:53:35.677170 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:53:35.677427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:53:35.677677 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:53:35.679615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:53:35.682433 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:53:35.682669 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:53:35.683002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:53:35.683195 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:53:35.684942 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:53:35.687127 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:53:35.687767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:35.687942 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:53:35.688097 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:53:35.763651 [info ] [MainThread]: 
[0m19:53:35.764053 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m19:53:35.764871 [debug] [MainThread]: Command end result
[0m19:53:35.786505 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:53:35.796979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:53:35.802237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:53:35.802430 [info ] [MainThread]: 
[0m19:53:35.802628 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:53:35.802795 [info ] [MainThread]: 
[0m19:53:35.803021 [error] [MainThread]: [31mFailure in model facts (models/gold/facts.sql)[0m
[0m19:53:35.803231 [error] [MainThread]:   Database Error in model facts (models/gold/facts.sql)
  000904 (42000): SQL compilation error: error line 13 at position 94
  invalid identifier 'GOLD_OBT.CLEANING_FEE'
  compiled code at target/run/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:53:35.803395 [info ] [MainThread]: 
[0m19:53:35.803581 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/models/gold/facts.sql
[0m19:53:35.803736 [info ] [MainThread]: 
[0m19:53:35.803920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m19:53:35.804277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.63479, "process_in_blocks": "0", "process_kernel_time": 0.774826, "process_mem_max_rss": "160006144", "process_out_blocks": "0", "process_user_time": 1.858291}
[0m19:53:35.804521 [debug] [MainThread]: Command `dbt run` failed at 19:53:35.804473 after 4.64 seconds
[0m19:53:35.804736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de2a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a12b0>]}
[0m19:53:35.804933 [debug] [MainThread]: Flushing usage events
[0m19:53:36.980474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:16.882811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc854c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc853d0>]}


============================== 19:54:16.888451 | c2d8da52-b180-4857-a3c6-578b85a334c4 ==============================
[0m19:54:16.888451 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:54:16.888752 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select models/gold', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'no_print': 'None', 'empty': 'False', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs'}
[0m19:54:17.896576 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:54:17.897714 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:54:17.898177 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:54:18.042087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e62c560>]}
[0m19:54:18.086568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd68740>]}
[0m19:54:18.088687 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:54:18.155691 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:54:18.321079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:18.321299 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:54:18.321422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:18.342955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7436b0>]}
[0m19:54:18.378646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:54:18.381304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:54:18.412250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb3ab40>]}
[0m19:54:18.412471 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:54:18.412617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7db8f0>]}
[0m19:54:18.414089 [info ] [MainThread]: 
[0m19:54:18.414224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:18.414329 [info ] [MainThread]: 
[0m19:54:18.414525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:18.416148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:54:18.704997 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:54:18.705488 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:54:18.705764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:19.537448 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.831 seconds
[0m19:54:19.543427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m19:54:19.557819 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:54:19.558209 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:54:19.647735 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.089 seconds
[0m19:54:19.652660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:54:19.657755 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:54:19.658220 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:54:19.752418 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.094 seconds
[0m19:54:19.756395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:54:19.761396 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:54:19.761869 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:54:19.842541 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.080 seconds
[0m19:54:19.846899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf00b0>]}
[0m19:54:19.856434 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.facts
[0m19:54:19.857230 [info ] [Thread-2 (]: 1 of 2 START sql table model gold.facts ........................................ [RUN]
[0m19:54:19.858251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now model.dbt_snowflake_aws_project.facts)
[0m19:54:19.858694 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.facts
[0m19:54:19.869785 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.facts"
[0m19:54:19.874476 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.facts
[0m19:54:19.894700 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.facts"
[0m19:54:19.906446 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.facts"
[0m19:54:19.906698 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.facts: create or replace transient table AIRBNB_PRO.gold.facts
    
    
    
    as (-- we can see that all the columns are being read from the gold_obt table.
-- we are not referring to any columns from the other two tables ie. dim_listings and dim_hosts
-- we are also not using dim_bookings table at all in this query.



-- select all the columns available from the first table in the congigs list
SELECT 
        GOLD_obt.BOOKING_ID, GOLD_obt.LISTING_ID, GOLD_obt.HOST_ID,GOLD_obt.total_fee_amount, GOLD_obt.ACCOMMODATES, GOLD_obt.BEDROOMS, GOLD_obt.BATHROOMS, GOLD_obt.PRICE_PER_NIGHT, GOLD_obt.RESPONSE_RATE

FROM
    
    
      AIRBNB_PRO.GOLD.OBT AS GOLD_obt
    
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_LISTINGS AS DIM_listings
        ON GOLD_obt.listing_id = DIM_listings.listing_id
        
        
    
        LEFT JOIN AIRBNB_PRO.GOLD.DIM_HOSTS AS DIM_hosts
        ON GOLD_obt.host_id = DIM_hosts.host_id
        
        
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.facts"} */;
[0m19:54:23.483813 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.576 seconds
[0m19:54:23.513983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc19430>]}
[0m19:54:23.514699 [info ] [Thread-2 (]: 1 of 2 OK created sql table model gold.facts ................................... [[32mSUCCESS 1[0m in 3.65s]
[0m19:54:23.515166 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.facts
[0m19:54:23.515476 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.obt
[0m19:54:23.515935 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.obt .......................................... [RUN]
[0m19:54:23.516374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.facts, now model.dbt_snowflake_aws_project.obt)
[0m19:54:23.516651 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.obt
[0m19:54:23.522781 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.obt"
[0m19:54:23.534374 [debug] [Thread-2 (]: Began executing node model.dbt_snowflake_aws_project.obt
[0m19:54:23.536176 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_snowflake_aws_project.obt"
[0m19:54:23.549315 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_snowflake_aws_project.obt"
[0m19:54:23.549591 [debug] [Thread-2 (]: On model.dbt_snowflake_aws_project.obt: create or replace transient table AIRBNB_PRO.gold.obt
    
    
    
    as (

-- now once the configs are set, we can dynamically build the SQL query
-- for this , we need to loop through the configs and build the select and join statements
-- now, since our pipeline is a metadata driven pipeline, if any new table comes into the future, we just need to add a new config to the configs list above
-- first we will iterate trhough all the columns, and will add a if not loop.last to avoid trailing commas.


select 
    
        SILVER_BOOKINGS.*,
    
        SILVER_listings.HOST_ID, SILVER_listings.PROPERTY_TYPE, SILVER_listings.ROOM_TYPE, SILVER_listings.CITY, SILVER_listings.COUNTRY, SILVER_listings.ACCOMMODATES, SILVER_listings.BEDROOMS, SILVER_listings.BATHROOMS, SILVER_listings.PRICE_PER_NIGHT, silver_listings.PRICE_PER_NIGHT_TAGGED, SILVER_listings.CREATED_AT AS LISTING_CREATED_AT,
    
        SILVER_hosts.HOST_NAME, SILVER_hosts.HOST_SINCE, SILVER_hosts.IS_SUPERHOST, SILVER_hosts.RESPONSE_RATE, SILVER_hosts.RESPONSE_RATE_QUALITY, SILVER_hosts.CREATED_AT AS HOST_CREATED_AT
    
-- then we will use the from statement
FROM
    
        
            AIRBNB_PRO.SILVER.SILVER_BOOKINGS AS SILVER_bookings
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_LISTINGS AS SILVER_listings
            ON SILVER_bookings.listing_id = SILVER_listings.listing_id
        
    
        
            LEFT JOIN AIRBNB_PRO.SILVER.SILVER_HOSTS AS SILVER_hosts
            ON SILVER_listings.HOST_ID = SILVER_hosts.HOST_ID
        
    

-- so basically we are running 2 for loops here.
-- first we are looping through the configs to get all the columns for the select statement
-- then we are looping through the configs again to build the from and join statements
-- if the table is the first table, we just add it to the from clause
-- else, if we have more tables, we add it as a left join with the join condition specified in the config
    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "model.dbt_snowflake_aws_project.obt"} */;
[0m19:54:24.227823 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m19:54:24.235734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d8da52-b180-4857-a3c6-578b85a334c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6c470>]}
[0m19:54:24.236730 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.obt ..................................... [[32mSUCCESS 1[0m in 0.72s]
[0m19:54:24.237519 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.obt
[0m19:54:24.239043 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:54:24.239864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.obt, now model.dbt_snowflake_aws_project.booking_ephemeral_source)
[0m19:54:24.240280 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:54:24.244603 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.booking_ephemeral_source"
[0m19:54:24.260050 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.booking_ephemeral_source
[0m19:54:24.260477 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:54:24.260930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.booking_ephemeral_source, now model.dbt_snowflake_aws_project.host_ephemeral_source)
[0m19:54:24.261361 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:54:24.264117 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.host_ephemeral_source"
[0m19:54:24.277620 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.host_ephemeral_source
[0m19:54:24.277929 [debug] [Thread-2 (]: Began running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:54:24.278240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_snowflake_aws_project.host_ephemeral_source, now model.dbt_snowflake_aws_project.listing_ephemeral_source)
[0m19:54:24.278489 [debug] [Thread-2 (]: Began compiling node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:54:24.280862 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_snowflake_aws_project.listing_ephemeral_source"
[0m19:54:24.290934 [debug] [Thread-2 (]: Finished running node model.dbt_snowflake_aws_project.listing_ephemeral_source
[0m19:54:24.291898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:24.292169 [debug] [MainThread]: Connection 'model.dbt_snowflake_aws_project.listing_ephemeral_source' was left open.
[0m19:54:24.292405 [debug] [MainThread]: On model.dbt_snowflake_aws_project.listing_ephemeral_source: Close
[0m19:54:24.375373 [info ] [MainThread]: 
[0m19:54:24.376170 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m19:54:24.377288 [debug] [MainThread]: Command end result
[0m19:54:24.402199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:54:24.413469 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:54:24.418990 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:54:24.419208 [info ] [MainThread]: 
[0m19:54:24.419442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:24.419613 [info ] [MainThread]: 
[0m19:54:24.419813 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:54:24.420191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6006393, "process_in_blocks": "0", "process_kernel_time": 0.820575, "process_mem_max_rss": "159809536", "process_out_blocks": "0", "process_user_time": 1.78718}
[0m19:54:24.420472 [debug] [MainThread]: Command `dbt run` succeeded at 19:54:24.420414 after 7.60 seconds
[0m19:54:24.420699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2620f0>]}
[0m19:54:24.420920 [debug] [MainThread]: Flushing usage events
[0m19:54:25.518383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:34.590247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b05550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a19bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a19be90>]}


============================== 19:54:34.595000 | 232482ea-28ab-42f9-bd32-23e52648eb75 ==============================
[0m19:54:34.595000 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:54:34.595365 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m19:54:35.678583 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:54:35.679894 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:54:35.680562 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:54:35.843265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6fef0>]}
[0m19:54:35.887971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c6900>]}
[0m19:54:35.890802 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m19:54:35.957960 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:54:36.109244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:36.109465 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:54:36.109581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:36.130328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af657f0>]}
[0m19:54:36.165652 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:54:36.167884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:54:36.190594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3fc110>]}
[0m19:54:36.190826 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m19:54:36.190971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b1730>]}
[0m19:54:36.191815 [info ] [MainThread]: 
[0m19:54:36.191950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:36.192051 [info ] [MainThread]: 
[0m19:54:36.192250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:36.193890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m19:54:36.453089 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m19:54:36.453290 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m19:54:36.453403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:37.677351 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.224 seconds
[0m19:54:37.680898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m19:54:37.692032 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m19:54:37.692347 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m19:54:37.911625 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.219 seconds
[0m19:54:37.916400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m19:54:37.921235 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m19:54:37.921694 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m19:54:38.729077 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.807 seconds
[0m19:54:38.732896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m19:54:38.737030 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m19:54:38.737473 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m19:54:38.924119 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m19:54:38.928374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a916d80>]}
[0m19:54:38.938232 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:54:38.939307 [info ] [Thread-2 (]: 1 of 3 START snapshot gold.dim_bookings ........................................ [RUN]
[0m19:54:38.940131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now snapshot.dbt_snowflake_aws_project.dim_bookings)
[0m19:54:38.940562 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:54:38.950494 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:54:38.954035 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:54:38.993992 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:54:38.994283 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            total_fee_amount,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:54:39.242339 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.247 seconds
[0m19:54:39.251634 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:54:39.252268 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */
[0m19:54:39.340766 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m19:54:39.342333 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:54:39.347657 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_bookings"
[0m19:54:39.348165 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_bookings: create or replace transient table AIRBNB_PRO.gold.dim_bookings
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(booking_id as varchar ), '')
         || '|' || coalesce(cast(created_at as varchar ), '')
        ) as dbt_scd_id,
        created_at as dbt_updated_at,
        created_at as dbt_valid_from,
        
  
  coalesce(nullif(created_at, created_at), to_date('9999-12-31'))
  as dbt_valid_to
from (
        with __dbt__cte__booking_ephemeral_source as (


with bookings as
    (
        select
            booking_id,
            booking_date,
            booking_status,
            total_fee_amount,
            CREATED_AT
        from
            AIRBNB_PRO.gold.obt
    )

select * from bookings
) select * from __dbt__cte__booking_ephemeral_source
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_bookings"} */;
[0m19:54:39.857245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m19:54:39.890358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45340>]}
[0m19:54:39.891180 [info ] [Thread-2 (]: 1 of 3 OK snapshotted gold.dim_bookings ........................................ [[32mSUCCESS 1[0m in 0.95s]
[0m19:54:39.891676 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_bookings
[0m19:54:39.891977 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:54:39.892420 [info ] [Thread-2 (]: 2 of 3 START snapshot gold.dim_hosts ........................................... [RUN]
[0m19:54:39.892836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_bookings, now snapshot.dbt_snowflake_aws_project.dim_hosts)
[0m19:54:39.893113 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:54:39.896855 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:39.900010 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:54:39.906365 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:39.906592 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:39.958663 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.052 seconds
[0m19:54:39.986227 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:39.986545 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:54:40.367349 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m19:54:40.373261 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.373683 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.463869 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.090 seconds
[0m19:54:40.472143 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.472717 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.531657 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.058 seconds
[0m19:54:40.538215 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.538911 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.607360 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.068 seconds
[0m19:54:40.615101 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.615757 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.685823 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m19:54:40.698215 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.698662 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: describe table "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.761164 [debug] [Thread-2 (]: SQL status: SUCCESS 12 in 0.062 seconds
[0m19:54:40.784566 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.785117 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__host_ephemeral_source as (


with hosts as
    (
        SELECT
            host_id,
            host_name,
            host_since,
            is_superhost,
            response_rate_quality,
            HOST_CREATED_AT
        FROM
            AIRBNB_PRO.gold.obt
    )

select * from hosts
) select * from __dbt__cte__host_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_HOSTS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(HOST_CREATED_AT, HOST_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(HOST_ID as varchar ), '')
         || '|' || coalesce(cast(HOST_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        HOST_ID as dbt_unique_key
    
,
            HOST_CREATED_AT as dbt_updated_at,
            HOST_CREATED_AT as dbt_valid_from,
            HOST_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.HOST_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:40.921190 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.135 seconds
[0m19:54:40.923718 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:40.924487 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:41.007510 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m19:54:41.008764 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:41.014618 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:41.015169 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:41.116623 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m19:54:41.118042 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:41.118767 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: merge into "AIRBNB_PRO"."GOLD"."DIM_HOSTS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_HOSTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("HOST_ID", "HOST_NAME", "HOST_SINCE", "IS_SUPERHOST", "RESPONSE_RATE_QUALITY", "HOST_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */;
[0m19:54:41.493027 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.373 seconds
[0m19:54:41.494240 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_hosts"
[0m19:54:41.494929 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_hosts: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_hosts"} */
[0m19:54:41.864581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m19:54:41.872103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4deae0>]}
[0m19:54:41.872991 [info ] [Thread-2 (]: 2 of 3 OK snapshotted gold.dim_hosts ........................................... [[32mSUCCESS 0[0m in 1.98s]
[0m19:54:41.873590 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_hosts
[0m19:54:41.873982 [debug] [Thread-2 (]: Began running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:54:41.874540 [info ] [Thread-2 (]: 3 of 3 START snapshot gold.dim_listings ........................................ [RUN]
[0m19:54:41.874963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_snowflake_aws_project.dim_hosts, now snapshot.dbt_snowflake_aws_project.dim_listings)
[0m19:54:41.875268 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:54:41.880191 [debug] [Thread-2 (]: Writing injected SQL for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:41.883858 [debug] [Thread-2 (]: Began executing node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:54:41.887352 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:41.887650 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:41.946336 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.058 seconds
[0m19:54:41.951671 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:41.952164 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: create or replace temporary table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:54:42.494762 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m19:54:42.501119 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.501547 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:42.571410 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.070 seconds
[0m19:54:42.573951 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.574188 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:42.645680 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m19:54:42.649231 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.649576 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:42.713127 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.063 seconds
[0m19:54:42.718259 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.718759 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:42.788927 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.070 seconds
[0m19:54:42.792915 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.793303 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: describe table "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:42.857885 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.064 seconds
[0m19:54:42.865610 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:42.866460 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        
    
    with snapshot_query as (

        with __dbt__cte__listing_ephemeral_source as (


WITH listings AS 
(
    SELECT 
        LISTING_ID,
        PROPERTY_TYPE,
        ROOM_TYPE,
        CITY,
        COUNTRY,
        PRICE_PER_NIGHT_TAGGED,
        LISTING_CREATED_AT
    FROM 
        AIRBNB_PRO.gold.obt
)
SELECT * FROM listings
) select * from __dbt__cte__listing_ephemeral_source

    ),

    snapshotted_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    

        from "AIRBNB_PRO"."GOLD"."DIM_LISTINGS"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            
  
  coalesce(nullif(LISTING_CREATED_AT, LISTING_CREATED_AT), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(LISTING_CREATED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        LISTING_ID as dbt_unique_key
    
,
            LISTING_CREATED_AT as dbt_updated_at,
            LISTING_CREATED_AT as dbt_valid_from,
            LISTING_CREATED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LISTING_CREATED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:43.002044 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.135 seconds
[0m19:54:43.004582 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:43.005376 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:43.066606 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.060 seconds
[0m19:54:43.068172 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:43.074413 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:43.075193 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:43.153922 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m19:54:43.154942 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:43.155547 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: merge into "AIRBNB_PRO"."GOLD"."DIM_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB_PRO"."GOLD"."DIM_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LISTING_ID", "PROPERTY_TYPE", "ROOM_TYPE", "CITY", "COUNTRY", "PRICE_PER_NIGHT_TAGGED", "LISTING_CREATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */;
[0m19:54:43.557806 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.401 seconds
[0m19:54:43.559150 [debug] [Thread-2 (]: Using snowflake connection "snapshot.dbt_snowflake_aws_project.dim_listings"
[0m19:54:43.559809 [debug] [Thread-2 (]: On snapshot.dbt_snowflake_aws_project.dim_listings: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "snapshot.dbt_snowflake_aws_project.dim_listings"} */
[0m19:54:43.722643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m19:54:43.727184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232482ea-28ab-42f9-bd32-23e52648eb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bfd70>]}
[0m19:54:43.728357 [info ] [Thread-2 (]: 3 of 3 OK snapshotted gold.dim_listings ........................................ [[32mSUCCESS 0[0m in 1.85s]
[0m19:54:43.729097 [debug] [Thread-2 (]: Finished running node snapshot.dbt_snowflake_aws_project.dim_listings
[0m19:54:43.731074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:43.731495 [debug] [MainThread]: Connection 'snapshot.dbt_snowflake_aws_project.dim_listings' was left open.
[0m19:54:43.731994 [debug] [MainThread]: On snapshot.dbt_snowflake_aws_project.dim_listings: Close
[0m19:54:43.812891 [info ] [MainThread]: 
[0m19:54:43.813481 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m19:54:43.814506 [debug] [MainThread]: Command end result
[0m19:54:43.838941 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m19:54:43.848015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m19:54:43.853555 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m19:54:43.853774 [info ] [MainThread]: 
[0m19:54:43.854024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:43.854218 [info ] [MainThread]: 
[0m19:54:43.854421 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:54:43.854809 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.3333435, "process_in_blocks": "0", "process_kernel_time": 0.746074, "process_mem_max_rss": "161447936", "process_out_blocks": "0", "process_user_time": 2.129484}
[0m19:54:43.855090 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:54:43.855033 after 9.33 seconds
[0m19:54:43.855321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c523fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c523050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5239e0>]}
[0m19:54:43.855526 [debug] [MainThread]: Flushing usage events
[0m19:54:44.990636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:02.771160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df34620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df34bc0>]}


============================== 20:06:02.776345 | 53e12efe-673c-42f7-90cb-ae10329c4273 ==============================
[0m20:06:02.776345 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:06:02.776672 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt test', 'log_cache_events': 'False', 'log_format': 'default'}
[0m20:06:03.610052 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:06:03.610628 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:06:03.610912 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:06:03.755795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53e12efe-673c-42f7-90cb-ae10329c4273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e2390>]}
[0m20:06:03.799029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53e12efe-673c-42f7-90cb-ae10329c4273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec738f0>]}
[0m20:06:03.800953 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m20:06:03.873369 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:06:04.115044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:06:04.115413 [debug] [MainThread]: Partial parsing: added file: dbt_snowflake_aws_project://tests/tests_booking.sql
[0m20:06:04.164068 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_snowflake_aws_project.tests_booking' (tests/tests_booking.sql) depends on a source named 'staging.bookings' in package '' which was not found
[0m20:06:04.200827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e12efe-673c-42f7-90cb-ae10329c4273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f5a30>]}
[0m20:06:04.241976 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m20:06:04.248875 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m20:06:04.332297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e12efe-673c-42f7-90cb-ae10329c4273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f3b30>]}
[0m20:06:04.332575 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 3 sources, 526 macros
[0m20:06:04.332741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e12efe-673c-42f7-90cb-ae10329c4273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd78c0>]}
[0m20:06:04.333660 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:06:04.333917 [debug] [MainThread]: Command end result
[0m20:06:04.410767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m20:06:04.417520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m20:06:04.421456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m20:06:04.421836 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7186784, "process_in_blocks": "0", "process_kernel_time": 0.824918, "process_mem_max_rss": "145342464", "process_out_blocks": "0", "process_user_time": 1.624721}
[0m20:06:04.422156 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:04.422100 after 1.72 seconds
[0m20:06:04.422382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df97fe0>]}
[0m20:06:04.422578 [debug] [MainThread]: Flushing usage events
[0m20:06:05.456634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:09.329048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096451f0>]}


============================== 20:07:09.334265 | 100fa94a-f9f8-4516-8423-95a8211d955a ==============================
[0m20:07:09.334265 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:09.334617 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'empty': 'None'}
[0m20:07:10.495255 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:07:10.496343 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:07:10.496787 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:07:10.648908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55c770>]}
[0m20:07:10.692134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c50d0>]}
[0m20:07:10.694662 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m20:07:10.761310 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:07:10.935979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:10.936321 [debug] [MainThread]: Partial parsing: updated file: dbt_snowflake_aws_project://tests/tests_booking.sql
[0m20:07:11.006480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94d520>]}
[0m20:07:11.045720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m20:07:11.050400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m20:07:11.106041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab80f50>]}
[0m20:07:11.106283 [info ] [MainThread]: Found 11 models, 3 analyses, 3 snapshots, 1 test, 3 sources, 526 macros
[0m20:07:11.106428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a422ae0>]}
[0m20:07:11.107293 [info ] [MainThread]: 
[0m20:07:11.107442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:11.107547 [info ] [MainThread]: 
[0m20:07:11.107747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:07:11.109732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_semi_raw'
[0m20:07:11.348877 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m20:07:11.349146 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m20:07:11.349301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:12.328961 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.980 seconds
[0m20:07:12.330678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m20:07:12.332846 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m20:07:12.333057 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m20:07:12.453309 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.120 seconds
[0m20:07:12.456567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m20:07:12.460741 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m20:07:12.461295 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m20:07:12.536621 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.075 seconds
[0m20:07:12.539006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100fa94a-f9f8-4516-8423-95a8211d955a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3fbe30>]}
[0m20:07:12.548902 [debug] [Thread-2 (]: Began running node test.dbt_snowflake_aws_project.tests_booking
[0m20:07:12.549286 [info ] [Thread-2 (]: 1 of 1 START test tests_booking ................................................ [RUN]
[0m20:07:12.549677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now test.dbt_snowflake_aws_project.tests_booking)
[0m20:07:12.549967 [debug] [Thread-2 (]: Began compiling node test.dbt_snowflake_aws_project.tests_booking
[0m20:07:12.556712 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_snowflake_aws_project.tests_booking"
[0m20:07:12.559772 [debug] [Thread-2 (]: Began executing node test.dbt_snowflake_aws_project.tests_booking
[0m20:07:12.574406 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_snowflake_aws_project.tests_booking"
[0m20:07:12.579213 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_snowflake_aws_project.tests_booking"
[0m20:07:12.579430 [debug] [Thread-2 (]: On test.dbt_snowflake_aws_project.tests_booking: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

SELECT 
    1
FROM 
    AIRBNB_PRO.STAGING.bookings
WHERE 
    BOOKING_AMOUNT < 200
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "test.dbt_snowflake_aws_project.tests_booking"} */
[0m20:07:13.171143 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m20:07:13.182715 [warn ] [Thread-2 (]: 1 of 1 WARN 286 tests_booking .................................................. [[33mWARN 286[0m in 0.63s]
[0m20:07:13.183376 [debug] [Thread-2 (]: Finished running node test.dbt_snowflake_aws_project.tests_booking
[0m20:07:13.184490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:13.184748 [debug] [MainThread]: Connection 'test.dbt_snowflake_aws_project.tests_booking' was left open.
[0m20:07:13.184983 [debug] [MainThread]: On test.dbt_snowflake_aws_project.tests_booking: Close
[0m20:07:13.261814 [info ] [MainThread]: 
[0m20:07:13.262406 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m20:07:13.263164 [debug] [MainThread]: Command end result
[0m20:07:13.285876 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m20:07:13.295680 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m20:07:13.301024 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m20:07:13.301212 [info ] [MainThread]: 
[0m20:07:13.301413 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m20:07:13.301580 [info ] [MainThread]: 
[0m20:07:13.301784 [warn ] [MainThread]: [33mWarning in test tests_booking (tests/tests_booking.sql)[0m
[0m20:07:13.301968 [warn ] [MainThread]: Got 286 results, configured to warn if != 0
[0m20:07:13.302108 [info ] [MainThread]: 
[0m20:07:13.302276 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/tests/tests_booking.sql
[0m20:07:13.302413 [info ] [MainThread]: 
[0m20:07:13.302583 [info ] [MainThread]: Done. PASS=0 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:13.302914 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.04559, "process_in_blocks": "0", "process_kernel_time": 0.736788, "process_mem_max_rss": "162709504", "process_out_blocks": "0", "process_user_time": 1.720506}
[0m20:07:13.303180 [debug] [MainThread]: Command `dbt test` succeeded at 20:07:13.303123 after 4.05 seconds
[0m20:07:13.303396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109644500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096443e0>]}
[0m20:07:13.303600 [debug] [MainThread]: Flushing usage events
[0m20:07:14.227254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:24.433743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cded1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76d490>]}


============================== 10:24:24.442208 | 92351488-e3d2-4f75-94d8-a903fa1eb166 ==============================
[0m10:24:24.442208 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:24:24.442742 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt seed', 'warn_error': 'None', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'introspect': 'True'}
[0m10:24:25.987405 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:24:25.987699 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:24:25.987841 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:24:26.147746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2478f0>]}
[0m10:24:26.200216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1ce150>]}
[0m10:24:26.205116 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:24:26.307792 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:24:26.453647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:26.453869 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:24:26.453984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:26.456476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.aws_dbt_snowflake_project
[0m10:24:26.483781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4540e0>]}
[0m10:24:26.529992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:24:26.535944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:24:26.626335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6aaf30>]}
[0m10:24:26.626606 [info ] [MainThread]: Found 11 models, 4 analyses, 1 test, 3 snapshots, 1 seed, 3 sources, 526 macros
[0m10:24:26.626748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d454a40>]}
[0m10:24:26.627694 [info ] [MainThread]: 
[0m10:24:26.627835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:26.627937 [info ] [MainThread]: 
[0m10:24:26.628149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:26.628531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m10:24:28.924644 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m10:24:28.925612 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m10:24:28.926395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:30.551585 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.625 seconds
[0m10:24:30.554791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now list_AIRBNB_PRO_silver)
[0m10:24:30.560478 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m10:24:30.560654 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m10:24:30.690965 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.130 seconds
[0m10:24:30.692750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m10:24:30.694958 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m10:24:30.695221 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m10:24:30.816555 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.121 seconds
[0m10:24:30.820491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m10:24:30.825689 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m10:24:30.826172 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m10:24:31.060097 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.233 seconds
[0m10:24:31.064622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_dbt_schema)
[0m10:24:31.070226 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m10:24:31.070908 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m10:24:31.221744 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.150 seconds
[0m10:24:31.224339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e116270>]}
[0m10:24:31.236940 [debug] [Thread-2 (]: Began running node seed.dbt_snowflake_aws_project.lookup
[0m10:24:31.237553 [info ] [Thread-2 (]: 1 of 1 START seed file dbt_schema.lookup ....................................... [RUN]
[0m10:24:31.238048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now seed.dbt_snowflake_aws_project.lookup)
[0m10:24:31.238402 [debug] [Thread-2 (]: Began compiling node seed.dbt_snowflake_aws_project.lookup
[0m10:24:31.238733 [debug] [Thread-2 (]: Began executing node seed.dbt_snowflake_aws_project.lookup
[0m10:24:31.267731 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:24:31.268067 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: create table AIRBNB_PRO.dbt_schema.lookup (customer_id integer, customer_name text, customer_email text)
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:24:31.493718 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m10:24:31.505211 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:24:31.505549 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:24:31.604970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m10:24:31.605810 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:24:31.606165 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: insert into AIRBNB_PRO.dbt_schema.lookup (customer_id,  customer_name,  customer_email) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */...
[0m10:24:32.365781 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.759 seconds
[0m10:24:32.366067 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:24:32.366199 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:24:32.567275 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m10:24:32.574584 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_snowflake_aws_project.lookup"
[0m10:24:32.603124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92351488-e3d2-4f75-94d8-a903fa1eb166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5993a0>]}
[0m10:24:32.603603 [info ] [Thread-2 (]: 1 of 1 OK loaded seed file dbt_schema.lookup ................................... [[32mINSERT 3[0m in 1.36s]
[0m10:24:32.603986 [debug] [Thread-2 (]: Finished running node seed.dbt_snowflake_aws_project.lookup
[0m10:24:32.604747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:32.604970 [debug] [MainThread]: Connection 'seed.dbt_snowflake_aws_project.lookup' was left open.
[0m10:24:32.605159 [debug] [MainThread]: On seed.dbt_snowflake_aws_project.lookup: Close
[0m10:24:32.776928 [info ] [MainThread]: 
[0m10:24:32.777630 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m10:24:32.778570 [debug] [MainThread]: Command end result
[0m10:24:32.802238 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:24:32.808400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:24:32.813680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m10:24:32.813964 [info ] [MainThread]: 
[0m10:24:32.814221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:32.814382 [info ] [MainThread]: 
[0m10:24:32.814718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:24:32.815542 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.517795, "process_in_blocks": "0", "process_kernel_time": 1.305305, "process_mem_max_rss": "160612352", "process_out_blocks": "0", "process_user_time": 2.25101}
[0m10:24:32.815903 [debug] [MainThread]: Command `dbt seed` succeeded at 10:24:32.815836 after 8.52 seconds
[0m10:24:32.816131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cded1c0>]}
[0m10:24:32.816332 [debug] [MainThread]: Flushing usage events
[0m10:24:35.372313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:40.834849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0d640>]}


============================== 10:37:40.840999 | 095525f1-8df4-4eee-8c2f-a76d0f09c169 ==============================
[0m10:37:40.840999 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:37:40.841395 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'invocation_command': 'dbt test', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt'}
[0m10:37:41.567227 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:37:41.568583 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:37:41.569242 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:37:41.729381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3b1250>]}
[0m10:37:41.772426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40e690>]}
[0m10:37:41.775214 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:37:41.838811 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:37:42.012551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:42.012778 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:37:42.012894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:42.015388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.aws_dbt_snowflake_project
[0m10:37:42.041257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d821550>]}
[0m10:37:42.085068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:37:42.091335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:37:42.129350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb1700>]}
[0m10:37:42.129569 [info ] [MainThread]: Found 11 models, 4 analyses, 2 data tests, 3 snapshots, 1 seed, 3 sources, 526 macros
[0m10:37:42.129703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d850290>]}
[0m10:37:42.130538 [info ] [MainThread]: 
[0m10:37:42.130671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:42.130775 [info ] [MainThread]: 
[0m10:37:42.130972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:42.132878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_dbt_schema'
[0m10:37:42.378041 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m10:37:42.378248 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m10:37:42.378488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:43.534064 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.155 seconds
[0m10:37:43.537981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now list_AIRBNB_PRO_semi_raw)
[0m10:37:43.542525 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m10:37:43.543027 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m10:37:43.686736 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.143 seconds
[0m10:37:43.691005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_gold)
[0m10:37:43.696291 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m10:37:43.696808 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m10:37:43.858168 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.161 seconds
[0m10:37:43.861820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m10:37:43.866192 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m10:37:43.866636 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m10:37:44.087990 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.221 seconds
[0m10:37:44.093079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095525f1-8df4-4eee-8c2f-a76d0f09c169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b269880>]}
[0m10:37:44.105338 [debug] [Thread-2 (]: Began running node test.dbt_snowflake_aws_project.generic_tests_no_duplicate
[0m10:37:44.106181 [info ] [Thread-2 (]: 1 of 2 START test generic_tests_no_duplicate ................................... [RUN]
[0m10:37:44.106983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now test.dbt_snowflake_aws_project.generic_tests_no_duplicate)
[0m10:37:44.107445 [debug] [Thread-2 (]: Began compiling node test.dbt_snowflake_aws_project.generic_tests_no_duplicate
[0m10:37:44.117218 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_snowflake_aws_project.generic_tests_no_duplicate"
[0m10:37:44.120315 [debug] [Thread-2 (]: Began executing node test.dbt_snowflake_aws_project.generic_tests_no_duplicate
[0m10:37:44.136895 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_snowflake_aws_project.generic_tests_no_duplicate"
[0m10:37:44.138637 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_snowflake_aws_project.generic_tests_no_duplicate"
[0m10:37:44.138875 [debug] [Thread-2 (]: On test.dbt_snowflake_aws_project.generic_tests_no_duplicate: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

SELECT 
    BOOKING_ID, 
    COUNT(*)
FROM AIRBNB_PRO.STAGING.bookings
GROUP BY 1
HAVING COUNT(*) > 1
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "test.dbt_snowflake_aws_project.generic_tests_no_duplicate"} */
[0m10:37:44.322504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m10:37:44.336962 [info ] [Thread-2 (]: 1 of 2 PASS generic_tests_no_duplicate ......................................... [[32mPASS[0m in 0.23s]
[0m10:37:44.337967 [debug] [Thread-2 (]: Finished running node test.dbt_snowflake_aws_project.generic_tests_no_duplicate
[0m10:37:44.338463 [debug] [Thread-2 (]: Began running node test.dbt_snowflake_aws_project.tests_booking
[0m10:37:44.338939 [info ] [Thread-2 (]: 2 of 2 START test tests_booking ................................................ [RUN]
[0m10:37:44.339422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_snowflake_aws_project.generic_tests_no_duplicate, now test.dbt_snowflake_aws_project.tests_booking)
[0m10:37:44.339771 [debug] [Thread-2 (]: Began compiling node test.dbt_snowflake_aws_project.tests_booking
[0m10:37:44.342897 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_snowflake_aws_project.tests_booking"
[0m10:37:44.358564 [debug] [Thread-2 (]: Began executing node test.dbt_snowflake_aws_project.tests_booking
[0m10:37:44.360854 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_snowflake_aws_project.tests_booking"
[0m10:37:44.374794 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_snowflake_aws_project.tests_booking"
[0m10:37:44.375106 [debug] [Thread-2 (]: On test.dbt_snowflake_aws_project.tests_booking: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

SELECT 
    1
FROM 
    AIRBNB_PRO.STAGING.bookings
WHERE 
    BOOKING_AMOUNT < 200
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "test.dbt_snowflake_aws_project.tests_booking"} */
[0m10:37:44.525923 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m10:37:44.529165 [warn ] [Thread-2 (]: 2 of 2 WARN 286 tests_booking .................................................. [[33mWARN 286[0m in 0.19s]
[0m10:37:44.530075 [debug] [Thread-2 (]: Finished running node test.dbt_snowflake_aws_project.tests_booking
[0m10:37:44.531735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:44.532217 [debug] [MainThread]: Connection 'test.dbt_snowflake_aws_project.tests_booking' was left open.
[0m10:37:44.532652 [debug] [MainThread]: On test.dbt_snowflake_aws_project.tests_booking: Close
[0m10:37:44.804403 [info ] [MainThread]: 
[0m10:37:44.805465 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m10:37:44.807058 [debug] [MainThread]: Command end result
[0m10:37:44.838223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:37:44.844005 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:37:44.849809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m10:37:44.850029 [info ] [MainThread]: 
[0m10:37:44.850260 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m10:37:44.850441 [info ] [MainThread]: 
[0m10:37:44.850681 [warn ] [MainThread]: [33mWarning in test tests_booking (tests/tests_booking.sql)[0m
[0m10:37:44.850892 [warn ] [MainThread]: Got 286 results, configured to warn if != 0
[0m10:37:44.851048 [info ] [MainThread]: 
[0m10:37:44.851235 [info ] [MainThread]:   compiled code at target/compiled/dbt_snowflake_aws_project/tests/tests_booking.sql
[0m10:37:44.851398 [info ] [MainThread]: 
[0m10:37:44.851586 [info ] [MainThread]: Done. PASS=1 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:37:44.851983 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.085114, "process_in_blocks": "0", "process_kernel_time": 0.78027, "process_mem_max_rss": "161349632", "process_out_blocks": "0", "process_user_time": 1.897613}
[0m10:37:44.852245 [debug] [MainThread]: Command `dbt test` succeeded at 10:37:44.852199 after 4.09 seconds
[0m10:37:44.852457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0d5b0>]}
[0m10:37:44.852658 [debug] [MainThread]: Flushing usage events
[0m10:37:49.602334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:59.465203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddee7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff8170>]}


============================== 10:43:59.471951 | b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c ==============================
[0m10:43:59.471951 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:43:59.472318 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True'}
[0m10:44:00.602475 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:44:00.603679 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:44:00.604286 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:44:00.756970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc4e30>]}
[0m10:44:00.800423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d798da0>]}
[0m10:44:00.803768 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:44:00.874320 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:44:00.968633 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `sources[0].tables[0]` in file
`models/bronze/sources/sources.yml`. The `freshness` top-level property should
be moved into the `config` of `sources[0].tables[0]`.
[0m10:44:00.968902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df98f50>]}
[0m10:44:01.059289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:01.059522 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:44:01.059635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:01.062201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.aws_dbt_snowflake_project
[0m10:44:01.091121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df98a10>]}
[0m10:44:01.140136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:44:01.147620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:44:01.196072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f05dd60>]}
[0m10:44:01.196309 [info ] [MainThread]: Found 11 models, 3 snapshots, 1 seed, 4 analyses, 4 data tests, 3 sources, 526 macros
[0m10:44:01.196457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2d9be0>]}
[0m10:44:01.197353 [info ] [MainThread]: 
[0m10:44:01.197495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:01.197599 [info ] [MainThread]: 
[0m10:44:01.197800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:01.199792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO_gold'
[0m10:44:01.560740 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m10:44:01.561238 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m10:44:01.561556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:03.193202 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.631 seconds
[0m10:44:03.199163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m10:44:03.203416 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m10:44:03.204072 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m10:44:03.331874 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.127 seconds
[0m10:44:03.336106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now list_AIRBNB_PRO_semi_raw)
[0m10:44:03.341009 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m10:44:03.341463 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m10:44:03.495652 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.154 seconds
[0m10:44:03.500122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_dbt_schema)
[0m10:44:03.503298 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_dbt_schema"
[0m10:44:03.503600 [debug] [ThreadPool]: On list_AIRBNB_PRO_dbt_schema: show objects in AIRBNB_PRO.dbt_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_dbt_schema"} */;
[0m10:44:03.778460 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.274 seconds
[0m10:44:03.782472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1bf1963-ee8d-4daa-a6ee-4eba3f3a199c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecabce0>]}
[0m10:44:03.783388 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m10:44:03.790092 [debug] [Thread-2 (]: Began running node source.dbt_snowflake_aws_project.STAGING.bookings
[0m10:44:03.790726 [info ] [Thread-2 (]: 1 of 1 START freshness of STAGING.bookings ..................................... [RUN]
[0m10:44:03.791414 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_dbt_schema, now source.dbt_snowflake_aws_project.STAGING.bookings)
[0m10:44:03.792023 [debug] [Thread-2 (]: Began compiling node source.dbt_snowflake_aws_project.STAGING.bookings
[0m10:44:03.792599 [debug] [Thread-2 (]: Began executing node source.dbt_snowflake_aws_project.STAGING.bookings
[0m10:44:03.805139 [debug] [Thread-2 (]: Using snowflake connection "source.dbt_snowflake_aws_project.STAGING.bookings"
[0m10:44:03.805509 [debug] [Thread-2 (]: On source.dbt_snowflake_aws_project.STAGING.bookings: select
      max(created_at) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB_PRO.STAGING.bookings
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "source.dbt_snowflake_aws_project.STAGING.bookings"} */
[0m10:44:04.132964 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m10:44:04.138685 [error] [Thread-2 (]: 1 of 1 ERROR STALE freshness of STAGING.bookings ............................... [[31mERROR STALE[0m in 0.35s]
[0m10:44:04.139595 [debug] [Thread-2 (]: Finished running node source.dbt_snowflake_aws_project.STAGING.bookings
[0m10:44:04.140374 [debug] [Thread-5 (]: Marking all children of 'source.dbt_snowflake_aws_project.STAGING.bookings' to be skipped because of status 'error'. 
[0m10:44:04.143103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:04.143497 [debug] [MainThread]: Connection 'source.dbt_snowflake_aws_project.STAGING.bookings' was left open.
[0m10:44:04.143827 [debug] [MainThread]: On source.dbt_snowflake_aws_project.STAGING.bookings: Close
[0m10:44:04.333412 [info ] [MainThread]: 
[0m10:44:04.334431 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m10:44:04.364260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:44:04.371146 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:44:04.375607 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/sources.json
[0m10:44:04.375835 [info ] [MainThread]: 
[0m10:44:04.376097 [error] [MainThread]: [31mFailure in source bookings (models/bronze/sources/sources.yml)[0m
[0m10:44:04.376305 [error] [MainThread]:   Status: error
[0m10:44:04.376470 [info ] [MainThread]: Done.
[0m10:44:04.376804 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:44:04.377215 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 4.9823895, "process_in_blocks": "0", "process_kernel_time": 1.06931, "process_mem_max_rss": "160022528", "process_out_blocks": "0", "process_user_time": 1.873316}
[0m10:44:04.377536 [debug] [MainThread]: Command `dbt source freshness` failed at 10:44:04.377476 after 4.98 seconds
[0m10:44:04.377773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc7ad0>]}
[0m10:44:04.377994 [debug] [MainThread]: Flushing usage events
[0m10:44:06.289618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:42.190060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c645790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d94c0>]}


============================== 10:47:42.195439 | 5b3908fe-9d82-4956-96ba-2a9ae6b7906a ==============================
[0m10:47:42.195439 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:47:42.195780 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'cache_selected_only': 'False', 'empty': 'None', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'partial_parse': 'True'}
[0m10:47:43.299339 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m10:47:43.300397 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m10:47:43.300858 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m10:47:43.454649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc7b560>]}
[0m10:47:43.498425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1488c0>]}
[0m10:47:43.502018 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m10:47:43.572238 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:47:43.750626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:47:43.750847 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:47:43.750962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:47:43.780486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1b0d40>]}
[0m10:47:43.829051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:47:43.835463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:47:43.876436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e68dcd0>]}
[0m10:47:43.876661 [info ] [MainThread]: Found 11 models, 4 analyses, 4 data tests, 1 seed, 3 snapshots, 3 sources, 526 macros
[0m10:47:43.876805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ba5a0>]}
[0m10:47:43.877658 [info ] [MainThread]: 
[0m10:47:43.877790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:43.877892 [info ] [MainThread]: 
[0m10:47:43.878087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:43.878429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_PRO'
[0m10:47:44.166992 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO"
[0m10:47:44.167186 [debug] [ThreadPool]: On list_AIRBNB_PRO: show terse schemas in database AIRBNB_PRO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO"} */
[0m10:47:44.167297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:45.341070 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.173 seconds
[0m10:47:45.344766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO, now create_AIRBNB_PRO_bronze)
[0m10:47:45.345488 [debug] [ThreadPool]: Creating schema "database: "AIRBNB_PRO"
schema: "bronze"
"
[0m10:47:45.351450 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_PRO_bronze"
[0m10:47:45.351943 [debug] [ThreadPool]: On create_AIRBNB_PRO_bronze: create schema if not exists AIRBNB_PRO.bronze
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "create_AIRBNB_PRO_bronze"} */
[0m10:47:45.777646 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m10:47:45.786727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_PRO_bronze, now list_AIRBNB_PRO_semi_raw)
[0m10:47:45.798603 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_semi_raw"
[0m10:47:45.798914 [debug] [ThreadPool]: On list_AIRBNB_PRO_semi_raw: show objects in AIRBNB_PRO.semi_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_semi_raw"} */;
[0m10:47:45.984352 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.185 seconds
[0m10:47:45.988302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_semi_raw, now list_AIRBNB_PRO_bronze)
[0m10:47:45.992356 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_bronze"
[0m10:47:45.992765 [debug] [ThreadPool]: On list_AIRBNB_PRO_bronze: show objects in AIRBNB_PRO.bronze
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_bronze"} */;
[0m10:47:46.222506 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.229 seconds
[0m10:47:46.227348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_bronze, now list_AIRBNB_PRO_gold)
[0m10:47:46.229652 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_gold"
[0m10:47:46.229945 [debug] [ThreadPool]: On list_AIRBNB_PRO_gold: show objects in AIRBNB_PRO.gold
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_gold"} */;
[0m10:47:46.584227 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.354 seconds
[0m10:47:46.588253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_gold, now list_AIRBNB_PRO_silver)
[0m10:47:46.594254 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_PRO_silver"
[0m10:47:46.594605 [debug] [ThreadPool]: On list_AIRBNB_PRO_silver: show objects in AIRBNB_PRO.silver
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "connection_name": "list_AIRBNB_PRO_silver"} */;
[0m10:47:46.730675 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.136 seconds
[0m10:47:46.736196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e29b7a0>]}
[0m10:47:46.746275 [debug] [Thread-2 (]: Began running node seed.dbt_snowflake_aws_project.lookup
[0m10:47:46.746868 [info ] [Thread-2 (]: 1 of 1 START seed file bronze.lookup ........................................... [RUN]
[0m10:47:46.747337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_AIRBNB_PRO_silver, now seed.dbt_snowflake_aws_project.lookup)
[0m10:47:46.747667 [debug] [Thread-2 (]: Began compiling node seed.dbt_snowflake_aws_project.lookup
[0m10:47:46.747994 [debug] [Thread-2 (]: Began executing node seed.dbt_snowflake_aws_project.lookup
[0m10:47:46.774625 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:47:46.774931 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: create table AIRBNB_PRO.bronze.lookup (customer_id integer, customer_name text, customer_email text)
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:47:47.012537 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m10:47:47.031105 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:47:47.031592 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:47:47.171590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m10:47:47.173091 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:47:47.173794 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: insert into AIRBNB_PRO.bronze.lookup (customer_id,  customer_name,  customer_email) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */...
[0m10:47:47.728878 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.554 seconds
[0m10:47:47.730660 [debug] [Thread-2 (]: Using snowflake connection "seed.dbt_snowflake_aws_project.lookup"
[0m10:47:47.731170 [debug] [Thread-2 (]: On seed.dbt_snowflake_aws_project.lookup: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "dbt_snowflake_aws_project", "target_name": "dev", "node_id": "seed.dbt_snowflake_aws_project.lookup"} */
[0m10:47:47.971664 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m10:47:47.980431 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_snowflake_aws_project.lookup"
[0m10:47:48.009926 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b3908fe-9d82-4956-96ba-2a9ae6b7906a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f67e0>]}
[0m10:47:48.010384 [info ] [Thread-2 (]: 1 of 1 OK loaded seed file bronze.lookup ....................................... [[32mINSERT 3[0m in 1.26s]
[0m10:47:48.010759 [debug] [Thread-2 (]: Finished running node seed.dbt_snowflake_aws_project.lookup
[0m10:47:48.011654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:48.011893 [debug] [MainThread]: Connection 'seed.dbt_snowflake_aws_project.lookup' was left open.
[0m10:47:48.012083 [debug] [MainThread]: On seed.dbt_snowflake_aws_project.lookup: Close
[0m10:47:48.181306 [info ] [MainThread]: 
[0m10:47:48.182480 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m10:47:48.183905 [debug] [MainThread]: Command end result
[0m10:47:48.215754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/manifest.json
[0m10:47:48.222468 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/semantic_manifest.json
[0m10:47:48.227823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/target/run_results.json
[0m10:47:48.228043 [info ] [MainThread]: 
[0m10:47:48.228295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:48.228469 [info ] [MainThread]: 
[0m10:47:48.228666 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:47:48.229055 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.109189, "process_in_blocks": "0", "process_kernel_time": 1.086048, "process_mem_max_rss": "160301056", "process_out_blocks": "0", "process_user_time": 1.998521}
[0m10:47:48.229331 [debug] [MainThread]: Command `dbt seed` succeeded at 10:47:48.229277 after 6.11 seconds
[0m10:47:48.229576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d3d40>]}
[0m10:47:48.229793 [debug] [MainThread]: Flushing usage events
[0m10:47:50.450201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:26.758042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c319670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e080620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e080200>]}


============================== 22:54:26.762166 | 3700ef55-4675-4e84-9489-47845269678c ==============================
[0m22:54:26.762166 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:54:26.762512 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'quiet': 'False', 'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'empty': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m22:54:26.906762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3700ef55-4675-4e84-9489-47845269678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f3ce0>]}
[0m22:54:26.968472 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:54:26.969412 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:54:26.969825 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2577768, "process_in_blocks": "0", "process_kernel_time": 0.214624, "process_mem_max_rss": "111525888", "process_out_blocks": "0", "process_user_time": 0.796909}
[0m22:54:26.970032 [debug] [MainThread]: Command `cli deps` succeeded at 22:54:26.969986 after 0.26 seconds
[0m22:54:26.970185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e080530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e080470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e080440>]}
[0m22:54:26.970353 [debug] [MainThread]: Flushing usage events
[0m22:54:28.890600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:00.099631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109909160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1504d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1500b0>]}


============================== 22:59:00.105973 | d2d2f3e1-ae07-4fb7-acbb-6bcb3a8db649 ==============================
[0m22:59:00.105973 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:59:00.106362 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/aadil.mansoori/Desktop/AWS_SNOWFLAKE_DBT_PRO_FINAL/dbt_snowflake_aws_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/Users/aadil.mansoori/.dbt', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False'}
[0m22:59:00.182970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d2f3e1-ae07-4fb7-acbb-6bcb3a8db649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc76b0>]}
[0m22:59:00.230129 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:00.231848 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:00.232238 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20753658, "process_in_blocks": "0", "process_kernel_time": 0.324125, "process_mem_max_rss": "111591424", "process_out_blocks": "0", "process_user_time": 0.890875}
[0m22:59:00.232508 [debug] [MainThread]: Command `cli deps` succeeded at 22:59:00.232457 after 0.21 seconds
[0m22:59:00.232686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1502f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c150320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c3710>]}
[0m22:59:00.232832 [debug] [MainThread]: Flushing usage events
[0m22:59:01.814912 [debug] [MainThread]: An error was encountered while trying to flush usage events
